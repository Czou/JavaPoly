!function(){var process=BrowserFS.BFSRequire("process"),Buffer=BrowserFS.BFSRequire("buffer").Buffer,requirejs,require,define;!function(t){function e(t,e){return v.call(t,e)}function n(t,e){var n,r,a,i,o,s,u,c,l,f,_,p=e&&e.split("/"),h=d.map,g=h&&h["*"]||{};if(t&&"."===t.charAt(0))if(e){for(p=p.slice(0,p.length-1),t=t.split("/"),o=t.length-1,d.nodeIdCompat&&y.test(t[o])&&(t[o]=t[o].replace(y,"")),t=p.concat(t),l=0;l<t.length;l+=1)if(_=t[l],"."===_)t.splice(l,1),l-=1;else if(".."===_){if(1===l&&(".."===t[2]||".."===t[0]))break;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||g)&&h){for(n=t.split("/"),l=n.length;l>0;l-=1){if(r=n.slice(0,l).join("/"),p)for(f=p.length;f>0;f-=1)if(a=h[p.slice(0,f).join("/")],a&&(a=a[r])){i=a,s=l;break}if(i)break;!u&&g&&g[r]&&(u=g[r],c=l)}!i&&u&&(i=u,s=c),i&&(n.splice(0,s,i),t=n.join("/"))}return t}function r(e,n){return function(){return l.apply(t,m.call(arguments,0).concat([e,n]))}}function a(t){return function(e){return n(e,t)}}function i(t){return function(e){p[t]=e}}function o(n){if(e(h,n)){var r=h[n];delete h[n],g[n]=!0,c.apply(t,r)}if(!e(p,n)&&!e(g,n))throw new Error("No "+n);return p[n]}function s(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function u(t){return function(){return d&&d.config&&d.config[t]||{}}}var c,l,f,_,p={},h={},d={},g={},v=Object.prototype.hasOwnProperty,m=[].slice,y=/\.js$/;f=function(t,e){var r,i=s(t),u=i[0];return t=i[1],u&&(u=n(u,e),r=o(u)),u?t=r&&r.normalize?r.normalize(t,a(e)):n(t,e):(t=n(t,e),i=s(t),u=i[0],t=i[1],u&&(r=o(u))),{f:u?u+"!"+t:t,n:t,pr:u,p:r}},_={require:function(t){return r(t)},exports:function(t){var e=p[t];return"undefined"!=typeof e?e:p[t]={}},module:function(t){return{id:t,uri:"",exports:p[t],config:u(t)}}},c=function(n,a,s,u){var c,l,d,v,m,y,j=[],b=typeof s;if(u=u||n,"undefined"===b||"function"===b){for(a=!a.length&&s.length?["require","exports","module"]:a,m=0;m<a.length;m+=1)if(v=f(a[m],u),l=v.f,"require"===l)j[m]=_.require(n);else if("exports"===l)j[m]=_.exports(n),y=!0;else if("module"===l)c=j[m]=_.module(n);else if(e(p,l)||e(h,l)||e(g,l))j[m]=o(l);else{if(!v.p)throw new Error(n+" missing "+l);v.p.load(v.n,r(u,!0),i(l),{}),j[m]=p[l]}d=s?s.apply(p[n],j):void 0,n&&(c&&c.exports!==t&&c.exports!==p[n]?p[n]=c.exports:d===t&&y||(p[n]=d))}else n&&(p[n]=s)},requirejs=require=l=function(e,n,r,a,i){if("string"==typeof e)return _[e]?_[e](n):o(f(e,n).f);if(!e.splice){if(d=e,d.deps&&l(d.deps,d.callback),!n)return;n.splice?(e=n,n=r,r=null):e=t}return n=n||function(){},"function"==typeof r&&(r=a,a=i),a?c(t,e,n,r):setTimeout(function(){c(t,e,n,r)},4),l},l.config=function(t){return l(t)},requirejs._defined=p,define=function(t,n,r){n.splice||(r=n,n=[]),e(p,t)||e(h,t)||(h[t]=[t,n,r])},define.amd={jQuery:!0}}(),define("vendor/almond/almond",function(){}),define("src/option_parser",["require","exports"],function(t,e){function n(t){c={},l=t;for(var e in l){var n=l[e],r={};for(var a in n){var i=n[a];r[a]=i,null!=i.alias&&(i.aliased_by=a,r[i.alias]=i)}c[e]=r}}function r(t,e,n,r,a){if(!r[n])throw new Error("Unrecognized option '"+e+"'.\n");var i=r[n].aliased_by||n;return a[i]=r[n].has_value?t.pop():"true",t}function a(t){for(var e={standard:{},non_standard:{},properties:{},_:[]},n=t.reverse();n.length>0;){var a=n.pop();if("-"!==a[0]||null!=e.standard.jar){e._=n.reverse(),null!=e.standard.jar?e._.unshift(a):e.className=a;break}if(a.length<=2)n=r(n,a,a.slice(1),c.standard,e.standard);else switch(a[1]){case"X":n=r(n,a,a.slice(2),c.non_standard,e.non_standard);break;case"D":var i=a.slice(2).split("="),o=i[0],s=i[1]||!0;e.properties[o]=s;break;default:n=r(n,a,a.slice(1),c.standard,e.standard)}}for(var u in c)if(c.hasOwnProperty(u)){e.hasOwnProperty(u)||(e[u]={});for(var l in c[u])c[u].hasOwnProperty(l)&&c[u][l].hasOwnProperty("default")&&!e[u].hasOwnProperty(l)&&(e[u][l]=c[u][l].default)}return e}function i(t,e){for(var n=t,r=e-t.length;r-->0;)n+=" ";return n}function o(t,e){var n={},r=0;for(var a in t){var o=t[a],s=[a];null!=o.alias&&s.push(o.alias);var u=s.map(function(t){return"-"+e+t}).join(", ");n[u]=o,u.length>r&&(r=u.length)}var c="";for(a in n){var l=n[a].description;c+="    "+i(a,r)+"    "+l+"\n"}return c}function s(){return o(l.standard,"")}function u(){return o(l.non_standard,"X")}var c=null,l=null;e.describe=n,e.parse=a,e.show_help=s,e.show_non_standard_help=u}),define("src/gLong",["require","exports"],function(){var t=function(){function t(t,e){this.low_=0|t,this.high_=0|e}return t.fromInt=function(e){if(e>=-128&&128>e){var n=t.IntCache_[e];if(n)return n}var r=new t(e,0>e?-1:0);return e>=-128&&128>e&&(t.IntCache_[e]=r),r},t.fromNumber=function(e){return isNaN(e)||!isFinite(e)?t.ZERO:e<=-t.TWO_PWR_63_DBL_?t.MIN_VALUE:e+1>=t.TWO_PWR_63_DBL_?t.MAX_VALUE:0>e?t.fromNumber(-e).negate():new t(e%t.TWO_PWR_32_DBL_|0,e/t.TWO_PWR_32_DBL_|0)},t.fromBits=function(e,n){return new t(e,n)},t.fromString=function(e,n){if(0==e.length)throw Error("number format error: empty string");var r=n||10;if(2>r||r>36)throw Error("radix out of range: "+r);if("-"==e.charAt(0))return t.fromString(e.substring(1),r).negate();if(e.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+e);for(var a=t.fromNumber(Math.pow(r,8)),i=t.ZERO,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),u=parseInt(e.substring(o,o+s),r);if(8>s){var c=t.fromNumber(Math.pow(r,s));i=i.multiply(c).add(t.fromNumber(u))}else i=i.multiply(a),i=i.add(t.fromNumber(u))}return i},t.prototype.toInt=function(){return this.low_},t.prototype.toNumber=function(){return this.high_*t.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},t.prototype.toString=function(e){var n=e||10;if(2>n||n>36)throw Error("radix out of range: "+n);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(t.MIN_VALUE)){var r=t.fromNumber(n),a=this.div(r),i=a.multiply(r).subtract(this);return a.toString(n)+i.toInt().toString(n)}return"-"+this.negate().toString(n)}for(var o=t.fromNumber(Math.pow(n,6)),i=this,s="";;){var u=i.div(o),c=i.subtract(u.multiply(o)).toInt(),l=c.toString(n);if(i=u,i.isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}},t.prototype.getHighBits=function(){return this.high_},t.prototype.getLowBits=function(){return this.low_},t.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:t.TWO_PWR_32_DBL_+this.low_},t.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(t.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!=this.high_?this.high_:this.low_,n=31;n>0&&0==(e&1<<n);n--);return 0!=this.high_?n+33:n+1},t.prototype.isZero=function(){return 0==this.high_&&0==this.low_},t.prototype.isNegative=function(){return this.high_<0},t.prototype.isOdd=function(){return 1==(1&this.low_)},t.prototype.equals=function(t){return this.high_==t.high_&&this.low_==t.low_},t.prototype.notEquals=function(t){return this.high_!=t.high_||this.low_!=t.low_},t.prototype.lessThan=function(t){return this.compare(t)<0},t.prototype.lessThanOrEqual=function(t){return this.compare(t)<=0},t.prototype.greaterThan=function(t){return this.compare(t)>0},t.prototype.greaterThanOrEqual=function(t){return this.compare(t)>=0},t.prototype.compare=function(t){if(this.equals(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.subtract(t).isNegative()?-1:1},t.prototype.negate=function(){return this.equals(t.MIN_VALUE)?t.MIN_VALUE:this.not().add(t.ONE)},t.prototype.add=function(e){var n=this.high_>>>16,r=65535&this.high_,a=this.low_>>>16,i=65535&this.low_,o=e.high_>>>16,s=65535&e.high_,u=e.low_>>>16,c=65535&e.low_,l=0,f=0,_=0,p=0;return p+=i+c,_+=p>>>16,p&=65535,_+=a+u,f+=_>>>16,_&=65535,f+=r+s,l+=f>>>16,f&=65535,l+=n+o,l&=65535,t.fromBits(_<<16|p,l<<16|f)},t.prototype.subtract=function(t){return this.add(t.negate())},t.prototype.multiply=function(e){if(this.isZero())return t.ZERO;if(e.isZero())return t.ZERO;if(this.equals(t.MIN_VALUE))return e.isOdd()?t.MIN_VALUE:t.ZERO;if(e.equals(t.MIN_VALUE))return this.isOdd()?t.MIN_VALUE:t.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(t.TWO_PWR_24_)&&e.lessThan(t.TWO_PWR_24_))return t.fromNumber(this.toNumber()*e.toNumber());var n=this.high_>>>16,r=65535&this.high_,a=this.low_>>>16,i=65535&this.low_,o=e.high_>>>16,s=65535&e.high_,u=e.low_>>>16,c=65535&e.low_,l=0,f=0,_=0,p=0;return p+=i*c,_+=p>>>16,p&=65535,_+=a*c,f+=_>>>16,_&=65535,_+=i*u,f+=_>>>16,_&=65535,f+=r*c,l+=f>>>16,f&=65535,f+=a*u,l+=f>>>16,f&=65535,f+=i*s,l+=f>>>16,f&=65535,l+=n*c+r*u+a*s+i*o,l&=65535,t.fromBits(_<<16|p,l<<16|f)},t.prototype.div=function(e){if(e.isZero())throw Error("division by zero");if(this.isZero())return t.ZERO;if(this.equals(t.MIN_VALUE)){if(e.equals(t.ONE)||e.equals(t.NEG_ONE))return t.MIN_VALUE;if(e.equals(t.MIN_VALUE))return t.ONE;var n=this.shiftRight(1),r=n.div(e).shiftLeft(1);if(r.equals(t.ZERO))return e.isNegative()?t.ONE:t.NEG_ONE;var a=this.subtract(e.multiply(r)),i=r.add(a.div(e));return i}if(e.equals(t.MIN_VALUE))return t.ZERO;if(this.isNegative())return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate();if(e.isNegative())return this.div(e.negate()).negate();for(var o=t.ZERO,a=this;a.greaterThanOrEqual(e);){var s=Math.max(1,Math.floor(a.toNumber()/e.toNumber())),u=Math.ceil(Math.log(s)/Math.LN2),c=1;u>48&&(c=Math.pow(2,u-48));for(var l=t.fromNumber(s),f=l.multiply(e);f.isNegative()||f.greaterThan(a);)s-=c,l=t.fromNumber(s),f=l.multiply(e);l.isZero()&&(l=t.ONE),o=o.add(l),a=a.subtract(f)}return o},t.prototype.modulo=function(t){return this.subtract(this.div(t).multiply(t))},t.prototype.not=function(){return t.fromBits(~this.low_,~this.high_)},t.prototype.and=function(e){return t.fromBits(this.low_&e.low_,this.high_&e.high_)},t.prototype.or=function(e){return t.fromBits(this.low_|e.low_,this.high_|e.high_)},t.prototype.xor=function(e){return t.fromBits(this.low_^e.low_,this.high_^e.high_)},t.prototype.shiftLeft=function(e){if(e&=63,0==e)return this;var n=this.low_;if(32>e){var r=this.high_;return t.fromBits(n<<e,r<<e|n>>>32-e)}return t.fromBits(0,n<<e-32)},t.prototype.shiftRight=function(e){if(e&=63,0==e)return this;var n=this.high_;if(32>e){var r=this.low_;return t.fromBits(r>>>e|n<<32-e,n>>e)}return t.fromBits(n>>e-32,n>=0?0:-1)},t.prototype.shiftRightUnsigned=function(e){if(e&=63,0==e)return this;var n=this.high_;if(32>e){var r=this.low_;return t.fromBits(r>>>e|n<<32-e,n>>>e)}return 32==e?t.fromBits(n,0):t.fromBits(n>>>e-32,0)},t.IntCache_={},t.TWO_PWR_16_DBL_=65536,t.TWO_PWR_24_DBL_=1<<24,t.TWO_PWR_32_DBL_=t.TWO_PWR_16_DBL_*t.TWO_PWR_16_DBL_,t.TWO_PWR_31_DBL_=t.TWO_PWR_32_DBL_/2,t.TWO_PWR_48_DBL_=t.TWO_PWR_32_DBL_*t.TWO_PWR_16_DBL_,t.TWO_PWR_64_DBL_=t.TWO_PWR_32_DBL_*t.TWO_PWR_32_DBL_,t.TWO_PWR_63_DBL_=t.TWO_PWR_64_DBL_/2,t.ZERO=t.fromInt(0),t.ONE=t.fromInt(1),t.NEG_ONE=t.fromInt(-1),t.MAX_VALUE=t.fromBits(4294967295,2147483647),t.MIN_VALUE=t.fromBits(0,2147483648),t.TWO_PWR_24_=t.fromInt(t.TWO_PWR_24_DBL_),t}();return t}),define("src/util",["require","exports","./gLong"],function(t,e,n){function r(){return"browser"===process.platform}function a(t,e,n){function r(){a++,a<t.length?e(t[a],r):n()}var a=-1;r()}function i(t,e){for(var n=new Array(t),r=0;t>r;r++)n[r]=e;return n}function o(t,e,n){if(0===n){var r=t.get_bs_class("Ljava/lang/ArithmeticException;");t.java_throw(r,"/ by zero")}return e%n}function s(t,n,r){if(0===r){var a=t.get_bs_class("Ljava/lang/ArithmeticException;");t.java_throw(a,"/ by zero")}return n===e.INT_MIN&&-1===r?n:n/r|0}function u(t,e,n){if(n.isZero()){var r=t.get_bs_class("Ljava/lang/ArithmeticException;");t.java_throw(r,"/ by zero")}return e.modulo(n)}function c(t,e,n){if(n.isZero()){var r=t.get_bs_class("Ljava/lang/ArithmeticException;");t.java_throw(r,"/ by zero")}return e.div(n)}function l(t){return t>e.INT_MAX?e.INT_MAX:t<e.INT_MIN?e.INT_MIN:0|t}function f(t){if("undefined"!=typeof Int32Array){var n=new Int32Array([t]),r=new Float32Array(n.buffer);return r[0]}if(t===e.FLOAT_POS_INFINITY_AS_INT)return Number.POSITIVE_INFINITY;if(t===e.FLOAT_NEG_INFINITY_AS_INT)return Number.NEGATIVE_INFINITY;var a,i=(2147483648&t)>>>31,o=(2139095040&t)>>>23,s=8388607&t;return a=0===o?Math.pow(-1,i)*s*Math.pow(2,-149):Math.pow(-1,i)*(1+s*Math.pow(2,-23))*Math.pow(2,o-127),(a<e.FLOAT_NEG_INFINITY||a>e.FLOAT_POS_INFINITY)&&(a=0/0),a}function _(t,n){if("undefined"!=typeof Uint32Array){var r=new Uint32Array(2);r[0]=n,r[1]=t;var a=new Float64Array(r.buffer);return a[0]}var i=(2147483648&t)>>>31,o=(2146435072&t)>>>20,s=e.lshift(1048575&t,32)+n;return 0===o&&0===s?0:2047===o?0===s?1===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:0/0:0===o?Math.pow(-1,i)*s*Math.pow(2,-1074):Math.pow(-1,i)*(1+s*Math.pow(2,-52))*Math.pow(2,o-1023)}function p(t){return t>3.4028234663852886e38?Number.POSITIVE_INFINITY:t>0&&1.401298464324817e-45>t?0:-3.4028234663852886e38>t?Number.NEGATIVE_INFINITY:0>t&&t>-1.401298464324817e-45?0:t}function h(t,e){return t===e?0:e>t?-1:t>e?1:null}function d(t,e){return t*Math.pow(2,e)}function g(t){for(var n=t.length-1,r=0,a=0;n>=a;a++)r+=e.lshift(t[a],8*(n-a));return r}function v(t,n,r){var a=n||0;return e.bytes2str(t.array).substr(a,r)}function m(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function y(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}function j(t){return{"public":(1&t)>0,"private":(2&t)>0,"protected":(4&t)>0,"static":(8&t)>0,"final":(16&t)>0,"synchronized":(32&t)>0,"super":(32&t)>0,"volatile":(64&t)>0,"transient":(128&t)>0,"native":(256&t)>0,"interface":(512&t)>0,"abstract":(1024&t)>0,strict:(2048&t)>0}}function b(t){for(var e=[],n=0;n<arguments.length-1;n++)e[n]=arguments[n+1];switch(t){case"\n":return"\\n";case"\r":return"\\r";case"	":return"\\t";case"":return"\\v";case"\f":return"\\f";default:return t}}function w(t){return t.replace(/\s/g,b)}function L(t){return 0===t.indexOf("<")&&t.indexOf(">")===t.length-1&&(t='"'+t+'"'),t}function x(t){var e=t.indexOf("(");return L(t.slice(0,e))+":"+t.slice(e)}function I(t){return 0===t.indexOf("[")&&2===t.length&&(t='"'+t+'"'),t}function k(t){var n=t.type,r="function"==typeof t.deref?t.deref():void 0;if(!r)return"";switch(n){case"Method":case"InterfaceMethod":return"	//  "+this.descriptor2typestr(r.class_desc)+"."+x(r.sig);case"Field":return"	//  "+this.descriptor2typestr(r.class_desc)+"."+r.name+":"+r.type;case"NameAndType":return"//  "+L(r.name)+":"+r.type;case"class":return"	//  "+I(this.descriptor2typestr(r));default:if(e.is_string(r))return"	//  "+e.escape_whitespace(r)}}function O(t){if("J"===t)return n.ZERO;var e=t[0];return"["===e||"L"===e?null:0}function S(t){return"string"==typeof t||t instanceof String}function E(t){return e.descriptor2typestr(t).replace(/\//g,".")}function N(t){return e.typestr2descriptor(t.replace(/\./g,"/"))}function A(t){var n=t.match(/^\[*/)[0].length;if(n>255)return!1;if(n>0&&(t=t.slice(n)),"L"===t[0]){if(";"!==t[t.length-1])return!1;t=t.slice(1,-1)}if(t in e.internal2external)return!0;if(t.match(/\/{2,}/))return!1;for(var r=t.split("/"),a=0;a<r.length;a++)if(r[a].match(/[^$_a-z0-9]/i))return!1;return!0}function C(t){return t.slice(1)}function F(t){return"["===t[0]}function T(t){return t in e.internal2external}function D(t){return"L"===t[0]}function M(t){var n=t[0];if(n in e.internal2external)return e.internal2external[n];if("L"===n)return t.slice(1,-1);if("["===n)return t;throw new Error("Unrecognized type string: "+t)}function V(t){var n=t.shift();if(null==n)return null;if(void 0!==e.internal2external[n])return n;if("L"===n){for(var r="L";";"!==(n=t.shift());)r+=n;return r+";"}if("["===n)return"["+e.carr2descriptor(t);throw t.unshift(n),new Error("Unrecognized descriptor: "+t.join(""))}function B(t){return void 0!==e.external2internal[t]?e.external2internal[t]:"["===t[0]?t:"L"+t+";"}function J(t,e){for(var n,r,a=0,i="";a<t.length;){var o=255&t[a++];if(e&&0==o)break;i+=String.fromCharCode(127>=o?o:223>=o?(n=t[a++],((31&o)<<6)+(63&n)):(n=t[a++],r=t[a++],((15&o)<<12)+((63&n)<<6)+(63&r)))}return i}function R(t){return t[t.length-1]}e.are_in_browser=r,e.async_foreach=a,e.INT_MAX=Math.pow(2,31)-1,e.INT_MIN=-e.INT_MAX-1,e.FLOAT_POS_INFINITY=Math.pow(2,128),e.FLOAT_NEG_INFINITY=-1*e.FLOAT_POS_INFINITY,e.FLOAT_POS_INFINITY_AS_INT=2139095040,e.FLOAT_NEG_INFINITY_AS_INT=-8388608,e.FLOAT_NaN_AS_INT=2143289344,null==Math.imul&&(Math.imul=function(t,e){var n=t>>>16&65535,r=65535&t,a=e>>>16&65535,i=65535&e;return r*i+(n*i+r*a<<16>>>0)|0}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(null==this)throw new TypeError;var n=Object(this),r=n.length>>>0;if(0===r)return-1;var a=0;if(void 0!==e&&(a=Number(e),a!=a?a=0:0!=a&&1/0!=a&&a!=-1/0&&(a=((a>0?1:0)||-1)*Math.floor(Math.abs(a)))),a>=r)return-1;for(var i=a>=0?a:Math.max(r-Math.abs(a),0);r>i;i++)if(i in n&&n[i]===t)return i;return-1}),e.arrayset=i,e.int_mod=o,e.int_div=s,e.long_mod=u,e.long_div=c,e.float2int=l,e.intbits2float=f,e.longbits2double=_,e.wrap_float=p,e.cmp=h,e.lshift=d,e.read_uint=g,e.chars2js_str=v,e.bytestr_to_array=m,e.array_to_bytestr=y,e.parse_flags=j,e.escape_whitespace=w,e.format_extra_info=k;var z=function(){function t(t,e,n){this.buffer=t,this.start=null!=e?e:0,this.end=null!=n?n:this.buffer.length,this._index=0}return t.prototype.rewind=function(){this._index=0},t.prototype.pos=function(){return this._index},t.prototype.skip=function(t){this._index+=t},t.prototype.has_bytes=function(){return this.start+this._index<this.end},t.prototype.get_uint=function(t){var e=this.start+this._index;switch(this._index+=t,t){case 1:return this.buffer.readUInt8(e);case 2:return this.buffer.readUInt16BE(e);case 4:return this.buffer.readUInt32BE(e);default:throw this._index-=t,new Error("Cannot read a uint of size "+t)}},t.prototype.get_int=function(t){var e=32-8*t;return this.get_uint(t)<<e>>e},t.prototype.read=function(t){for(var e=[],n=this.start+this._index;n<this.start+this._index+t;n++)e.push(this.buffer.readUInt8(n));return this._index+=t,e},t.prototype.peek=function(){return this.buffer.readUInt8(this.start+this._index)},t.prototype.size=function(){return this.end-this.start-this._index},t.prototype.splice=function(e){var n=new t(this.buffer,this.start+this._index,this.start+this._index+e);return this._index+=e,n},t.prototype.slice=function(t){var e=this.buffer.slice(this.start+this._index,this.start+this._index+t);return this._index+=t,e},t}();e.BytesArray=z,e.initial_value=O,e.is_string=S,e.ext_classname=E,e.int_classname=N,e.verify_int_classname=A,e.internal2external={B:"byte",C:"char",D:"double",F:"float",I:"int",J:"long",S:"short",V:"void",Z:"boolean"},e.external2internal={};for(var P in e.internal2external)e.external2internal[e.internal2external[P]]=P;e.get_component_type=C,e.is_array_type=F,e.is_primitive_type=T,e.is_reference_type=D,e.descriptor2typestr=M,e.carr2descriptor=V,e.typestr2descriptor=B,e.bytes2str=J,e.last=R;var $=function(){function t(){this.cache=Object.create(null)}return t.prototype.get=function(t){return null!=this.cache[t]?this.cache[t]:"__proto__"==t&&void 0!==this.proto_cache?this.proto_cache:void 0},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){"__proto__"!=t?this.cache[t]=e:this.proto_cache=e},t}();e.SafeMap=$}),define("src/logging",["require","exports","./gLong"],function(t,e,n){function r(t){return null===t?"!":void 0===t?"undef":null!=t.ref?"*"+t.ref:t instanceof n?t+"L":t}function a(t){return t.map(r)}function i(t,n){if(t<=e.log_level){var r=n.join(" ");1==t?console.error(r):console.log(r)}}function o(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];i(e.VTRACE,t)}function s(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];i(e.TRACE,t)}function u(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];i(e.DEBUG,t)}function c(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];i(e.ERROR,t)}e.debug_vars=a,e.VTRACE=10,e.TRACE=9,e.DEBUG=5,e.ERROR=1,e.log_level=e.ERROR,e.vtrace=o,e.trace=s,e.debug=u,e.error=c}),function(){var t=this,e=t._,n={},r=Array.prototype,a=Object.prototype,i=Function.prototype,o=r.push,s=r.slice,u=r.concat,c=a.toString,l=a.hasOwnProperty,f=r.forEach,_=r.map,p=r.reduce,h=r.reduceRight,d=r.filter,g=r.every,v=r.some,m=r.indexOf,y=r.lastIndexOf,j=Array.isArray,b=Object.keys,w=i.bind,L=function(t){return t instanceof L?t:this instanceof L?(this._wrapped=t,void 0):new L(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=L),exports._=L):t._=L,L.VERSION="1.5.2";var x=L.each=L.forEach=function(t,e,r){if(null!=t)if(f&&t.forEach===f)t.forEach(e,r);else if(t.length===+t.length){for(var a=0,i=t.length;i>a;a++)if(e.call(r,t[a],a,t)===n)return}else for(var o=L.keys(t),a=0,i=o.length;i>a;a++)if(e.call(r,t[o[a]],o[a],t)===n)return};L.map=L.collect=function(t,e,n){var r=[];return null==t?r:_&&t.map===_?t.map(e,n):(x(t,function(t,a,i){r.push(e.call(n,t,a,i))}),r)};var I="Reduce of empty array with no initial value";L.reduce=L.foldl=L.inject=function(t,e,n,r){var a=arguments.length>2;if(null==t&&(t=[]),p&&t.reduce===p)return r&&(e=L.bind(e,r)),a?t.reduce(e,n):t.reduce(e);if(x(t,function(t,i,o){a?n=e.call(r,n,t,i,o):(n=t,a=!0)}),!a)throw new TypeError(I);return n},L.reduceRight=L.foldr=function(t,e,n,r){var a=arguments.length>2;if(null==t&&(t=[]),h&&t.reduceRight===h)return r&&(e=L.bind(e,r)),a?t.reduceRight(e,n):t.reduceRight(e);var i=t.length;if(i!==+i){var o=L.keys(t);i=o.length}if(x(t,function(s,u,c){u=o?o[--i]:--i,a?n=e.call(r,n,t[u],u,c):(n=t[u],a=!0)}),!a)throw new TypeError(I);return n},L.find=L.detect=function(t,e,n){var r;return k(t,function(t,a,i){return e.call(n,t,a,i)?(r=t,!0):void 0}),r},L.filter=L.select=function(t,e,n){var r=[];return null==t?r:d&&t.filter===d?t.filter(e,n):(x(t,function(t,a,i){e.call(n,t,a,i)&&r.push(t)}),r)},L.reject=function(t,e,n){return L.filter(t,function(t,r,a){return!e.call(n,t,r,a)},n)},L.every=L.all=function(t,e,r){e||(e=L.identity);var a=!0;return null==t?a:g&&t.every===g?t.every(e,r):(x(t,function(t,i,o){return(a=a&&e.call(r,t,i,o))?void 0:n}),!!a)};var k=L.some=L.any=function(t,e,r){e||(e=L.identity);var a=!1;return null==t?a:v&&t.some===v?t.some(e,r):(x(t,function(t,i,o){return a||(a=e.call(r,t,i,o))?n:void 0}),!!a)};L.contains=L.include=function(t,e){return null==t?!1:m&&t.indexOf===m?-1!=t.indexOf(e):k(t,function(t){return t===e})},L.invoke=function(t,e){var n=s.call(arguments,2),r=L.isFunction(e);return L.map(t,function(t){return(r?e:t[e]).apply(t,n)})},L.pluck=function(t,e){return L.map(t,function(t){return t[e]})},L.where=function(t,e,n){return L.isEmpty(e)?n?void 0:[]:L[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},L.findWhere=function(t,e){return L.where(t,e,!0)},L.max=function(t,e,n){if(!e&&L.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&L.isEmpty(t))return-1/0;var r={computed:-1/0,value:-1/0};return x(t,function(t,a,i){var o=e?e.call(n,t,a,i):t;o>r.computed&&(r={value:t,computed:o})}),r.value},L.min=function(t,e,n){if(!e&&L.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&L.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return x(t,function(t,a,i){var o=e?e.call(n,t,a,i):t;o<r.computed&&(r={value:t,computed:o})}),r.value},L.shuffle=function(t){var e,n=0,r=[];return x(t,function(t){e=L.random(n++),r[n-1]=r[e],r[e]=t}),r},L.sample=function(t,e,n){return arguments.length<2||n?t[L.random(t.length-1)]:L.shuffle(t).slice(0,Math.max(0,e))};var O=function(t){return L.isFunction(t)?t:function(e){return e[t]}};L.sortBy=function(t,e,n){var r=O(e);return L.pluck(L.map(t,function(t,e,a){return{value:t,index:e,criteria:r.call(n,t,e,a)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index-e.index}),"value")};var S=function(t){return function(e,n,r){var a={},i=null==n?L.identity:O(n);return x(e,function(n,o){var s=i.call(r,n,o,e);t(a,s,n)}),a}};L.groupBy=S(function(t,e,n){(L.has(t,e)?t[e]:t[e]=[]).push(n)}),L.indexBy=S(function(t,e,n){t[e]=n}),L.countBy=S(function(t,e){L.has(t,e)?t[e]++:t[e]=1}),L.sortedIndex=function(t,e,n,r){n=null==n?L.identity:O(n);for(var a=n.call(r,e),i=0,o=t.length;o>i;){var s=i+o>>>1;n.call(r,t[s])<a?i=s+1:o=s}return i},L.toArray=function(t){return t?L.isArray(t)?s.call(t):t.length===+t.length?L.map(t,L.identity):L.values(t):[]},L.size=function(t){return null==t?0:t.length===+t.length?t.length:L.keys(t).length},L.first=L.head=L.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:s.call(t,0,e)},L.initial=function(t,e,n){return s.call(t,0,t.length-(null==e||n?1:e))},L.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:s.call(t,Math.max(t.length-e,0))},L.rest=L.tail=L.drop=function(t,e,n){return s.call(t,null==e||n?1:e)},L.compact=function(t){return L.filter(t,L.identity)};var E=function(t,e,n){return e&&L.every(t,L.isArray)?u.apply(n,t):(x(t,function(t){L.isArray(t)||L.isArguments(t)?e?o.apply(n,t):E(t,e,n):n.push(t)}),n)};L.flatten=function(t,e){return E(t,e,[])},L.without=function(t){return L.difference(t,s.call(arguments,1))},L.uniq=L.unique=function(t,e,n,r){L.isFunction(e)&&(r=n,n=e,e=!1);var a=n?L.map(t,n,r):t,i=[],o=[];return x(a,function(n,r){(e?r&&o[o.length-1]===n:L.contains(o,n))||(o.push(n),i.push(t[r]))}),i},L.union=function(){return L.uniq(L.flatten(arguments,!0))},L.intersection=function(t){var e=s.call(arguments,1);return L.filter(L.uniq(t),function(t){return L.every(e,function(e){return L.indexOf(e,t)>=0})})},L.difference=function(t){var e=u.apply(r,s.call(arguments,1));return L.filter(t,function(t){return!L.contains(e,t)})},L.zip=function(){for(var t=L.max(L.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;t>n;n++)e[n]=L.pluck(arguments,""+n);return e},L.object=function(t,e){if(null==t)return{};for(var n={},r=0,a=t.length;a>r;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},L.indexOf=function(t,e,n){if(null==t)return-1;var r=0,a=t.length;if(n){if("number"!=typeof n)return r=L.sortedIndex(t,e),t[r]===e?r:-1;r=0>n?Math.max(0,a+n):n}if(m&&t.indexOf===m)return t.indexOf(e,n);for(;a>r;r++)if(t[r]===e)return r;return-1},L.lastIndexOf=function(t,e,n){if(null==t)return-1;var r=null!=n;if(y&&t.lastIndexOf===y)return r?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var a=r?n:t.length;a--;)if(t[a]===e)return a;return-1},L.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/n),0),a=0,i=new Array(r);r>a;)i[a++]=t,t+=n;return i};var N=function(){};L.bind=function(t,e){var n,r;if(w&&t.bind===w)return w.apply(t,s.call(arguments,1));if(!L.isFunction(t))throw new TypeError;return n=s.call(arguments,2),r=function(){if(!(this instanceof r))return t.apply(e,n.concat(s.call(arguments)));N.prototype=t.prototype;var a=new N;N.prototype=null;var i=t.apply(a,n.concat(s.call(arguments)));return Object(i)===i?i:a}},L.partial=function(t){var e=s.call(arguments,1);return function(){return t.apply(this,e.concat(s.call(arguments)))}},L.bindAll=function(t){var e=s.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return x(e,function(e){t[e]=L.bind(t[e],t)}),t},L.memoize=function(t,e){var n={};return e||(e=L.identity),function(){var r=e.apply(this,arguments);return L.has(n,r)?n[r]:n[r]=t.apply(this,arguments)}},L.delay=function(t,e){var n=s.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},L.defer=function(t){return L.delay.apply(L,[t,1].concat(s.call(arguments,1)))},L.throttle=function(t,e,n){var r,a,i,o=null,s=0;n||(n={});var u=function(){s=n.leading===!1?0:new Date,o=null,i=t.apply(r,a)};return function(){var c=new Date;s||n.leading!==!1||(s=c);var l=e-(c-s);return r=this,a=arguments,0>=l?(clearTimeout(o),o=null,s=c,i=t.apply(r,a)):o||n.trailing===!1||(o=setTimeout(u,l)),i}},L.debounce=function(t,e,n){var r,a,i,o,s;return function(){i=this,a=arguments,o=new Date;var u=function(){var c=new Date-o;e>c?r=setTimeout(u,e-c):(r=null,n||(s=t.apply(i,a)))},c=n&&!r;return r||(r=setTimeout(u,e)),c&&(s=t.apply(i,a)),s}},L.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},L.wrap=function(t,e){return function(){var n=[t];return o.apply(n,arguments),e.apply(this,n)}},L.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},L.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},L.keys=b||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)L.has(t,n)&&e.push(n);return e},L.values=function(t){for(var e=L.keys(t),n=e.length,r=new Array(n),a=0;n>a;a++)r[a]=t[e[a]];return r},L.pairs=function(t){for(var e=L.keys(t),n=e.length,r=new Array(n),a=0;n>a;a++)r[a]=[e[a],t[e[a]]];return r},L.invert=function(t){for(var e={},n=L.keys(t),r=0,a=n.length;a>r;r++)e[t[n[r]]]=n[r];return e},L.functions=L.methods=function(t){var e=[];for(var n in t)L.isFunction(t[n])&&e.push(n);return e.sort()},L.extend=function(t){return x(s.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},L.pick=function(t){var e={},n=u.apply(r,s.call(arguments,1));return x(n,function(n){n in t&&(e[n]=t[n])}),e},L.omit=function(t){var e={},n=u.apply(r,s.call(arguments,1));for(var a in t)L.contains(n,a)||(e[a]=t[a]);return e},L.defaults=function(t){return x(s.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t},L.clone=function(t){return L.isObject(t)?L.isArray(t)?t.slice():L.extend({},t):t},L.tap=function(t,e){return e(t),t};var A=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof L&&(t=t._wrapped),e instanceof L&&(e=e._wrapped);var a=c.call(t);if(a!=c.call(e))return!1;switch(a){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var i=n.length;i--;)if(n[i]==t)return r[i]==e;var o=t.constructor,s=e.constructor;if(o!==s&&!(L.isFunction(o)&&o instanceof o&&L.isFunction(s)&&s instanceof s))return!1;n.push(t),r.push(e);var u=0,l=!0;if("[object Array]"==a){if(u=t.length,l=u==e.length)for(;u--&&(l=A(t[u],e[u],n,r)););}else{for(var f in t)if(L.has(t,f)&&(u++,!(l=L.has(e,f)&&A(t[f],e[f],n,r))))break;if(l){for(f in e)if(L.has(e,f)&&!u--)break;l=!u}}return n.pop(),r.pop(),l};L.isEqual=function(t,e){return A(t,e,[],[])},L.isEmpty=function(t){if(null==t)return!0;if(L.isArray(t)||L.isString(t))return 0===t.length;for(var e in t)if(L.has(t,e))return!1;return!0},L.isElement=function(t){return!(!t||1!==t.nodeType)},L.isArray=j||function(t){return"[object Array]"==c.call(t)},L.isObject=function(t){return t===Object(t)},x(["Arguments","Function","String","Number","Date","RegExp"],function(t){L["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),L.isArguments(arguments)||(L.isArguments=function(t){return!(!t||!L.has(t,"callee"))}),"function"!=typeof/./&&(L.isFunction=function(t){return"function"==typeof t}),L.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},L.isNaN=function(t){return L.isNumber(t)&&t!=+t},L.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},L.isNull=function(t){return null===t},L.isUndefined=function(t){return void 0===t},L.has=function(t,e){return l.call(t,e)},L.noConflict=function(){return t._=e,this},L.identity=function(t){return t},L.times=function(t,e,n){for(var r=Array(Math.max(0,t)),a=0;t>a;a++)r[a]=e.call(n,a);return r},L.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var C={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};C.unescape=L.invert(C.escape);var F={escape:new RegExp("["+L.keys(C.escape).join("")+"]","g"),unescape:new RegExp("("+L.keys(C.unescape).join("|")+")","g")};
L.each(["escape","unescape"],function(t){L[t]=function(e){return null==e?"":(""+e).replace(F[t],function(e){return C[t][e]})}}),L.result=function(t,e){if(null==t)return void 0;var n=t[e];return L.isFunction(n)?n.call(t):n},L.mixin=function(t){x(L.functions(t),function(e){var n=L[e]=t[e];L.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),B.call(this,n.apply(L,t))}})};var T=0;L.uniqueId=function(t){var e=++T+"";return t?t+e:e},L.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},V=/\\|'|\r|\n|\t|\u2028|\u2029/g;L.template=function(t,e,n){var r;n=L.defaults({},n,L.templateSettings);var a=new RegExp([(n.escape||D).source,(n.interpolate||D).source,(n.evaluate||D).source].join("|")+"|$","g"),i=0,o="__p+='";t.replace(a,function(e,n,r,a,s){return o+=t.slice(i,s).replace(V,function(t){return"\\"+M[t]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),a&&(o+="';\n"+a+"\n__p+='"),i=s+e.length,e}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(s){throw s.source=o,s}if(e)return r(e,L);var u=function(t){return r.call(this,t,L)};return u.source="function("+(n.variable||"obj")+"){\n"+o+"}",u},L.chain=function(t){return L(t).chain()};var B=function(t){return this._chain?L(t).chain():t};L.mixin(L),x(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];L.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],B.call(this,n)}}),x(["concat","join","slice"],function(t){var e=r[t];L.prototype[t]=function(){return B.call(this,e.apply(this._wrapped,arguments))}}),L.extend(L.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("vendor/underscore/underscore",function(t){return function(){var e;return e||t._}}(this));var __extends=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};define("src/exceptions",["require","exports","./logging","../vendor/underscore/underscore"],function(t,e,n){var r=t("../vendor/underscore/underscore"),a=(n.debug,function(){function t(t){this.exit_code=t}return t.prototype.toplevel_catch_handler=function(){return 0!==this.exit_code?n.error("\nExited with code "+this.exit_code):void 0},t}());e.HaltException=a,e.ReturnException="RETURNEXCEPTION";var i=function(){function t(t){this.condition=t}return t}();e.YieldException=i;var o=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(i);e.YieldIOException=o;var s=function(){function t(t){this.exception=t}return t.prototype.method_catch_handler=function(t,e,n){var a=this,i=e.method;if(!n&&i.has_bytecode){e.pc-=3;for(var o;!(e.pc<=0||null!=(o=i.code.opcodes[e.pc])&&o.name.match(/^invoke/));)--e.pc}if(e["native"])return null!=e.error?(e.runner=function(){return e.error(a)},!0):!1;var s=i.code.exception_handlers,u=this.exception.cls,c=r.find(s,function(t){return t.start_pc<=e.pc&&e.pc<t.end_pc&&null!=i.cls.loader.get_resolved_class(t.catch_type,!0)&&("<any>"===t.catch_type||u.is_castable(i.cls.loader.get_resolved_class(t.catch_type)))});return null!=c?(e.stack=[this.exception],e.pc=c.handler_pc,!0):!1},t.prototype.toplevel_catch_handler=function(t){this.exception.get_field(t,"Ljava/lang/Throwable;detailMessage");t.push2(t.curr_thread,this.exception);var e=t.get_bs_class("Ljava/lang/Thread;"),n=e.method_lookup(t,"dispatchUncaughtException(Ljava/lang/Throwable;)V");n.setup_stack(t)},t}();e.JavaException=s}),define("src/enums",["require","exports"],function(t,e){!function(t){t[t.LOADED=0]="LOADED",t[t.RESOLVED=1]="RESOLVED",t[t.INITIALIZED=2]="INITIALIZED"}(e.ClassState||(e.ClassState={}));e.ClassState});var __extends=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};define("src/java_object",["require","exports","./gLong","./util","./enums","../vendor/underscore/underscore"],function(t,e,n,r,a){var i=t("../vendor/underscore/underscore"),o=a.ClassState,s=function(){function t(t,e,n){this.cls=e,this.ref=t.high_oref++,this.array=n}return t.prototype.clone=function(e){return new t(e,this.cls,i.clone(this.array))},t.prototype.get_field_from_offset=function(t,e){return this.array[e.toInt()]},t.prototype.set_field_from_offset=function(t,e,n){this.array[e.toInt()]=n},t.prototype.toString=function(){return this.array.length<=10?"<"+this.cls.get_type()+" ["+this.array+"] (*"+this.ref+")>":"<"+this.cls.get_type()+" of length "+this.array.length+" (*"+this.ref+")>"},t.prototype.serialize=function(t){function e(e){return e?"function"!=typeof e.serialize?e:e.serialize(t):e}return t[this.ref]?"<*"+this.ref+">":(t[this.ref]=!0,{type:this.cls.get_type(),ref:this.ref,array:this.array.map(e)})},t}();e.JavaArray=s;var u=function(){function t(t,e,n){this.cls=e,null==n&&(n={}),this.ref=t.high_oref++,this.fields=Object.create(this.cls.get_default_fields());for(var r in n)n.hasOwnProperty(r)&&(this.fields[r]=n[r])}return t.prototype.clone=function(e){return new t(e,this.cls,i.clone(this.fields))},t.prototype.set_field=function(t,e,n){void 0!==this.fields[e]?this.fields[e]=n:t.java_throw(this.cls.loader.get_initialized_class("Ljava/lang/NoSuchFieldError;"),"Cannot set field "+e+" on class "+this.cls.get_type())},t.prototype.get_field=function(t,e){return void 0!==this.fields[e]?this.fields[e]:t.java_throw(this.cls.loader.get_initialized_class("Ljava/lang/NoSuchFieldError;"),"Cannot get field "+e+" from class "+this.cls.get_type())},t.prototype.get_field_from_offset=function(t,e){var n=this._get_field_from_offset(t,this.cls,e.toInt());return n.field.access_flags["static"]?n.cls_obj.static_get(t,n.field.name):this.get_field(t,n.cls+n.field.name)},t.prototype._get_field_from_offset=function(t,e,n){for(var r=e.get_type();null!=e;){var a=e.get_class_object(t).ref,i=e.get_fields()[n-a];if(null!=i)return{field:i,cls:e.get_type(),cls_obj:e};e=e.get_super_class()}return t.java_throw(this.cls.loader.get_initialized_class("Ljava/lang/NullPointerException;"),"field "+n+" doesn't exist in class "+r)},t.prototype.set_field_from_offset=function(t,e,n){var r=this._get_field_from_offset(t,this.cls,e.toInt());r.field.access_flags["static"]?r.cls_obj.static_put(t,r.field.name,n):this.set_field(t,r.cls+r.field.name,n)},t.prototype.toString=function(){return"Ljava/lang/String;"===this.cls.get_type()?"<"+this.cls.get_type()+" '"+this.jvm2js_str()+"' (*"+this.ref+")>":"<"+this.cls.get_type()+" (*"+this.ref+")>"},t.prototype.serialize=function(t){if(this.ref in t)return"<*"+this.ref+">";t[this.ref]=!0;{var e={};this.fields}for(var n in this.fields){var r=this.fields[n];e[n]=r&&r.serialize?r.serialize(t):r}return{type:this.cls.get_type(),ref:this.ref,fields:e}},t.prototype.jvm2js_str=function(){return r.chars2js_str(this.fields["Ljava/lang/String;value"],this.fields["Ljava/lang/String;offset"],this.fields["Ljava/lang/String;count"])},t}();e.JavaObject=u;var c=function(t){function e(e,n){t.call(this,e,e.get_bs_cl().get_resolved_class("Ljava/lang/Class;")),this.$cls=n}return __extends(e,t),e.prototype.toString=function(){return"<Class "+this.$cls.get_type()+" (*"+this.ref+")>"},e}(u);e.JavaClassObject=c;var l=function(t){function e(e,n){t.call(this,e,n),this.$loader=e.construct_cl(this)}return __extends(e,t),e.prototype.serialize=function(t){if(t[this.ref])return"<*"+this.ref+">";t[this.ref]=!0;var e={};for(var n in this.fields){var r=this.fields[n];e[n]=r&&"function"==typeof r.serialize?r.serialize(t):r}var a={};for(var i in this.$loader.loaded_classes){var s=this.$loader.loaded_classes[i];a[i+"("+o[s.get_state()]+")"]=s.loader.serialize(t)}return{type:this.cls.get_type(),ref:this.ref,fields:e,loaded:a}},e}(u);e.JavaClassLoaderObject=l});var __extends=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};define("src/ConstantPool",["require","exports","./gLong","./util"],function(t,e,n,r){var a,i=function(){function t(t,e){this.constant_pool=t,this.value=e}return t.from_bytes=function(t,e){var n=t.get_uint(2);return new this(e,n)},t.prototype.deref=function(){var t=this.constant_pool.get(this.value);return("function"==typeof t.deref?t.deref():void 0)||t.value},t.size=1,t}();e.SimpleReference=i;var o=function(t){function e(){t.apply(this,arguments),this.type="class"}return __extends(e,t),e.prototype.deref=function(){var t=this.constant_pool.get(this.value);return"function"==typeof t.deref?t.deref():r.typestr2descriptor(t.value)},e}(i);e.ClassReference=o,a=o;var s=function(t){function e(e,n){t.call(this,e,n),this.type="String"}return __extends(e,t),e}(i);e.StringReference=s,a=s;var u=function(){function t(t,e){this.constant_pool=t,this.value=e}return t.from_bytes=function(t,e){var n=o.from_bytes(t,e),r=i.from_bytes(t,e);return new this(e,{class_ref:n,sig:r})},t.prototype.deref=function(){var t=this.value.sig.deref();return{class_desc:this.value.class_ref.deref(),sig:t.name+t.type}},t.size=1,t}();e.AbstractMethodFieldReference=u;var c=function(t){function e(){t.apply(this,arguments),this.type="Method"}return __extends(e,t),e}(u);e.MethodReference=c,a=c;var l=function(t){function e(){t.apply(this,arguments),this.type="InterfaceMethod"}return __extends(e,t),e}(u);e.InterfaceMethodReference=l,a=l;var f=function(t){function e(){t.apply(this,arguments),this.type="Field"}return __extends(e,t),e.prototype.deref=function(){var t=this.value.sig.deref();return{class_desc:this.value.class_ref.deref(),name:t.name,type:t.type}},e}(u);e.FieldReference=f;var _=function(){function t(t,e){this.type="NameAndType",this.constant_pool=t,this.value=e}return t.from_bytes=function(t,e){var n=s.from_bytes(t,e),r=s.from_bytes(t,e);return new this(e,{meth_ref:n,type_ref:r})},t.prototype.deref=function(){return{name:this.value.meth_ref.deref(),type:this.value.type_ref.deref()}},t.size=1,t}();e.MethodSignature=_,a=_;var p=function(){function t(t){this.type="Asciz",this.value=t}return t.from_bytes=function(t){var e=t.get_uint(2),n=r.bytes2str(t.read(e));return new this(n)},t.size=1,t}();e.ConstString=p,a=p;var h=function(){function t(t){this.type="int",this.value=t}return t.from_bytes=function(t){var e=t.get_uint(4),n=-(1+~e);return new this(n)},t.size=1,t}();e.ConstInt32=h,a=h;var d=function(){function t(t){this.type="float",this.value=t}return t.from_bytes=function(t){var e=t.get_uint(4),n=r.intbits2float(0|e);return new this(n)},t.size=1,t}();e.ConstFloat=d,a=d;var g=function(){function t(t){this.type="long",this.value=t}return t.from_bytes=function(t){var e=t.get_uint(4),r=t.get_uint(4),a=n.fromBits(r,e);return new this(a)},t.size=2,t}();e.ConstLong=g,a=g;var v=function(){function t(t){this.type="double",this.value=t}return t.from_bytes=function(t){var e=t.get_uint(4),n=t.get_uint(4);return new this(r.longbits2double(e,n))},t.size=2,t}();e.ConstDouble=v,a=v;var m=function(){function t(){}return t.prototype.parse=function(t){var e={1:p,3:h,4:d,5:g,6:v,7:o,8:s,9:f,10:c,11:l,12:_};this.cp_count=t.get_uint(2),this.constant_pool={};for(var n=1;n<this.cp_count;){var r=t.get_uint(1);if(!(r>=1&&12>=r))throw"invalid tag: "+r;var a=e[r].from_bytes(t,this);this.constant_pool[n]=a,n+=e[r].size}return t},t.prototype.get=function(t){var e=this.constant_pool[t];if(null!=e)return e;throw new Error("Invalid constant_pool reference: "+t)},t.prototype.each=function(t){for(var e=0;e<this.cp_count;++e)e in this.constant_pool&&t(e,this.constant_pool[e])},t}();e.ConstantPool=m}),define("fs",[],function(){return BrowserFS.BFSRequire("fs")});var __extends=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};define("src/threading",["require","exports","./util","./java_object","fs","../vendor/underscore/underscore"],function(t,e,n,r,a){var i=t("../vendor/underscore/underscore"),o=function(t){function e(e,n,r){null==n?(n={get_type:function(){return"Ljava/lang/Thread;"},loader:e.get_bs_cl(),get_default_fields:function(){return null}},this.fake=!0):this.fake=!1,t.call(this,e,n,r),this.$isAlive=!0,this.wakeup_time=null,this.$park_count=0,this.$park_timeout=1/0,this.$meta_stack=new s}return __extends(e,t),e.prototype.clone=function(t){return new e(t,this.cls,i.clone(this.fields))},e.prototype.name=function(t){return n.chars2js_str(this.get_field(t,"Ljava/lang/Thread;name"))},e.prototype.dump_state=function(t){var e="/tmp/core-"+this.name(t)+".json",n=this.$meta_stack.dump_state();a.writeFile(e,n,"utf8",function(t){t?console.error(t):process.stdout.write("Wrote core dump to "+e+"\n")})},e}(r.JavaObject);e.JavaThreadObject=o;var s=function(){function t(t){this._cs=[u.native_frame("$bootstrap")],null!=t&&(this._cs[0].stack=t)}return t.prototype.dump_state=function(){var t={},e=this._cs.map(function(e){return e.snap(t)});return JSON.stringify(e.map(function(t){return t.serialize()}))},t.prototype.length=function(){return this._cs.length},t.prototype.push=function(t){return this._cs.push(t)},t.prototype.pop=function(){return this._cs.pop()},t.prototype.pop_n=function(t){this._cs.length-=t},t.prototype.curr_frame=function(){return n.last(this._cs)},t.prototype.get_caller=function(t){return this._cs[this._cs.length-1-t]},t}();e.CallStack=s;var u=function(){function t(t,e,n){this.method=t,this.locals=e,this.stack=n,this.pc=0,this.runner=null,this.native=!1,this.name=this.method.full_signature()}return t.prototype.snap=function(t){function e(e){return null!=e&&"function"==typeof e.serialize?e.serialize(t):e}function n(){return null!=r.method.cls&&(a.loader=r.method.cls.loader.serialize(t)),a.stack=r.stack.map(e),a.locals=r.locals.map(e),a}var r=this,a={name:this.name,pc:this.pc,"native":this.native,loader:null,stack:null,locals:null};return{serialize:n}},t.native_frame=function(e,n,r){var a=new t({full_signature:function(){return e}},[],[]);return a.runner=n,a.name=e,null!=r&&(a.error=r),a.native=!0,a},t}();e.StackFrame=u});var __extends=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};define("src/opcodes",["require","exports","./gLong","./util","./exceptions","./java_object","./threading"],function(t,e,n,r,a,i,o){function s(t){for(var e="name",n=0,r=0;r<t.length;r++){var a=t[r];switch(e){case"name":"("===a&&(e="type");break;case"type":if(")"===a)return n;"J"===a||"D"===a?n+=2:++n,"L"===a?e="class":"["===a&&(e="array");break;case"class":";"===a&&(e="type");break;case"array":"L"===a?e="class":"["!==a&&(e="type")}}}function u(t,e,n){null==e&&t.java_throw(t.get_bs_class("Ljava/lang/NullPointerException;"),"Cannot enter a null monitor.");var r=t.lock_refs[e.ref];if(null!=r){if(r!==t.curr_thread)return null!=n?n.inc_pc(t,1):t.inc_pc(1),t.meta_stack().push({}),t.wait(e),!1;t.lock_counts[e.ref]++}else t.lock_refs[e.ref]=t.curr_thread,t.lock_counts[e.ref]=1;return!0}function c(t,e){var n=t.lock_refs[e.ref];if(null!=n)if(n===t.curr_thread)t.lock_counts[e.ref]--,0===t.lock_counts[e.ref]&&(delete t.lock_refs[e.ref],null!=t.waiting_threads[e.ref]&&(t.waiting_threads[e.ref]=[]));else{var r=t.get_bs_class("Ljava/lang/IllegalMonitorStateException;");t.java_throw(r,"Thread "+t.curr_thread.name(t)+" tried to monitorexit on lock held by thread "+n.name(t)+".")}}var l=a.JavaException,f=a.ReturnException,_=i.JavaObject,p=(i.JavaArray,i.JavaClassLoaderObject),h=function(){function t(t,e,n){this.name=t,this.byte_count=e||0,this.execute=n||this._execute,this.orig_execute=this.execute}return t.prototype.take_args=function(t){this.args=[];for(var e=0;e<this.byte_count;e++)this.args.push(t.get_uint(1))},t.prototype.annotate=function(){return""},t.prototype.reset_cache=function(){this.execute!==this.orig_execute&&(this.execute=this.orig_execute)},t.prototype._execute=function(){throw new Error("ERROR: Unimplemented opcode.")},t.prototype.inc_pc=function(t,e){return t.inc_pc(e-1-this.byte_count)},t.prototype.goto_pc=function(t,e){return t.goto_pc(e-1-this.byte_count)},t}();e.Opcode=h;var d=function(t){function e(e,n){t.call(this,e,2,n)}return __extends(e,t),e.prototype.take_args=function(t,e){this.field_spec_ref=t.get_uint(2),this.field_spec=e.get(this.field_spec_ref).deref()},e.prototype.annotate=function(t,e){var n=r.format_extra_info(e.get(this.field_spec_ref));return"	#"+this.field_spec_ref+";"+n},e}(h);e.FieldOpcode=d;var g=function(t){function e(e,n){t.call(this,e,2,n)}return __extends(e,t),e.prototype.take_args=function(t,e){this.class_ref=t.get_uint(2),this.class_desc=e.get(this.class_ref).deref()},e.prototype.annotate=function(t,e){var n=r.format_extra_info(e.get(this.class_ref));return"	#"+this.class_ref+";"+n},e}(h);e.ClassOpcode=g;var v=function(t){function e(e){t.call(this,e,2)}return __extends(e,t),e.prototype.take_args=function(t,e){this.method_spec_ref=t.get_uint(2),this.method_spec=e.get(this.method_spec_ref).deref()},e.prototype.annotate=function(t,e){var n=r.format_extra_info(e.get(this.method_spec_ref));return"	#"+this.method_spec_ref+";"+n},e.prototype._execute=function(t){var e=t.get_class(this.method_spec.class_desc,!0);if(null!=e){var n=t.curr_frame(),r=e.method_lookup(t,this.method_spec.sig);if(null!=r){if(null!=r.setup_stack(t))return n.pc+=1+this.byte_count,!1}else{var a=this.method_spec.sig;t.async_op(function(n,r){e.resolve_method(t,a,function(){return n(void 0,void 0,!0,!1)},r)})}}else{var i=this.method_spec.class_desc;t.async_op(function(e,n){t.get_cl().initialize_class(t,i,function(){return e(void 0,void 0,!0,!1)},n)})}},e}(h);e.InvokeOpcode=v;var m=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.take_args=function(e,n){t.prototype.take_args.call(this,e,n),"invokeinterface"===this.name?(this.count=e.get_uint(1),e.skip(1),this.byte_count+=2):this.count=1+s(this.method_spec.sig),this.cache=Object.create(null)},e.prototype.annotate=function(t,e){var n=r.format_extra_info(e.get(this.method_spec_ref)),a="";return"invokeinterface"===this.name&&(a=",  "+this.count),"	#"+this.method_spec_ref+a+";"+n},e.prototype._execute=function(t){var e=t.get_class(this.method_spec.class_desc,!0);if(null!=e){var n=t.curr_frame(),r=n.stack,a=r[r.length-this.count],i=t.check_null(a).cls,o=i.method_lookup(t,this.method_spec.sig);if(null!=o){if(null!=o.setup_stack(t))return n.pc+=1+this.byte_count,!1}else{var s=this.method_spec.sig;t.async_op(function(e,n){i.resolve_method(t,s,function(){return e(void 0,void 0,!0,!1)},n)})}}else{var u=this.method_spec.class_desc;t.async_op(function(e,n){t.get_cl().initialize_class(t,u,function(){return e(void 0,void 0,!0,!1)},n)})}},e}(v);e.DynInvokeOpcode=m;var y=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.take_args=function(t,e){this.constant_ref=t.get_uint(this.byte_count),this.constant=e.get(this.constant_ref);var n=this.constant.type;("String"===n||"class"===n)&&(this.str_constant=e.get(this.constant.value))},e.prototype.annotate=function(){var t=this.constant.type,e="	#"+this.constant_ref+";	// "+this.constant.type+" ";return"String"===t||"class"===t?e+r.escape_whitespace(this.constant.deref()):e+this.constant.value},e.prototype._execute=function(t){switch(this.constant.type){case"String":t.push(t.init_string(this.str_constant.value,!0));break;case"class":var e=r.typestr2descriptor(this.str_constant.value);t.async_op(function(n,r){t.get_cl().resolve_class(t,e,function(e){return n(e.get_class_object(t),void 0,!0)},r)});break;default:"ldc2_w"===this.name?t.push2(this.constant.value,null):t.push(this.constant.value)}return!0},e}(h);e.LoadConstantOpcode=y;var j=function(t){function e(e,n){t.call(this,e,2,n)}return __extends(e,t),e.prototype.take_args=function(t){this.offset=t.get_int(this.byte_count)},e.prototype.annotate=function(t){return"	"+(t+this.offset)},e}(h);e.BranchOpcode=j;var b=function(t){function e(e,n){t.call(this,e),this.byte_count=n}return __extends(e,t),e.prototype._execute=function(t){return this.inc_pc(t,this.offset),!0},e}(j);e.GotoOpcode=b;var w=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._execute=function(t){return t.push(t.curr_pc()+this.byte_count+1),this.inc_pc(t,this.offset),!0},e}(b);e.JSROpcode=w;var L=function(t){function e(e,n){t.call(this,e),this.cmp=n}return __extends(e,t),e.prototype._execute=function(t){return this.cmp(t.pop())&&this.inc_pc(t,this.offset),!0},e}(j);e.UnaryBranchOpcode=L;var x=function(t){function e(e,n){t.call(this,e),this.cmp=n}return __extends(e,t),e.prototype._execute=function(t){var e=t.pop(),n=t.pop();return this.cmp(n,e)&&this.inc_pc(t,this.offset),!0},e}(j);e.BinaryBranchOpcode=x;var I=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.take_args=function(t){this.value=t.get_int(this.byte_count)},e.prototype.annotate=function(){return"	"+this.value},e.prototype._execute=function(t){return t.push(this.value),!0},e}(h);e.PushOpcode=I;var k=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.take_args=function(t,e,n){var r;n?(this.name+="_w",r=2,this.byte_count=5):(r=1,this.byte_count=2),this.index=t.get_uint(r),this["const"]=t.get_int(r)},e.prototype.annotate=function(){return"	"+this.index+", "+this["const"]},e.prototype._execute=function(t){var e=t.cl(this.index)+this["const"];return t.put_cl(this.index,0|e),!0},e}(h);e.IIncOpcode=k;var O=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.take_args=function(){this.var_num=parseInt(this.name[6])},e.prototype._execute=function(t){return t.push(t.cl(this.var_num)),!0},e}(h);e.LoadOpcode=O;var S=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._execute=function(t){return t.push2(t.cl(this.var_num),null),!0},e}(O);e.LoadOpcode2=S;var E=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.take_args=function(t,e,n){n?(this.name+="_w",this.byte_count=3,this.var_num=t.get_uint(2)):(this.byte_count=1,this.var_num=t.get_uint(1))},e.prototype.annotate=function(){return"	"+this.var_num},e}(O);e.LoadVarOpcode=E;var N=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._execute=function(t){return t.push2(t.cl(this.var_num),null),!0},e}(E);e.LoadVarOpcode2=N;var A=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.take_args=function(){this.var_num=parseInt(this.name[7])},e.prototype._execute=function(t){return t.put_cl(this.var_num,t.pop()),!0},e}(h);e.StoreOpcode=A;var C=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._execute=function(t){return t.put_cl2(this.var_num,t.pop2()),!0},e}(A);e.StoreOpcode2=C;var F=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.take_args=function(t,e,n){n?(this.name+="_w",this.byte_count=3,this.var_num=t.get_uint(2)):(this.byte_count=1,this.var_num=t.get_uint(1))},e.prototype.annotate=function(){return"	"+this.var_num},e}(A);e.StoreVarOpcode=F;var T=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._execute=function(t){return t.put_cl2(this.var_num,t.pop2()),!0},e}(E);e.StoreVarOpcode2=T;var D=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.annotate=function(t){var e="{\n";for(var n in this.offsets){var r=this.offsets[n];e+="		"+n+": "+(t+r)+";\n"}return e+"		default: "+(t+this._default)+" }"},e.prototype.take_args=function(t){var e=(4-t.pos()%4)%4;t.skip(e),this._default=t.get_int(4);var n=t.get_int(4);this.offsets={};for(var r=0;n>r;++r){var a=t.get_int(4);this.offsets[a]=t.get_int(4)}this.byte_count=e+8*(n+1)},e.prototype._execute=function(t){var e=this.offsets[t.pop()];return e?this.inc_pc(t,e):this.inc_pc(t,this._default),!0},e}(j);e.LookupSwitchOpcode=D;var M=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.take_args=function(t){var e=(4-t.pos()%4)%4;t.skip(e),this._default=t.get_int(4);var n=t.get_int(4),r=t.get_int(4);this.offsets={};for(var a=r-n+1,i=0;a>i;++i)this.offsets[n+i]=t.get_int(4);this.byte_count=e+12+4*a},e}(D);e.TableSwitchOpcode=M;var V={4:"Z",5:"C",6:"F",7:"D",8:"B",9:"S",10:"I",11:"J"},B=function(t){function e(e){t.call(this,e,1)}return __extends(e,t),e.prototype.take_args=function(t){this.element_type=V[t.get_uint(1)]},e.prototype.annotate=function(){return"	"+r.internal2external[this.element_type]},e.prototype._execute=function(t){return t.push(t.heap_newarray(this.element_type,t.pop())),!0},e}(h);e.NewArrayOpcode=B;var J=function(t){function e(e){t.call(this,e,3)}return __extends(e,t),e.prototype.take_args=function(t,e){this.class_ref=t.get_uint(2),this.class_descriptor=e.get(this.class_ref).deref(),this.dim=t.get_uint(1)},e.prototype.annotate=function(){return"	#"+this.class_ref+",  "+this.dim+";"},e.prototype._execute=function(t){var e=this,n=t.get_class(this.class_descriptor,!0);if(null==n)return t.async_op(function(n,r){t.get_cl().initialize_class(t,e.class_descriptor,function(){return n(void 0,void 0,!0,!1)},r)}),!0;var r=function(t){var n=t.curr_frame().stack.splice(-this.dim,this.dim);t.push(t.heap_multinewarray(e.class_descriptor,n))};return r.call(this,t),this.execute=r,!0},e}(h);e.MultiArrayOpcode=J;var R=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._execute=function(t){var e=t.pop(),n=t.check_null(t.pop()),r=n.array.length;if(0>e||e>=r){var a=t.get_bs_class("Ljava/lang/ArrayIndexOutOfBoundsException;");t.java_throw(a,e+" not in length "+r+" array of type "+n.cls.get_type())}return t.push(n.array[e]),("l"===this.name[0]||"d"===this.name[0])&&t.push(null),!0},e}(h);e.ArrayLoadOpcode=R;var z=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._execute=function(t){var e="l"===this.name[0]||"d"===this.name[0]?t.pop2():t.pop(),n=t.pop(),r=t.check_null(t.pop()),a=r.array.length;if(0>n||n>=a){var i=t.get_bs_class("Ljava/lang/ArrayIndexOutOfBoundsException;");t.java_throw(i,n+" not in length "+a+" array of type "+r.cls.get_type())}return r.array[n]=e,!0},e}(h);e.ArrayStoreOpcode=z;var P=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._execute=function(t){var e=t.meta_stack().pop();return t.push(e.stack[0]),t.should_return=!0,!0},e}(h);e.ReturnOpcode=P;var $=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._execute=function(t){var e=t.meta_stack().pop();return t.push2(e.stack[0],null),t.should_return=!0,!0},e}(h);e.ReturnOpcode2=$;var U=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype._execute=function(t){return t.meta_stack().pop(),t.should_return=!0,!0},e}(h);e.VoidReturnOpcode=U,e.monitorenter=u,e.monitorexit=c,e.opcodes=[new h("nop",0,function(){}),new h("aconst_null",0,function(t){return t.push(null)}),new h("iconst_m1",0,function(t){return t.push(-1)}),new h("iconst_0",0,function(t){return t.push(0)}),new h("iconst_1",0,function(t){return t.push(1)}),new h("iconst_2",0,function(t){return t.push(2)}),new h("iconst_3",0,function(t){return t.push(3)}),new h("iconst_4",0,function(t){return t.push(4)}),new h("iconst_5",0,function(t){return t.push(5)}),new h("lconst_0",0,function(t){return t.push2(n.ZERO,null)}),new h("lconst_1",0,function(t){return t.push2(n.ONE,null)}),new h("fconst_0",0,function(t){return t.push(0)}),new h("fconst_1",0,function(t){return t.push(1)}),new h("fconst_2",0,function(t){return t.push(2)}),new h("dconst_0",0,function(t){return t.push2(0,null)}),new h("dconst_1",0,function(t){return t.push2(1,null)}),new I("bipush",1),new I("sipush",2),new y("ldc",1),new y("ldc_w",2),new y("ldc2_w",2),new E("iload"),new N("lload"),new E("fload"),new N("dload"),new E("aload"),new O("iload_0"),new O("iload_1"),new O("iload_2"),new O("iload_3"),new S("lload_0"),new S("lload_1"),new S("lload_2"),new S("lload_3"),new O("fload_0"),new O("fload_1"),new O("fload_2"),new O("fload_3"),new S("dload_0"),new S("dload_1"),new S("dload_2"),new S("dload_3"),new O("aload_0"),new O("aload_1"),new O("aload_2"),new O("aload_3"),new R("iaload"),new R("laload"),new R("faload"),new R("daload"),new R("aaload"),new R("baload"),new R("caload"),new R("saload"),new F("istore"),new T("lstore"),new F("fstore"),new T("dstore"),new F("astore"),new A("istore_0"),new A("istore_1"),new A("istore_2"),new A("istore_3"),new C("lstore_0"),new C("lstore_1"),new C("lstore_2"),new C("lstore_3"),new A("fstore_0"),new A("fstore_1"),new A("fstore_2"),new A("fstore_3"),new C("dstore_0"),new C("dstore_1"),new C("dstore_2"),new C("dstore_3"),new A("astore_0"),new A("astore_1"),new A("astore_2"),new A("astore_3"),new z("iastore"),new z("lastore"),new z("fastore"),new z("dastore"),new z("aastore"),new z("bastore"),new z("castore"),new z("sastore"),new h("pop",0,function(t){return t.pop()}),new h("pop2",0,function(t){return t.pop2()}),new h("dup",0,function(t){var e=t.pop();t.push2(e,e)}),new h("dup_x1",0,function(t){var e=t.pop(),n=t.pop();t.push_array([e,n,e])}),new h("dup_x2",0,function(t){var e=t.pop(),n=t.pop(),r=t.pop();t.push_array([e,r,n,e])}),new h("dup2",0,function(t){var e=t.pop(),n=t.pop();t.push_array([n,e,n,e])}),new h("dup2_x1",0,function(t){var e=t.pop(),n=t.pop(),r=t.pop();t.push_array([n,e,r,n,e])}),new h("dup2_x2",0,function(t){var e=t.pop(),n=t.pop(),r=t.pop(),a=t.pop();t.push_array([n,e,a,r,n,e])}),new h("swap",0,function(t){var e=t.pop(),n=t.pop();t.push2(e,n)}),new h("iadd",0,function(t){return t.push(t.pop()+t.pop()|0)}),new h("ladd",0,function(t){return t.push2(t.pop2().add(t.pop2()),null)}),new h("fadd",0,function(t){return t.push(r.wrap_float(t.pop()+t.pop()))}),new h("dadd",0,function(t){return t.push2(t.pop2()+t.pop2(),null)}),new h("isub",0,function(t){return t.push(-t.pop()+t.pop()|0)}),new h("lsub",0,function(t){return t.push2(t.pop2().negate().add(t.pop2()),null)}),new h("fsub",0,function(t){return t.push(r.wrap_float(-t.pop()+t.pop()))}),new h("dsub",0,function(t){return t.push2(-t.pop2()+t.pop2(),null)}),new h("imul",0,function(t){return t.push(Math.imul(t.pop(),t.pop()))}),new h("lmul",0,function(t){return t.push2(t.pop2().multiply(t.pop2()),null)}),new h("fmul",0,function(t){return t.push(r.wrap_float(t.pop()*t.pop()))}),new h("dmul",0,function(t){return t.push2(t.pop2()*t.pop2(),null)}),new h("idiv",0,function(t){var e=t.pop();t.push(r.int_div(t,t.pop(),e))}),new h("ldiv",0,function(t){var e=t.pop2();t.push2(r.long_div(t,t.pop2(),e),null)}),new h("fdiv",0,function(t){var e=t.pop();t.push(r.wrap_float(t.pop()/e))}),new h("ddiv",0,function(t){var e=t.pop2();t.push2(t.pop2()/e,null)}),new h("irem",0,function(t){var e=t.pop();t.push(r.int_mod(t,t.pop(),e))}),new h("lrem",0,function(t){var e=t.pop2();t.push2(r.long_mod(t,t.pop2(),e),null)}),new h("frem",0,function(t){var e=t.pop();t.push(t.pop()%e)}),new h("drem",0,function(t){var e=t.pop2();t.push2(t.pop2()%e,null)}),new h("ineg",0,function(t){return t.push(0|-t.pop())}),new h("lneg",0,function(t){return t.push2(t.pop2().negate(),null)}),new h("fneg",0,function(t){return t.push(-t.pop())}),new h("dneg",0,function(t){return t.push2(-t.pop2(),null)}),new h("ishl",0,function(t){var e=t.pop();t.push(t.pop()<<e)}),new h("lshl",0,function(t){var e=t.pop();t.push2(t.pop2().shiftLeft(n.fromInt(e)),null)}),new h("ishr",0,function(t){var e=t.pop();t.push(t.pop()>>e)}),new h("lshr",0,function(t){var e=t.pop();t.push2(t.pop2().shiftRight(n.fromInt(e)),null)}),new h("iushr",0,function(t){var e=t.pop();t.push(t.pop()>>>e)}),new h("lushr",0,function(t){var e=t.pop();t.push2(t.pop2().shiftRightUnsigned(n.fromInt(e)),null)}),new h("iand",0,function(t){return t.push(t.pop()&t.pop())
}),new h("land",0,function(t){return t.push2(t.pop2().and(t.pop2()),null)}),new h("ior",0,function(t){return t.push(t.pop()|t.pop())}),new h("lor",0,function(t){return t.push2(t.pop2().or(t.pop2()),null)}),new h("ixor",0,function(t){return t.push(t.pop()^t.pop())}),new h("lxor",0,function(t){return t.push2(t.pop2().xor(t.pop2()),null)}),new k("iinc"),new h("i2l",0,function(t){return t.push2(n.fromInt(t.pop()),null)}),new h("i2f",0,function(){}),new h("i2d",0,function(t){return t.push(null)}),new h("l2i",0,function(t){return t.push(t.pop2().toInt())}),new h("l2f",0,function(t){return t.push(t.pop2().toNumber())}),new h("l2d",0,function(t){return t.push2(t.pop2().toNumber(),null)}),new h("f2i",0,function(t){return t.push(r.float2int(t.pop()))}),new h("f2l",0,function(t){return t.push2(n.fromNumber(t.pop()),null)}),new h("f2d",0,function(t){return t.push(null)}),new h("d2i",0,function(t){return t.push(r.float2int(t.pop2()))}),new h("d2l",0,function(t){var e=t.pop2();e===Number.POSITIVE_INFINITY?t.push2(n.MAX_VALUE,null):e===Number.NEGATIVE_INFINITY?t.push2(n.MIN_VALUE,null):t.push2(n.fromNumber(e),null)}),new h("d2f",0,function(t){return t.push(r.wrap_float(t.pop2()))}),new h("i2b",0,function(t){return t.push(t.pop()<<24>>24)}),new h("i2c",0,function(t){return t.push(65535&t.pop())}),new h("i2s",0,function(t){return t.push(t.pop()<<16>>16)}),new h("lcmp",0,function(t){var e=t.pop2();t.push(t.pop2().compare(e))}),new h("fcmpl",0,function(t){var e=t.pop(),n=r.cmp(t.pop(),e);null==n?t.push(-1):t.push(n)}),new h("fcmpg",0,function(t){var e=t.pop(),n=r.cmp(t.pop(),e);null==n?t.push(1):t.push(n)}),new h("dcmpl",0,function(t){var e=t.pop2(),n=r.cmp(t.pop2(),e);null==n?t.push(-1):t.push(n)}),new h("dcmpg",0,function(t){var e=t.pop2(),n=r.cmp(t.pop2(),e);null==n?t.push(1):t.push(n)}),new L("ifeq",function(t){return 0===t}),new L("ifne",function(t){return 0!==t}),new L("iflt",function(t){return 0>t}),new L("ifge",function(t){return t>=0}),new L("ifgt",function(t){return t>0}),new L("ifle",function(t){return 0>=t}),new x("if_icmpeq",function(t,e){return t===e}),new x("if_icmpne",function(t,e){return t!==e}),new x("if_icmplt",function(t,e){return e>t}),new x("if_icmpge",function(t,e){return t>=e}),new x("if_icmpgt",function(t,e){return t>e}),new x("if_icmple",function(t,e){return e>=t}),new x("if_acmpeq",function(t,e){return t===e}),new x("if_acmpne",function(t,e){return t!==e}),new b("goto",2),new w("jsr",2),new h("ret",1,function(t){this.goto_pc(t,t.cl(this.args[0]))}),new M("tableswitch"),new D("lookupswitch"),new P("ireturn"),new $("lreturn"),new P("freturn"),new $("dreturn"),new P("areturn"),new U("return"),new d("getstatic",function(t){var e,n=this,r=this.field_spec.class_desc,a=t.get_class(r,!0);if(e="J"==this.field_spec.type||"D"==this.field_spec.type?function(t){return t.push2(n.cls.static_get(t,n.field_spec.name),null)}:function(t){return t.push(n.cls.static_get(t,n.field_spec.name))},null!=a){var i=a.field_lookup(t,this.field_spec.name).cls.get_type();this.cls=t.get_class(i,!0),null!=this.cls?(e.call(this,t),this.execute=e):t.async_op(function(e,n){t.get_cl().initialize_class(t,i,function(){e(void 0,void 0,!0,!1)},n)})}else t.async_op(function(e,n){t.get_cl().initialize_class(t,r,function(){e(void 0,void 0,!0,!1)},n)})}),new d("putstatic",function(t){var e,n=this,r=this.field_spec.class_desc,a=t.get_class(r,!0);if(e="J"==this.field_spec.type||"D"==this.field_spec.type?function(t){return n.cls.static_put(t,n.field_spec.name,t.pop2())}:function(t){return n.cls.static_put(t,n.field_spec.name,t.pop())},null!=a){var i=a.field_lookup(t,this.field_spec.name).cls.get_type();return this.cls=t.get_class(i,!0),null!=this.cls?(e.call(this,t),this.execute=e):t.async_op(function(e,n){t.get_cl().initialize_class(t,i,function(){e(void 0,void 0,!0,!1)},n)}),void 0}t.async_op(function(e,n){t.get_cl().initialize_class(t,r,function(){e(void 0,void 0,!0,!1)},n)})}),new d("getfield",function(t){var e=this.field_spec.class_desc,n=(t.check_null(t.peek()),t.get_class(e,!0));if(null!=n){var r,a=n.field_lookup(t,this.field_spec.name),i=a.cls.get_type()+this.field_spec.name;return r="J"==this.field_spec.type||"D"==this.field_spec.type?function(t){return t.push2(t.check_null(t.pop()).get_field(t,i),null)}:function(t){return t.push(t.check_null(t.pop()).get_field(t,i))},r.call(this,t),this.execute=r,void 0}t.async_op(function(n,r){t.get_cl().resolve_class(t,e,function(){n(void 0,void 0,!0,!1)},r)})}),new d("putfield",function(t){var e=this.field_spec.class_desc,n="J"==this.field_spec.type||"D"==this.field_spec.type;t.check_null(t.peek(n?2:1));var r=t.get_class(e,!0);if(null!=r){var a,i=r.field_lookup(t,this.field_spec.name),o=i.cls.get_type()+this.field_spec.name;a=n?function(t){var e=t.pop2();t.check_null(t.pop()).set_field(t,o,e)}:function(t){var e=t.pop();t.check_null(t.pop()).set_field(t,o,e)},a.call(this,t),this.execute=a}else t.async_op(function(n,r){t.get_cl().resolve_class(t,e,function(){n(void 0,void 0,!0,!1)},r)})}),new m("invokevirtual"),new v("invokespecial"),new v("invokestatic"),new m("invokeinterface"),null,new g("new",function(t){var e=this,n=this.class_desc;this.cls=t.get_class(n,!0),null!=this.cls?this.cls.is_castable(t.get_bs_cl().get_resolved_class("Ljava/lang/ClassLoader;",!0))?(t.push(new p(t,this.cls)),this.execute=function(t){return t.push(new p(t,e.cls))}):this.cls.is_castable(t.get_bs_cl().get_resolved_class("Ljava/lang/Thread;",!0))?(t.push(new o.JavaThreadObject(t,this.cls)),this.execute=function(t){return t.push(new o.JavaThreadObject(t,e.cls))}):(t.push(new _(t,this.cls)),this.execute=function(t){return t.push(new _(t,e.cls))}):t.async_op(function(e,r){var a=function(n){var r;r=n.is_castable(t.get_bs_cl().get_resolved_class("Ljava/lang/ClassLoader;",!0))?new p(t,n):n.is_castable(t.get_bs_cl().get_resolved_class("Ljava/lang/Thread;",!0))?new o.JavaThreadObject(t,n):new _(t,n),e(r,void 0,!0)};t.get_cl().initialize_class(t,n,a,r)})}),new B("newarray"),new g("anewarray",function(t){var e=this.class_desc,n=t.get_cl().get_resolved_class(e,!0);if(null!=n){var r=function(t){return t.push(t.heap_newarray(e,t.pop()))};r.call(this,t),this.execute=r}else t.async_op(function(n,r){t.get_cl().resolve_class(t,e,function(){n(void 0,void 0,!0,!1)},r)})}),new h("arraylength",0,function(t){return t.push(t.check_null(t.pop()).array.length)}),new h("athrow",0,function(t){throw new l(t.pop())}),new g("checkcast",function(t){var e=this.class_desc;if(this.cls=t.get_cl().get_resolved_class(e,!0),null!=this.cls){var n=function(t){var e=t.peek();if(null!=e&&!e.cls.is_castable(this.cls)){var n=this.cls.toExternalString(),r=e.cls.toExternalString(),a=t.get_bs_class("Ljava/lang/ClassCastException;");t.java_throw(a,r+" cannot be cast to "+n)}};return n.call(this,t),this.execute=n,void 0}t.async_op(function(n,r){t.get_cl().resolve_class(t,e,function(){return n(void 0,void 0,!0,!1)},r)})}),new g("instanceof",function(t){var e=this.class_desc;if(this.cls=t.get_cl().get_resolved_class(e,!0),null!=this.cls){var n=function(t){var e=t.pop();t.push(null!=e?e.cls.is_castable(this.cls)+0:0)};return n.call(this,t),this.execute=n,void 0}t.async_op(function(n,r){t.get_cl().resolve_class(t,e,function(){return n(void 0,void 0,!0,!1)},r)})}),new h("monitorenter",0,function(t){if(!e.monitorenter(t,t.peek(),this))throw f;t.pop()}),new h("monitorexit",0,function(t){return e.monitorexit(t,t.pop())}),null,new J("multianewarray"),new L("ifnull",function(t){return null==t}),new L("ifnonnull",function(t){return null!=t}),new b("goto_w",4),new w("jsr_w",4)]}),define("src/attributes",["require","exports","./util","./opcodes"],function(t,e,n,r){function a(t,e){for(var n={Code:o,LineNumberTable:s,SourceFile:u,StackMapTable:c,LocalVariableTable:l,ConstantValue:p,Exceptions:f,InnerClasses:_,Synthetic:h,Deprecated:d,Signature:g,RuntimeVisibleAnnotations:v,AnnotationDefault:m,EnclosingMethod:y},r=t.get_uint(2),a=[],i=0;r>i;i++){var j=e.get(t.get_uint(2)).value,b=t.get_uint(4);if(null!=n[j]){var w=new n[j],L=t.size();w.parse(t,e,b);var x=t.size();L-x!==b&&t.skip(b-L+x),a.push(w)}else t.skip(b)}return a}var i=function(){function t(){this.name="ExceptionHandler"}return t.prototype.parse=function(t,e){this.start_pc=t.get_uint(2),this.end_pc=t.get_uint(2),this.handler_pc=t.get_uint(2);var n=t.get_uint(2);this.catch_type=0===n?"<any>":e.get(n).deref()},t}();e.ExceptionHandler=i;var o=function(){function t(){this.name="Code"}return t.prototype.parse=function(t,n){this.constant_pool=n,this.max_stack=t.get_uint(2),this.max_locals=t.get_uint(2),this.code_len=t.get_uint(4),0===this.code_len,this._code_array=t.splice(this.code_len),this.opcodes=null;var r=t.get_uint(2);this.exception_handlers=[];for(var a=0;r>a;a++){var o=new i;this.exception_handlers.push(o),o.parse(t,n)}this.attrs=e.make_attributes(t,n),this.run_stamp=0},t.prototype.parse_code=function(){for(this.opcodes=new Array(this.code_len);this._code_array.has_bytes();){var t=this._code_array.pos(),e=this._code_array.get_uint(1),n=196===e;n&&(e=this._code_array.get_uint(1)),null==r.opcodes[e];var a=Object.create(r.opcodes[e]);a.take_args(this._code_array,this.constant_pool,n),this.opcodes[t]=a}this._code_array.rewind()},t.prototype.each_opcode=function(t){for(var e=0;e<this.code_len;e++)null!=this.opcodes[e]&&t(e,this.opcodes[e])},t.prototype.get_attribute=function(t){for(var e=0;e<this.attrs.length;e++){var n=this.attrs[e];if(n.name===t)return n}return null},t}();e.Code=o;var s=function(){function t(){this.name="LineNumberTable"}return t.prototype.parse=function(t){this.entries=[];for(var e=t.get_uint(2),n=0;e>n;n++){var r=t.get_uint(2),a=t.get_uint(2);this.entries.push({start_pc:r,line_number:a})}},t.prototype.disassemblyOutput=function(){for(var t="  LineNumberTable:\n",e=0;e<this.entries.length;e++){var n=this.entries[e];t+="   line "+n.line_number+": "+n.start_pc+"\n"}return t},t}();e.LineNumberTable=s;var u=function(){function t(){this.name="SourceFile"}return t.prototype.parse=function(t,e){this.filename=e.get(t.get_uint(2)).value},t}();e.SourceFile=u;var c=function(){function t(){this.name="StackMapTable"}return t.prototype.parse=function(t,e){this.num_entries=t.get_uint(2),this.entries=[];for(var n=0;n<this.num_entries;n++)this.entries.push(this.parse_entries(t,e))},t.prototype.parse_entries=function(t,e){var n=t.get_uint(1);if(n>=0&&64>n)return{frame_type:n,frame_name:"same"};if(n>=64&&128>n)return{frame_type:n,frame_name:"same_locals_1_stack_item",stack:[this.parse_verification_type_info(t,e)]};if(n>=128&&247>n);else{if(247===n)return{frame_type:n,frame_name:"same_locals_1_stack_item_frame_extended",offset_delta:t.get_uint(2),stack:[this.parse_verification_type_info(t,e)]};if(n>=248&&251>n)return{frame_type:n,frame_name:"chop",offset_delta:[t.get_uint(2)]};if(251===n)return{frame_type:n,frame_name:"same_frame_extended",offset_delta:[t.get_uint(2)]};if(n>=252&&255>n){for(var r=t.get_uint(2),a=[],i=0;n-251>i;i++)a.push(this.parse_verification_type_info(t,e));return{frame_type:n,frame_name:"append",offset_delta:r,locals:a}}if(255===n){var r=t.get_uint(2),o=t.get_uint(2);a=[];for(var i=0;o>i;i++)a.push(this.parse_verification_type_info(t,e));for(var s=t.get_uint(2),u=[],i=0;s>i;i++)u.push(this.parse_verification_type_info(t,e));return{frame_type:n,frame_name:"full_frame",offset_delta:r,num_locals:o,locals:a,num_stack_items:s,stack:u}}}},t.prototype.parse_verification_type_info=function(t,e){var r=t.get_uint(1);if(7===r){var a=e.get(t.get_uint(2)).deref();return"class "+(/\w/.test(a[0])?n.descriptor2typestr(a):'"'+a+'"')}if(8===r)return"uninitialized "+t.get_uint(2);var i=["bogus","int","float","double","long","null","this","object","uninitialized"];return i[r]},t.prototype.disassemblyOutput=function(){for(var t="  StackMapTable: number_of_entries = "+this.num_entries+"\n",e=0;e<this.entries.length;e++){var n=this.entries[e];t+="   frame_type = "+n.frame_type+" /* "+n.frame_name+" */\n",null!=n.offset_delta&&(t+="     offset_delta = "+n.offset_delta+"\n"),null!=n.locals&&(t+="     locals = [ "+n.locals.join(", ")+" ]\n"),null!=n.stack&&(t+="     stack = [ "+n.stack.join(", ")+" ]\n")}return t},t}();e.StackMapTable=c;var l=function(){function t(){this.name="LocalVariableTable"}return t.prototype.parse=function(t,e){this.num_entries=t.get_uint(2),this.entries=[];for(var n=0;n<this.num_entries;n++)this.entries.push(this.parse_entries(t,e))},t.prototype.parse_entries=function(t,e){return{start_pc:t.get_uint(2),length:t.get_uint(2),name:e.get(t.get_uint(2)).value,descriptor:e.get(t.get_uint(2)).value,ref:t.get_uint(2)}},t.prototype.disassemblyOutput=function(){for(var t="  LocalVariableTable:\n   Start  Length  Slot  Name   Signature\n",e=0;e<this.num_entries;e++){var n=this.entries[e];t+="   "+n.start_pc+"      "+n.length+"      "+n.ref,t+=""+n.name+"      "+n.descriptor+"\n"}return t},t}();e.LocalVariableTable=l;var f=function(){function t(){this.name="Exceptions"}return t.prototype.parse=function(t,e){this.num_exceptions=t.get_uint(2);for(var n=[],r=0;r<this.num_exceptions;r++)n.push(t.get_uint(2));this.exceptions=n.map(function(t){return e.get(t).deref()})},t}();e.Exceptions=f;var _=function(){function t(){this.name="InnerClasses"}return t.prototype.parse=function(t,e){var n=t.get_uint(2);this.classes=[];for(var r=0;n>r;r++)this.classes.push(this.parse_class(t,e))},t.prototype.parse_class=function(t){return{inner_info_index:t.get_uint(2),outer_info_index:t.get_uint(2),inner_name_index:t.get_uint(2),inner_access_flags:t.get_uint(2)}},t}();e.InnerClasses=_;var p=function(){function t(){this.name="ConstantValue"}return t.prototype.parse=function(t,e){this.ref=t.get_uint(2);var n=e.get(this.ref);this.value="function"==typeof n.deref?n.deref():n.value},t}();e.ConstantValue=p;var h=function(){function t(){this.name="Synthetic"}return t.prototype.parse=function(){},t}();e.Synthetic=h;var d=function(){function t(){this.name="Deprecated"}return t.prototype.parse=function(){},t}();e.Deprecated=d;var g=function(){function t(){this.name="Signature"}return t.prototype.parse=function(t,e,r){this.raw_bytes=t.read(r);var a=n.read_uint(this.raw_bytes);this.sig=e.get(a).value},t}();e.Signature=g;var v=function(){function t(){this.name="RuntimeVisibleAnnotations"}return t.prototype.parse=function(t,e,n){this.raw_bytes=t.read(n)},t}();e.RuntimeVisibleAnnotations=v;var m=function(){function t(){this.name="AnnotationDefault"}return t.prototype.parse=function(t,e,n){this.raw_bytes=t.read(n)},t}();e.AnnotationDefault=m;var y=function(){function t(){this.name="EnclosingMethod"}return t.prototype.parse=function(t,e){this.enc_class=e.get(t.get_uint(2)).deref();var n=t.get_uint(2);n>0&&(this.enc_method=e.get(n).deref())},t}();e.EnclosingMethod=y,e.make_attributes=a}),define("path",[],function(){return BrowserFS.BFSRequire("path")}),define("src/natives",["require","exports","path","fs","./gLong","./util","./java_object","./exceptions","./logging","./threading"],function(require,exports,path,fs,gLong,util,java_object,exceptions,logging,threading){function instantiate(t,e,n){ReferenceClassData=t,PrimitiveClassData=e,ArrayClassData=n}function get_property(t,e,n){void 0===n&&(n=null);var r=e.jvm2js_str(),a=t.jvm_state.system_properties[r];return"java.class.path"===r?t.init_string(a.slice(1,a.length).join(":")):null!=a?t.init_string(a,!0):n}function o(t,e){return{fn_name:t,fn:e}}function doPrivileged(t,e){var n=t.curr_frame(),r=e.cls.method_lookup(t,"run()Ljava/lang/Object;");if(null!=r)throw r.access_flags["static"]||t.push(e),r.setup_stack(t),n.runner=function(){var e=t.pop();t.meta_stack().pop(),t.push(e)},exceptions.ReturnException;t.async_op(function(n,r){e.cls.resolve_method(t,"run()Ljava/lang/Object;",function(){t.meta_stack().push({}),n()},r)})}function stat_file(t,e){fs.stat(t,function(t,n){null!=t?e(null):e(n)})}function arraycopy_no_check(t,e,n,r,a){for(var i=r,o=e+a,s=e;o>s;s++)n.array[i++]=t.array[s]}function arraycopy_check(t,e,n,r,a,i){for(var o=a,s=n+i,u=r.cls.get_component_class(),c=n;s>c;c++){if(null===e.array[c]||e.array[c].cls.is_castable(u))r.array[o]=e.array[c];else{var l=t.get_bs_class("Ljava/lang/ArrayStoreException;");t.java_throw(l,"Array element in src cannot be cast to dest array type.")}o++}}function unsafe_memcpy(t,e,n,r,a,i){var o=i.toNumber();if(null!=e){var s=n.toNumber();if(null!=r)return arraycopy_no_check(e,s,r,a.toNumber(),o);var u=t.block_addr(a);if("undefined"!=typeof DataView&&null!==DataView)for(var c=0;o>c;c++)t.mem_blocks[u].setInt8(c,e.array[s+c]);else for(var c=0;o>c;c++)t.mem_blocks[u+c]=e.array[s+c]}else{var l=t.block_addr(n);if(null!=r){var f=a.toNumber();if("undefined"!=typeof DataView&&null!==DataView)for(var c=0;o>c;c++)r.array[f+c]=t.mem_blocks[l].getInt8(c);else for(var c=0;o>c;c++)r.array[f+c]=t.mem_blocks[l+c]}else{var u=t.block_addr(a);if("undefined"!=typeof DataView&&null!==DataView)for(var c=0;o>c;c++)t.mem_blocks[u].setInt8(c,t.mem_blocks[l].getInt8(c));else for(var c=0;o>c;c++)t.mem_blocks[u+c]=t.mem_blocks[l+c]}}}function unsafe_compare_and_swap(t,e,n,r,a,i){var o=n.get_field_from_offset(t,r);return o===a?(n.set_field_from_offset(t,r,i),!0):!1}function native_define_class(t,e,n,r,a,i,o,s){for(var u=new Buffer(a),c=n.array,l=r;r+a>l;l++)u.writeUInt8((256+c[l])%256,l);i.define_class(t,util.int_classname(e.jvm2js_str()),u,function(e){o(e.get_class_object(t))},s)}function write_to_file(t,e,n,r,a){var i,o,s;if(s=e.get_field(t,"Ljava/io/FileOutputStream;fd"),o=s.get_field(t,"Ljava/io/FileDescriptor;fd"),-1===o&&t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"Bad file descriptor"),1!==o&&2!==o)return i=new Buffer(n.array),t.async_op(function(t){return fs.write(o,i,r,a,e.$pos,function(n,r){return e.$pos+=r,t()})}),void 0;var u=util.chars2js_str(n,r,a);return 1===o?process.stdout.write(u):2===o&&process.stderr.write(u),util.are_in_browser()?t.async_op(function(t){return t()}):void 0}function get_cl_from_jclo(t,e){return null!=e&&null!=e.$loader?e.$loader:t.get_bs_cl()}function create_stack_trace(t,e){for(var n,r,a=[],i=t.meta_stack()._cs.slice(1,-1),o=0;o<i.length;o++){var s=i[o];if(!s["native"]&&s.locals[0]!==e){var u=s.method.cls,c=-1;if("Ljava/lang/NoClassDefFoundError;"!==e.cls.get_type())if(s.method.access_flags["native"])n="Native Method";else{var l=u.get_attribute("SourceFile");n=null!=l?l.filename:"unknown";var f,_=s.method.code;if(null!=_&&(f=_.get_attribute("LineNumberTable")),null==f)break;for(var p in f.entries){var h=f.entries[p];h.start_pc<=s.pc&&(c=h.line_number)}}else n="unknown";a.push(new JavaObject(t,t.get_bs_class("Ljava/lang/StackTraceElement;"),{"Ljava/lang/StackTraceElement;declaringClass":t.init_string(util.ext_classname(u.get_type())),"Ljava/lang/StackTraceElement;methodName":t.init_string(null!=(r=s.method.name)?r:"unknown"),"Ljava/lang/StackTraceElement;fileName":t.init_string(n),"Ljava/lang/StackTraceElement;lineNumber":c}))}}return a.reverse()}function get_caller_class(t,e){var n,r;return n=t.meta_stack().get_caller(e),0===n.name.indexOf("Ljava/lang/reflect/Method;::invoke")&&(n=t.meta_stack().get_caller(e+1)),r=n.method.cls,r.get_class_object(t)}function get_declaring_class(t,e){var n,r,a,i,o,s,u,c,l;if(!(e.$cls instanceof ReferenceClassData))return null;if(n=e.$cls,i=n.get_attribute("InnerClasses"),null==i)return null;for(o=e.$cls.get_type(),l=i.classes,u=0,c=l.length;c>u;u++)if(a=l[u],a.outer_info_index>0&&(s=n.constant_pool.get(a.inner_info_index).deref(),s===o))return r=n.constant_pool.get(a.outer_info_index).deref(),n.loader.get_resolved_class(r).get_class_object(t);return null}function verify_array(t,e){if(!(e instanceof java_object.JavaArray)){var n=this.get_bs_class("Ljava/lang/IllegalArgumentException;");this.java_throw(n,"Object is not an array.")}return e}function array_get(t,e,n){var r,a;return r=t.check_null(e).array,n>=0&&n<r.length||(a=t.get_bs_class("Ljava/lang/ArrayIndexOutOfBoundsException;"),t.java_throw(a,"Tried to access an illegal index in an array.")),r[n]}function next_address(){return next_host_address++,next_host_address>4194304e3&&(error("Out of addresses"),next_host_address=4026531840),next_host_address}function pack_address(t){var e,n,r;for(n=0,e=r=3;r>=0;e=r+=-1)n|=255&t[e],n<<=8;return n}function host_allocate_address(t){var e;return e=next_address(),host_lookup[e]=t,host_reverse_lookup[t]=e,e}function websocket_status_to_message(t){switch(t){case 1e3:return"Normal closure";case 1001:return"Endpoint is going away";case 1002:return"WebSocket protocol error";case 1003:return"Server received invalid data"}return"Unknown status code or error"}function socket_read_async(t,e,n,r,a){var i,o,s,u,c;for(i=t.$ws.rQlen(),u=r>i?i:r,s=t.$ws.rQshiftBytes(u),o=c=0;u>c;o=c+=1)e.array[n++]=s[o];return a(u)}function setup_caller_stack(t,e,n,r){var a,i,o,s,u,c,l;for(e.access_flags["static"]||t.push(n),a=0,l=e.param_types,u=0,c=l.length;c>u;u++)o=l[u],i=r.array[a++],"J"===o||"D"===o?null!=(null!=i?i.ref:void 0)?(s=i.get_field(t,i.cls.get_type()+"value"),t.push2(s,null)):(t.push2(i,null),a++):util.is_primitive_type(o)?null!=(null!=i?i.ref:void 0)?(s=i.get_field(t,i.cls.get_type()+"value"),t.push(s)):t.push(i):t.push(i);return t.curr_frame()}function flatten_pkg(t){var e,n,r;return r={},e=[],n=function(t){var a,i,o,s,u,c,l,f,_,p;for(f in t){if(c=t[f],e.push(f),c instanceof Array)for(u=e.join("/"),_=0,p=c.length;p>_;_++)l=c[_],o=l.fn_name,i=l.fn,o=o.replace(/!|;/g,function(){var t;return t=0,function(n){return"!"===n?e[t++]:";"===n?(t=0,n):n}}()),s="L"+u+";::"+o,r[s]=i;else a=n(c);e.pop(f)}},n(t),r}var JavaObject=java_object.JavaObject,JavaArray=java_object.JavaArray,debug=logging.debug,error=logging.error,trace=logging.trace,ReferenceClassData,PrimitiveClassData,ArrayClassData;exports.instantiated,exports.instantiated=!1,exports.instantiate=instantiate,exports.trapped_methods={java:{lang:{ref:{Reference:[o("<clinit>()V",function(){})]},String:[o("hashCode()I",function(t,e){var n,r,a,i,o,s;if(a=e.get_field(t,"Ljava/lang/String;hash"),0===a){for(o=e.get_field(t,"Ljava/lang/String;offset"),n=e.get_field(t,"Ljava/lang/String;value").array,r=e.get_field(t,"Ljava/lang/String;count"),i=s=0;r>s;i=s+=1)a=31*a+n[o++]|0;e.set_field(t,"Ljava/lang/String;hash",a)}return a})],System:[o("loadLibrary(L!/!/String;)V",function(t,e){var n=e.jvm2js_str();return"zip"!==n&&"net"!==n&&"nio"!==n&&"awt"!==n&&"fontmanager"!==n?t.java_throw(t.get_bs_class("Ljava/lang/UnsatisfiedLinkError;"),"no "+n+" in java.library.path"):void 0}),o("adjustPropertiesForBackwardCompatibility(L!/util/Properties;)V",function(){}),o("getProperty(L!/!/String;)L!/!/String;",get_property),o("getProperty(L!/!/String;L!/!/String;)L!/!/String;",get_property)],Terminator:[o("setup()V",function(){})]},util:{concurrent:{atomic:{AtomicInteger:[o("<clinit>()V",function(){}),o("compareAndSet(II)Z",function(t,e,n,r){return e.set_field(t,"Ljava/util/concurrent/atomic/AtomicInteger;value",r),!0})]}}},nio:{Bits:[o("byteOrder()L!/!/ByteOrder;",function(t){var e=t.get_bs_class("Ljava/nio/ByteOrder;");return e.static_get(t,"LITTLE_ENDIAN")}),o("copyToByteArray(JLjava/lang/Object;JJ)V",function(t,e,n,r,a){unsafe_memcpy(t,null,e,n,r,a)})],charset:{Charset$3:[o("run()L!/lang/Object;",function(){return null})]}}}},exports.native_methods={classes:{awt:{CanvasGraphicsEnvironment:[]},doppio:{JavaScript:[o("eval(Ljava/lang/String;)Ljava/lang/String;",function(rs,to_eval){var rv=eval(to_eval.jvm2js_str());return null!=rv?rs.init_string(""+rv):null})],Debug:[o("SetLogLevel(L!/!/!$LogLevel;)V",function(t,e){logging.log_level=e.get_field(t,"Lclasses/doppio/Debug$LogLevel;level")}),o("GetLogLevel()L!/!/!$LogLevel;",function(t){var e=t.get_bs_class("Lclasses/doppio/Debug$LogLevel;");switch(logging.log_level){case 10:return e.static_get(t,"VTRACE");case 9:return e.static_get(t,"TRACE");case 5:return e.static_get(t,"DEBUG");default:return e.static_get(t,"ERROR")}})]}},java:{lang:{ClassLoader:[o("findLoadedClass0(L!/!/String;)L!/!/Class;",function(t,e,n){var r,a,i;return a=get_cl_from_jclo(t,e),i=util.int_classname(n.jvm2js_str()),r=a.get_resolved_class(i,!0),null!=r?r.get_class_object(t):null}),o("findBootstrapClass(L!/!/String;)L!/!/Class;",function(t,e,n){var r=util.int_classname(n.jvm2js_str());t.async_op(function(e,n){t.get_bs_cl().resolve_class(t,r,function(n){e(n.get_class_object(t))},n,!0)})}),o("getCaller(I)L!/!/Class;",function(t,e){var n=t.meta_stack().get_caller(e).method.cls;return n.get_class_object(t)}),o("defineClass1(L!/!/String;[BIIL!/security/ProtectionDomain;L!/!/String;Z)L!/!/Class;",function(t,e,n,r,a,i){var o=get_cl_from_jclo(t,e);t.async_op(function(e,s){native_define_class(t,n,r,a,i,o,e,s)})}),o("defineClass1(L!/!/String;[BIIL!/security/ProtectionDomain;L!/!/String;)L!/!/Class;",function(t,e,n,r,a,i){var o=get_cl_from_jclo(t,e);t.async_op(function(e,s){native_define_class(t,n,r,a,i,o,e,s)})}),o("resolveClass0(L!/!/Class;)V",function(t,e,n){var r,a;r=get_cl_from_jclo(t,e),a=n.$cls.get_type(),null==r.get_resolved_class(a,!0)&&t.async_op(function(e,n){r.resolve_class(t,a,function(){e()},n,!0)})})],Compiler:[o("disable()V",function(){}),o("enable()V",function(){})],Float:[o("floatToRawIntBits(F)I",function(t,e){var n,r,a,i,o;return"undefined"!=typeof Float32Array&&null!==Float32Array?(r=new Float32Array([e]),a=new Int32Array(r.buffer),a[0]):0===e?0:e===Number.POSITIVE_INFINITY?util.FLOAT_POS_INFINITY_AS_INT:e===Number.NEGATIVE_INFINITY?util.FLOAT_NEG_INFINITY_AS_INT:isNaN(e)?util.FLOAT_NaN_AS_INT:(o=0>e?1:0,e=Math.abs(e),1.1754942106924411e-38>=e&&e>=1.401298464324817e-45?(n=0,i=Math.round(e/Math.pow(2,-126)*Math.pow(2,23)),o<<31|n<<23|i):(n=Math.floor(Math.log(e)/Math.LN2),i=Math.round((e/Math.pow(2,n)-1)*Math.pow(2,23)),o<<31|n+127<<23|i))}),o("intBitsToFloat(I)F",function(t,e){return util.intbits2float(e)})],Double:[o("doubleToRawLongBits(D)J",function(t,e){var n,r,a,i,o,s;return"undefined"!=typeof Float64Array&&null!==Float64Array?(n=new Float64Array([e]),i=new Uint32Array(n.buffer),gLong.fromBits(i[0],i[1])):0===e?gLong.ZERO:e===Number.POSITIVE_INFINITY?gLong.fromBits(0,2146435072):e===Number.NEGATIVE_INFINITY?gLong.fromBits(0,-1048576):isNaN(e)?gLong.fromBits(0,2146959360):(s=0>e?1<<31:0,e=Math.abs(e),2.225073858507201e-308>=e&&e>=5e-324?(r=0,o=gLong.fromNumber(e/Math.pow(2,-1022)*Math.pow(2,52))):(r=Math.floor(Math.log(e)/Math.LN2),e<Math.pow(2,r)&&(r-=1),o=gLong.fromNumber((e/Math.pow(2,r)-1)*Math.pow(2,52)),r=r+1023<<20),a=o.getHighBits()|s|r,gLong.fromBits(o.getLowBits(),a))}),o("longBitsToDouble(J)D",function(t,e){return util.longbits2double(e.getHighBits(),e.getLowBitsUnsigned())})],Object:[o("getClass()L!/!/Class;",function(t,e){return e.cls.get_class_object(t)}),o("hashCode()I",function(t,e){return e.ref}),o("clone()L!/!/!;",function(t,e){return e.clone(t)}),o("notify()V",function(t,e){var n;if(null!=(n=t.lock_refs[e.ref])&&n!==t.curr_thread){var r=n.name(t);t.java_throw(t.get_bs_class("Ljava/lang/IllegalMonitorStateException;"),"Thread '"+r+"' owns this monitor")}null!=t.waiting_threads[e.ref]&&t.waiting_threads[e.ref].shift()}),o("notifyAll()V",function(t,e){var n;if(null!=(n=t.lock_refs[e.ref])&&n!==t.curr_thread){var r=n.name(t);t.java_throw(t.get_bs_class("Ljava/lang/IllegalMonitorStateException;"),"Thread '"+r+"' owns this monitor")}null!=t.waiting_threads[e.ref]&&(t.waiting_threads[e.ref]=[])}),o("wait(J)V",function(t,e,n){var r;if(n!==gLong.ZERO&&error("TODO(Object::wait): respect the timeout param ("+n+")"),null!=(r=t.lock_refs[e.ref])&&r!==t.curr_thread){var a=r.name(t);t.java_throw(t.get_bs_class("Ljava/lang/IllegalMonitorStateException;"),"Thread '"+a+"' owns this monitor")}t.lock_refs[e.ref]=null,t.wait(e)})],Package:[o("getSystemPackage0(Ljava/lang/String;)Ljava/lang/String;",function(t,e){var n=e.jvm2js_str();return t.get_bs_cl().get_package_names().indexOf(n)>=0?e:null}),o("getSystemPackages0()[Ljava/lang/String;",function(t){var e;return new JavaArray(t,t.get_bs_class("[Ljava/lang/String;"),function(){var n,r,a,i;for(a=t.get_bs_cl().get_package_names(),i=[],n=0,r=a.length;r>n;n++)e=a[n],i.push(t.init_string(e));return i}())})],ProcessEnvironment:[o("environ()[[B",function(t){var e,n,r,a;e=[],a=process.env;for(n in a)r=a[n],e.push(new JavaArray(t,t.get_bs_class("[B"),util.bytestr_to_array(n))),e.push(new JavaArray(t,t.get_bs_class("[B"),util.bytestr_to_array(r)));return new JavaArray(t,t.get_bs_class("[[B"),e)})],reflect:{Array:[o("multiNewArray(L!/!/Class;[I)L!/!/Object;",function(t,e,n){var r=n.array,a=t.get_class(e.$cls.get_type(),!0);if(null==a)return t.async_op(function(n,a){t.get_cl().initialize_class(t,e.$cls.get_type(),function(e){var a=new Array(r.length+1).join("[")+e.get_type();t.heap_multinewarray(a,r),n()},a)}),void 0;var i=new Array(r.length+1).join("[")+a.get_type();return t.heap_multinewarray(i,r)}),o("newArray(L!/!/Class;I)L!/!/Object;",function(t,e,n){return t.heap_newarray(e.$cls.get_type(),n)}),o("getLength(Ljava/lang/Object;)I",function(t,e){var n=verify_array(t,e);return t.check_null(n).array.length}),o("getBoolean(Ljava/lang/Object;I)Z",array_get),o("getByte(Ljava/lang/Object;I)B",array_get),o("getChar(Ljava/lang/Object;I)C",array_get),o("getDouble(Ljava/lang/Object;I)D",array_get),o("getFloat(Ljava/lang/Object;I)F",array_get),o("getInt(Ljava/lang/Object;I)I",array_get),o("getLong(Ljava/lang/Object;I)J",array_get),o("getShort(Ljava/lang/Object;I)S",array_get),o("get(Ljava/lang/Object;I)Ljava/lang/Object;",function(t,e,n){var r;return r=array_get(t,e,n),null==r.ref?e.cls.get_component_class().create_wrapper_object(t,r):r}),o("set(Ljava/lang/Object;ILjava/lang/Object;)V",function(t,e,n,r){var a,i,o,s,u,c,l,f=verify_array(t,e);if(l=t.curr_frame(),a=t.check_null(f).array,n>=0&&n<a.length||t.java_throw(t.get_bs_class("Ljava/lang/ArrayIndexOutOfBoundsException;"),"Tried to write to an illegal index in an array."),(i=f.cls.get_component_class())instanceof PrimitiveClassData){if(r.cls.is_subclass(t.get_bs_class(i.box_class_name())))throw o=i.get_type(),c=r.cls.method_lookup(t,""+util.internal2external[o]+"Value()"+o),t.push(r),c.setup_stack(t),l.runner=function(){return a[n]="J"===o||"D"===o?t.pop2():t.pop(),t.meta_stack().pop()},exceptions.ReturnException}else if(r.cls.is_subclass(i))return a[n]=r,void 0;return u="Ljava/lang/IllegalArgumentException;",null!=(s=t.get_bs_class(u,!0))?t.java_throw(s,"argument type mismatch"):t.async_op(function(e,n){return t.get_cl().initialize_class(t,u,function(e){return n(function(){return t.java_throw(e,"argument type mismatch")})},n)})})],Proxy:[o("defineClass0(L!/!/ClassLoader;L!/!/String;[BII)L!/!/Class;",function(t,e,n,r,a,i){return t.async_op(function(o,s){return native_define_class(t,n,r,a,i,get_cl_from_jclo(t,e),o,s)})})]},SecurityManager:[o("getClassContext()[Ljava/lang/Class;",function(t){var e,n,r,a;for(e=[],a=t.meta_stack()._cs,r=a.length-1;r>=0;r+=-1)n=a[r],n["native"]||e.push(n.method.cls.get_class_object(t));return new JavaArray(t,t.get_bs_class("[Ljava/lang/Class;"),e)})],Shutdown:[o("halt0(I)V",function(t,e){throw new exceptions.HaltException(e)})],StrictMath:[o("acos(D)D",function(t,e){return Math.acos(e)}),o("asin(D)D",function(t,e){return Math.asin(e)}),o("atan(D)D",function(t,e){return Math.atan(e)}),o("atan2(DD)D",function(t,e,n){return Math.atan2(e,n)}),o("cbrt(D)D",function(t,e){var n;return n=0>e,n?-Math.pow(-e,1/3):Math.pow(e,1/3)}),o("cos(D)D",function(t,e){return Math.cos(e)}),o("exp(D)D",function(t,e){return Math.exp(e)}),o("log(D)D",function(t,e){return Math.log(e)}),o("log10(D)D",function(t,e){return Math.log(e)/Math.LN10}),o("pow(DD)D",function(t,e,n){return Math.pow(e,n)}),o("sin(D)D",function(t,e){return Math.sin(e)}),o("sqrt(D)D",function(t,e){return Math.sqrt(e)}),o("tan(D)D",function(t,e){return Math.tan(e)}),o("floor(D)D",function(t,e){return Math.floor(e)}),o("ceil(D)D",function(t,e){return Math.ceil(e)})],String:[o("intern()L!/!/!;",function(t,e){var n=e.jvm2js_str(),r=t.string_pool.get(n);return null==r?(t.string_pool.set(n,e),e):r})],System:[o("arraycopy(L!/!/Object;IL!/!/Object;II)V",function(t,e,n,r,a,i){var o,s;return(null==e||null==r)&&t.java_throw(t.get_bs_class("Ljava/lang/NullPointerException;"),"Cannot copy to/from a null array."),e.cls instanceof ArrayClassData&&r.cls instanceof ArrayClassData||t.java_throw(t.get_bs_class("Ljava/lang/ArrayStoreException;"),"src and dest arguments must be of array type."),(0>n||n+i>e.array.length||0>a||a+i>r.array.length||0>i)&&t.java_throw(t.get_bs_class("Ljava/lang/ArrayIndexOutOfBoundsException;"),"Tried to write to an illegal index in an array."),e===r&&(e={cls:e.cls,array:e.array.slice(n,n+i)},n=0),e.cls.is_castable(r.cls)?arraycopy_no_check(e,n,r,a,i):(s=e.cls.get_component_class(),o=r.cls.get_component_class(),s instanceof PrimitiveClassData||o instanceof PrimitiveClassData?t.java_throw(t.get_bs_class("Ljava/lang/ArrayStoreException;"),"If calling arraycopy with a primitive array, both src and dest must be of the same primitive type."):arraycopy_check(t,e,n,r,a,i))
}),o("currentTimeMillis()J",function(){return gLong.fromNumber((new Date).getTime())}),o("identityHashCode(L!/!/Object;)I",function(t,e){var n;return null!=(n=null!=e?e.ref:void 0)?n:0}),o("initProperties(L!/util/Properties;)L!/util/Properties;",function(t){return t.push(null)}),o("nanoTime()J",function(){return gLong.fromNumber((new Date).getTime()).multiply(gLong.fromNumber(1e6))}),o("setIn0(L!/io/InputStream;)V",function(t,e){var n;return n=t.get_bs_class("Ljava/lang/System;"),n.static_put(t,"in",e)}),o("setOut0(L!/io/PrintStream;)V",function(t,e){var n;return n=t.get_bs_class("Ljava/lang/System;"),n.static_put(t,"out",e)}),o("setErr0(L!/io/PrintStream;)V",function(t,e){var n;return n=t.get_bs_class("Ljava/lang/System;"),n.static_put(t,"err",e)})],Thread:[o("currentThread()L!/!/!;",function(t){return t.curr_thread}),o("setPriority0(I)V",function(){}),o("holdsLock(L!/!/Object;)Z",function(t,e){return t.curr_thread===t.lock_refs[e.ref]}),o("isAlive()Z",function(t,e){var n;return null!=(n=e.$isAlive)?n:!1}),o("isInterrupted(Z)Z",function(t,e,n){var r,a;return r=null!=(a=e.$isInterrupted)?a:!1,n&&(e.$isInterrupted=!1),r}),o("interrupt0()V",function(t,e){var n;if(e.$isInterrupted=!0,e!==t.curr_thread){if(t.parked(e))return t.yield(e),void 0;throw n=util.last(e.$meta_stack._cs),n.runner=function(){return t.java_throw(t.get_bs_class("Ljava/lang/InterruptedException;"),"interrupt0 called")},e.$meta_stack.push({}),t.yield(e),exceptions.ReturnException}}),o("start0()V",function(t,e){var n,r,a,i;throw e.$isAlive=!0,e.$meta_stack=new threading.CallStack,t.thread_pool.push(e),r=t.curr_frame(),t.curr_thread=e,n=t.curr_frame(),t.push(e),a=e.cls.method_lookup(t,"run()V"),i=a.setup_stack(t),n.runner=function(){return n.runner=null,e.$isAlive=!1,debug("TE(start0): thread died: "+e.name(t))},r.runner=function(){return t.meta_stack().pop()},exceptions.ReturnException}),o("sleep(J)V",function(t,e){return t.curr_thread.wakeup_time=(new Date).getTime()+e.toNumber(),t.async_op(function(e){return t.choose_next_thread(null,function(n){return t.yield(n),e()})})}),o("yield()V",function(t){return t.async_op(function(e){return t.choose_next_thread(null,function(n){return t.yield(n),e()})})})],Throwable:[o("fillInStackTrace()L!/!/!;",function(t,e){var n;return n=new JavaArray(t,t.get_bs_class("[Ljava/lang/StackTraceElement;"),create_stack_trace(t,e)),e.set_field(t,"Ljava/lang/Throwable;stackTrace",n),e}),o("getStackTraceDepth()I",function(t,e){return create_stack_trace(t,e).length}),o("getStackTraceElement(I)L!/!/StackTraceElement;",function(t,e,n){return create_stack_trace(t,e)[n]})],UNIXProcess:[o("forkAndExec([B[BI[BI[BZLjava/io/FileDescriptor;Ljava/io/FileDescriptor;Ljava/io/FileDescriptor;)I",function(t,e,n,r){var a,i;return i=util.chars2js_str(n,0,n.array.length),a=util.chars2js_str(r,0,r.array.length),t.java_throw(t.get_bs_class("Ljava/lang/Error;"),"Doppio doesn't support forking processes. Command was: `"+i+" "+a+"`")})]},security:{AccessController:[o("doPrivileged(L!/!/PrivilegedAction;)L!/lang/Object;",doPrivileged),o("doPrivileged(L!/!/PrivilegedAction;L!/!/AccessControlContext;)L!/lang/Object;",doPrivileged),o("doPrivileged(L!/!/PrivilegedExceptionAction;)L!/lang/Object;",doPrivileged),o("doPrivileged(L!/!/PrivilegedExceptionAction;L!/!/AccessControlContext;)L!/lang/Object;",doPrivileged),o("getStackAccessControlContext()Ljava/security/AccessControlContext;",function(){return null})]},sql:{DriverManager:[o("getCallerClassLoader()Ljava/lang/ClassLoader;",function(t){var e;return e=t.meta_stack().get_caller(1).method.cls.loader.loader_obj,void 0!==e?e:null})]},io:{Console:[o("encoding()L!/lang/String;",function(){return null}),o("istty()Z",function(){return!0})],FileSystem:[o("getFileSystem()L!/!/!;",function(t){var e,n,r,a,i;throw i=t.curr_frame(),a=t.get_bs_class("Ljava/io/ExpiringCache;"),e=new JavaObject(t,a),n=new JavaObject(t,a),r=a.method_lookup(t,"<init>()V"),t.push2(e,n),r.setup_stack(t),i.runner=function(){return r.setup_stack(t),i.runner=function(){var r=t.jvm_state.system_properties,a=new JavaObject(t,t.get_bs_class("Ljava/io/UnixFileSystem;"),{"Ljava/io/UnixFileSystem;cache":e,"Ljava/io/UnixFileSystem;javaHomePrefixCache":n,"Ljava/io/UnixFileSystem;slash":r["file.separator"].charCodeAt(0),"Ljava/io/UnixFileSystem;colon":r["path.separator"].charCodeAt(0),"Ljava/io/UnixFileSystem;javaHome":t.init_string(r["java.home"],!0)});return t.meta_stack().pop(),t.push(a)}},exceptions.ReturnException})],FileOutputStream:[o("open(L!/lang/String;)V",function(t,e,n){return t.async_op(function(r){return fs.open(n.jvm2js_str(),"w",function(n,a){var i;return i=e.get_field(t,"Ljava/io/FileOutputStream;fd"),i.set_field(t,"Ljava/io/FileDescriptor;fd",a),e.$pos=0,r()})})}),o("openAppend(Ljava/lang/String;)V",function(t,e,n){return t.async_op(function(r){return fs.open(n.jvm2js_str(),"a",function(n,a){var i;return i=e.get_field(t,"Ljava/io/FileOutputStream;fd"),i.set_field(t,"Ljava/io/FileDescriptor;fd",a),fs.fstat(a,function(t,n){return e.$pos=n.size,r()})})})}),o("writeBytes([BIIZ)V",write_to_file),o("writeBytes([BII)V",write_to_file),o("close0()V",function(t,e){var n,r;return r=e.get_field(t,"Ljava/io/FileOutputStream;fd"),n=r.get_field(t,"Ljava/io/FileDescriptor;fd"),t.async_op(function(e,a){return fs.close(n,function(n){return n?a(function(){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),n.message)}):(r.set_field(t,"Ljava/io/FileDescriptor;fd",-1),e())})})})],FileInputStream:[o("available()I",function(t,e){var n,r;return r=e.get_field(t,"Ljava/io/FileInputStream;fd"),n=r.get_field(t,"Ljava/io/FileDescriptor;fd"),-1===n&&t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"Bad file descriptor"),0===n?0:t.async_op(function(t){return fs.fstat(n,function(n,r){return t(r.size-e.$pos)})})}),o("read()I",function(t,e){var n=e.get_field(t,"Ljava/io/FileInputStream;fd"),r=n.get_field(t,"Ljava/io/FileDescriptor;fd");-1===r&&t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"Bad file descriptor"),0!==r?t.async_op(function(t){return fs.fstat(r,function(n,a){var i;return i=new Buffer(a.size),fs.read(r,i,0,1,e.$pos,function(n,r){return e.$pos++,t(0===r?-1:i.readUInt8(0))})})}):t.async_op(function(e){return t.async_input(1,function(t){return e(0===t.length?-1:t.readUInt8(0))})})}),o("readBytes([BII)I",function(t,e,n,r,a){var i,o,s=e.get_field(t,"Ljava/io/FileInputStream;fd"),u=s.get_field(t,"Ljava/io/FileDescriptor;fd");-1===u&&t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"Bad file descriptor"),0!==u?(o=e.$pos,i=new Buffer(a),t.async_op(function(t){return fs.read(u,i,0,a,o,function(o,s){var u,c;if(null!=o)return t(-1);for(e.$pos+=s,u=c=0;s>c;u=c+=1)n.array[r+u]=i.readInt8(u);return t(0===s&&0!==a?-1:s)})})):t.async_op(function(e){return t.async_input(a,function(t){var a,i,o,s;for(i=o=0,s=t.length;s>o;i=++o)a=t.readUInt8(i),n.array[r+i]=a;return e(0===t.length?-1:t.length)})})}),o("open(Ljava/lang/String;)V",function(t,e,n){var r;return r=n.jvm2js_str(),t.async_op(function(n,a){return fs.open(r,"r",function(i,o){var s;return null!=i?"ENOENT"===i.code?a(function(){return t.java_throw(t.get_bs_class("Ljava/io/FileNotFoundException;"),""+r+" (No such file or directory)")}):a(function(){throw i}):(s=e.get_field(t,"Ljava/io/FileInputStream;fd"),s.set_field(t,"Ljava/io/FileDescriptor;fd",o),e.$pos=0,n())})})}),o("close0()V",function(t,e){var n,r;return r=e.get_field(t,"Ljava/io/FileInputStream;fd"),n=r.get_field(t,"Ljava/io/FileDescriptor;fd"),t.async_op(function(e,a){return fs.close(n,function(n){return n?a(function(){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),n.message)}):(r.set_field(t,"Ljava/io/FileDescriptor;fd",-1),e())})})}),o("skip(J)J",function(t,e,n){var r=e.get_field(t,"Ljava/io/FileInputStream;fd"),a=r.get_field(t,"Ljava/io/FileDescriptor;fd");-1===a&&t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"Bad file descriptor"),0!==a?t.async_op(function(t){return fs.fstat(a,function(r,a){var i,o;return i=a.size-e.$pos,o=Math.min(n.toNumber(),i),e.$pos+=o,t(gLong.fromNumber(o),null)})}):t.async_op(function(e){return t.async_input(n.toNumber(),function(t){return e(gLong.fromNumber(t.length),null)})})})],ObjectInputStream:[o("latestUserDefinedLoader()Ljava/lang/ClassLoader;",function(){return null})],ObjectStreamClass:[o("initNative()V",function(){}),o("hasStaticInitializer(Ljava/lang/Class;)Z",function(t,e){return null!=e.$cls.get_method("<clinit>()V")})],RandomAccessFile:[o("open(Ljava/lang/String;I)V",function(t,e,n,r){var a,i;return a=n.jvm2js_str(),i=function(){switch(r){case 1:return"r";case 2:return"r+";case 4:case 8:return"rs+"}}(),t.async_op(function(n,r){return fs.open(a,i,function(i,o){var s;return null!=i?r(function(){return t.java_throw(t.get_bs_class("Ljava/io/FileNotFoundException;"),"Could not open file "+a)}):(s=e.get_field(t,"Ljava/io/RandomAccessFile;fd"),s.set_field(t,"Ljava/io/FileDescriptor;fd",o),e.$pos=0,n())})})}),o("getFilePointer()J",function(t,e){return gLong.fromNumber(e.$pos)}),o("length()J",function(t,e){var n,r;return r=e.get_field(t,"Ljava/io/RandomAccessFile;fd"),n=r.get_field(t,"Ljava/io/FileDescriptor;fd"),t.async_op(function(t){return fs.fstat(n,function(e,n){return t(gLong.fromNumber(n.size),null)})})}),o("seek(J)V",function(t,e,n){return e.$pos=n.toNumber()}),o("readBytes([BII)I",function(t,e,n,r,a){var i=e.get_field(t,"Ljava/io/RandomAccessFile;fd"),o=i.get_field(t,"Ljava/io/FileDescriptor;fd"),s=new Buffer(a);t.async_op(function(t){fs.read(o,s,0,a,e.$pos,function(i,o){var u,c;if(null!=i)return t(-1);for(u=c=0;o>c;u=c+=1)n.array[r+u]=s.readInt8(u);return e.$pos+=o,t(0===o&&0!==a?-1:o)})})}),o("writeBytes([BII)V",function(t,e,n,r,a){var i=e.get_field(t,"Ljava/io/RandomAccessFile;fd"),o=i.get_field(t,"Ljava/io/FileDescriptor;fd"),s=new Buffer(n.array);t.async_op(function(t){fs.write(o,s,r,a,e.$pos,function(n,r){e.$pos+=r,t()})})}),o("close0()V",function(t,e){var n,r;return r=e.get_field(t,"Ljava/io/RandomAccessFile;fd"),n=r.get_field(t,"Ljava/io/FileDescriptor;fd"),t.async_op(function(e,a){return fs.close(n,function(n){return n?a(function(){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),n.message)}):(r.set_field(t,"Ljava/io/FileDescriptor;fd",-1),e())})})})],UnixFileSystem:[o("canonicalize0(L!/lang/String;)L!/lang/String;",function(t,e,n){var r;return r=n.jvm2js_str(),t.init_string(path.resolve(path.normalize(r)))}),o("checkAccess(Ljava/io/File;I)Z",function(t,e,n,r){var a;return a=n.get_field(t,"Ljava/io/File;path"),t.async_op(function(t){return stat_file(a.jvm2js_str(),function(e){var n;return null==e?t(!1):(n=r|r<<3|r<<6,t((e.mode&n)>0))})})}),o("createDirectory(Ljava/io/File;)Z",function(t,e,n){var r;return r=n.get_field(t,"Ljava/io/File;path").jvm2js_str(),t.async_op(function(t){return stat_file(r,function(e){return null!=e?t(!1):fs.mkdir(r,function(e){return t(null!=e?!1:!0)})})})}),o("createFileExclusively(Ljava/lang/String;)Z",function(t,e,n){var r;return r=n.jvm2js_str(),t.async_op(function(e,n){return stat_file(r,function(a){return null!=a?e(!1):fs.open(r,"w",function(r,a){return null!=r?n(function(){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),r.message)}):fs.close(a,function(r){return null!=r?n(function(){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),r.message)}):e(!0)})})})})}),o("createFileExclusively(Ljava/lang/String;Z)Z",function(t,e,n){var r;return r=n.jvm2js_str(),t.async_op(function(e,n){return stat_file(r,function(a){return null!=a?e(!1):fs.open(r,"w",function(r,a){return null!=r?n(function(){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),r.message)}):fs.close(a,function(r){return null!=r?n(function(){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),r.message)}):e(!0)})})})})}),o("delete0(Ljava/io/File;)Z",function(t,e,n){var r;return r=n.get_field(t,"Ljava/io/File;path").jvm2js_str(),t.async_op(function(t){return stat_file(r,function(e){return null==e?t(!1):e.isDirectory()?fs.readdir(r,function(e,n){return n.length>0?t(!1):fs.rmdir(r,function(){return t(!0)})}):fs.unlink(r,function(){return t(!0)})})})}),o("getBooleanAttributes0(Ljava/io/File;)I",function(t,e,n){var r;return r=n.get_field(t,"Ljava/io/File;path"),t.async_op(function(t){return stat_file(r.jvm2js_str(),function(e){return null==e?t(0):e.isFile()?t(3):e.isDirectory()?t(5):t(1)})})}),o("getLastModifiedTime(Ljava/io/File;)J",function(t,e,n){var r;return r=n.get_field(t,"Ljava/io/File;path").jvm2js_str(),t.async_op(function(t){return stat_file(r,function(e){return null==e?t(gLong.ZERO,null):t(gLong.fromNumber(new Date(e.mtime).getTime()),null)})})}),o("setLastModifiedTime(Ljava/io/File;J)Z",function(t,e,n,r){var a,i,o;return o=r.toNumber(),a=(new Date).getTime(),i=n.get_field(t,"Ljava/io/File;path").jvm2js_str(),t.async_op(function(t){return fs.utimes(i,a,o,function(){return t(!0)})})}),o("getLength(Ljava/io/File;)J",function(t,e,n){var r;return r=n.get_field(t,"Ljava/io/File;path"),t.async_op(function(t){return fs.stat(r.jvm2js_str(),function(e,n){return t(gLong.fromNumber(null!=e?0:n.size),null)})})}),o("list(Ljava/io/File;)[Ljava/lang/String;",function(t,e,n){var r;return r=n.get_field(t,"Ljava/io/File;path"),t.async_op(function(e){return fs.readdir(r.jvm2js_str(),function(n,r){var a;return null!=n?e(null):e(new JavaArray(t,t.get_bs_class("[Ljava/lang/String;"),function(){var e,n,i;for(i=[],e=0,n=r.length;n>e;e++)a=r[e],i.push(t.init_string(a));return i}()))})})}),o("rename0(Ljava/io/File;Ljava/io/File;)Z",function(t,e,n,r){var a,i;return a=n.get_field(t,"Ljava/io/File;path").jvm2js_str(),i=r.get_field(t,"Ljava/io/File;path").jvm2js_str(),t.async_op(function(t){return fs.rename(a,i,function(e){return t(null!=e?!1:!0)})})}),o("setPermission(Ljava/io/File;IZZ)Z",function(t,e,n,r,a,i){var o;return o=n.get_field(t,"Ljava/io/File;path").jvm2js_str(),i?r<<=6:r|=r<<6|r<<3,a||(r=~r),t.async_op(function(t){return stat_file(o,function(e){var n;return null==e?t(!1):(n=e.mode,r=a?n|r:n&r,fs.chmod(o,r,function(e){return t(null!=e?!1:!0)}))})})}),o("setReadOnly(Ljava/io/File;)Z",function(t,e,n){var r,a;return r=n.get_field(t,"Ljava/io/File;path").jvm2js_str(),a=-147,t.async_op(function(t){return stat_file(r,function(e){return null==e?t(!1):fs.chmod(r,e.mode&a,function(e){return t(null!=e?!1:!0)})})})})]},util:{concurrent:{atomic:{AtomicLong:[o("VMSupportsCS8()Z",function(){return!0})]}},jar:{JarFile:[o("getMetaInfEntryNames()[L!/lang/String;",function(){return null})]},ResourceBundle:[o("getClassContext()[L!/lang/Class;",function(t){return new JavaArray(t,t.get_bs_class("[Ljava/lang/Class;"),[null,null,null])})],TimeZone:[o("getSystemTimeZoneID(L!/lang/String;L!/lang/String;)L!/lang/String;",function(t){return t.init_string("GMT")}),o("getSystemGMTOffsetID()L!/lang/String;",function(){return null})]},net:{}},sun:{font:{FontManager:[],FreetypeFontScaler:[o("initIDs(Ljava/lang/Class;)V",function(){})],StrikeCache:[o("getGlyphCacheDescription([J)V",function(t,e){return e.array[0]=gLong.fromInt(8),e.array[1]=gLong.fromInt(8)})]},management:{VMManagementImpl:[o("getStartupTime()J",function(t){return t.startup_time}),o("getVersion0()Ljava/lang/String;",function(t){return t.init_string("1.2",!0)}),o("initOptionalSupportFields()V",function(t){var e,n,r,a,i,o;for(e=["compTimeMonitoringSupport","threadContentionMonitoringSupport","currentThreadCpuTimeSupport","otherThreadCpuTimeSupport","bootClassPathSupport","objectMonitorUsageSupport","synchronizerUsageSupport"],r=t.get_bs_class("Lsun/management/VMManagementImpl;"),o=[],a=0,i=e.length;i>a;a++)n=e[a],o.push(r.static_put(t,n,0));return o}),o("isThreadAllocatedMemoryEnabled()Z",function(){return!1}),o("isThreadContentionMonitoringEnabled()Z",function(){return!1}),o("isThreadCpuTimeEnabled()Z",function(){return!1}),o("getAvailableProcessors()I",function(){return 1}),o("getProcessId()I",function(){return 1})],MemoryImpl:[o("getMemoryManagers0()[Ljava/lang/management/MemoryManagerMXBean;",function(t){return new JavaArray(t,t.get_bs_class("[Lsun/management/MemoryManagerImpl;"),[])}),o("getMemoryPools0()[Ljava/lang/management/MemoryPoolMXBean;",function(t){return new JavaArray(t,t.get_bs_class("[Lsun/management/MemoryPoolImpl;"),[])})]},misc:{VM:[o("initialize()V",function(t){var e,n,r;return r=t.get_bs_class("Lsun/misc/VM;"),r.major_version>=51?(n=t.get_bs_class("Ljava/lang/System;"),e=n.static_get(t,"props"),r=t.get_bs_class("Lsun/misc/VM;"),r.static_put("savedProps",e)):void 0})],Unsafe:[o("addressSize()I",function(){return 4}),o("allocateInstance(Ljava/lang/Class;)Ljava/lang/Object;",function(t,e,n){return n=n.$cls,n.is_initialized(t)?new JavaObject(t,n):t.async_op(function(e,r){return n.loader.initialize_class(t,n.get_type(),function(){return e(new JavaObject(t,n))},r)})}),o("allocateMemory(J)J",function(t,e,n){var r,a,i;if(a=util.last(t.mem_start_addrs),"undefined"!=typeof DataView&&null!==DataView)t.mem_blocks[a]=new DataView(new ArrayBuffer(n));else for(t.mem_blocks[a]=n,a+=1,r=i=0;n>i;r=i+=1)t.mem_blocks[a+r]=0;return t.mem_start_addrs.push(a+n),gLong.fromNumber(a)}),o("copyMemory(Ljava/lang/Object;JLjava/lang/Object;JJ)V",function(t,e,n,r,a,i,o){return unsafe_memcpy(t,n,r,a,i,o)}),o("setMemory(JJB)V",function(t,e,n,r,a){var i,o,s;for(i=t.block_addr(n),o=s=0;r>s;o=s+=1)"undefined"!=typeof DataView&&null!==DataView?t.mem_blocks[i].setInt8(o,a):t.mem_blocks[i+o]=a}),o("freeMemory(J)V",function(t,e,n){var r,a,i;if("undefined"!=typeof DataView&&null!==DataView)delete t.mem_blocks[n.toNumber()];else{for(n=n.toNumber(),a=t.mem_blocks[n-1],r=i=0;a>i;r=i+=1)delete t.mem_blocks[n+r];delete t.mem_blocks[n-1],n-=1}return t.mem_start_addrs.splice(t.mem_start_addrs.indexOf(n),1)}),o("putLong(JJ)V",function(t,e,n,r){var a,i,o;a=t.block_addr(n),i=n-a,"undefined"!=typeof DataView&&null!==DataView?(t.mem_blocks[a].setInt32(i,r.getLowBits(),!0),t.mem_blocks[a].setInt32(i+4,r.getHighBits,!0)):(o=function(t,e,n){return t.mem_blocks[e]=255&n,t.mem_blocks[e+1]=n>>>8&255,t.mem_blocks[e+2]=n>>>16&255,t.mem_blocks[e+3]=n>>>24&255},o(t,n,r.getLowBits()),o(t,n+4,r.getHighBits()))}),o("getByte(J)B",function(t,e,n){var r;return r=t.block_addr(n),"undefined"!=typeof DataView&&null!==DataView?t.mem_blocks[r].getInt8(n-r):t.mem_blocks[r]}),o("arrayBaseOffset(Ljava/lang/Class;)I",function(){return 0}),o("arrayIndexScale(Ljava/lang/Class;)I",function(){return 1}),o("compareAndSwapObject(Ljava/lang/Object;JLjava/lang/Object;Ljava/lang/Object;)Z",unsafe_compare_and_swap),o("compareAndSwapInt(Ljava/lang/Object;JII)Z",unsafe_compare_and_swap),o("compareAndSwapLong(Ljava/lang/Object;JJJ)Z",unsafe_compare_and_swap),o("ensureClassInitialized(Ljava/lang/Class;)V",function(t,e,n){return t.async_op(function(e,r){return n.$cls.loader.initialize_class(t,n.$cls.get_type(),function(){return e()},r)})}),o("staticFieldOffset(Ljava/lang/reflect/Field;)J",function(t,e,n){var r,a;return r=n.get_field(t,"Ljava/lang/reflect/Field;clazz"),a=n.get_field(t,"Ljava/lang/reflect/Field;slot"),gLong.fromNumber(a+r.ref)}),o("objectFieldOffset(Ljava/lang/reflect/Field;)J",function(t,e,n){var r,a;return r=n.get_field(t,"Ljava/lang/reflect/Field;clazz"),a=n.get_field(t,"Ljava/lang/reflect/Field;slot"),gLong.fromNumber(a+r.ref)}),o("staticFieldBase(Ljava/lang/reflect/Field;)Ljava/lang/Object;",function(t,e,n){var r;return r=n.get_field(t,"Ljava/lang/reflect/Field;clazz"),new JavaObject(t,r.$cls)}),o("getBoolean(Ljava/lang/Object;J)Z",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getBooleanVolatile(Ljava/lang/Object;J)Z",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getDouble(Ljava/lang/Object;J)D",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getDoubleVolatile(Ljava/lang/Object;J)D",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getFloat(Ljava/lang/Object;J)F",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getFloatVolatile(Ljava/lang/Object;J)F",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getInt(Ljava/lang/Object;J)I",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getIntVolatile(Ljava/lang/Object;J)I",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getLong(Ljava/lang/Object;J)J",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getLongVolatile(Ljava/lang/Object;J)J",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getShort(Ljava/lang/Object;J)S",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getShortVolatile(Ljava/lang/Object;J)S",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getObject(Ljava/lang/Object;J)Ljava/lang/Object;",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("getObjectVolatile(Ljava/lang/Object;J)Ljava/lang/Object;",function(t,e,n,r){return n.get_field_from_offset(t,r)}),o("putDouble(Ljava/lang/Object;JD)V",function(t,e,n,r,a){return n.set_field_from_offset(t,r,a)}),o("putInt(Ljava/lang/Object;JI)V",function(t,e,n,r,a){return n.set_field_from_offset(t,r,a)}),o("putObject(Ljava/lang/Object;JLjava/lang/Object;)V",function(t,e,n,r,a){return n.set_field_from_offset(t,r,a)}),o("putObjectVolatile(Ljava/lang/Object;JLjava/lang/Object;)V",function(t,e,n,r,a){return n.set_field_from_offset(t,r,a)}),o("putOrderedObject(Ljava/lang/Object;JLjava/lang/Object;)V",function(t,e,n,r,a){return n.set_field_from_offset(t,r,a)}),o("defineClass(Ljava/lang/String;[BIILjava/lang/ClassLoader;Ljava/security/ProtectionDomain;)Ljava/lang/Class;",function(t,e,n,r,a,i,o){return t.async_op(function(e,s){return native_define_class(t,n,r,a,i,get_cl_from_jclo(t,o),e,s)})}),o("pageSize()I",function(){return 1024}),o("throwException(Ljava/lang/Throwable;)V",function(t,e,n){var r;throw r=t.curr_frame(),r.runner=function(){throw r.runner=null,new exceptions.JavaException(n)},exceptions.ReturnException}),o("park(ZJ)V",function(t,e,n,r){var a;return a=1/0,n?a=r:r>0&&(a=(new Date).getTime()+r/1e6),t.park(t.curr_thread,a)}),o("unpark(Ljava/lang/Object;)V",function(t,e,n){return t.unpark(n)})]},net:{spi:{}},nio:{ch:{FileChannelImpl:[o("initIDs()J",function(){return gLong.fromNumber(1024)}),o("size0(Ljava/io/FileDescriptor;)J",function(t,e,n){var r=n.get_field(t,"Ljava/io/FileDescriptor;fd");t.async_op(function(e,n){fs.fstat(r,function(r,a){null!=r&&n(function(){t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"Bad file descriptor.")}),e(gLong.fromNumber(a.size))})})}),o("position0(Ljava/io/FileDescriptor;J)J",function(t,e,n,r){var a;return a=e.get_field(t,"Lsun/nio/ch/FileChannelImpl;parent"),gLong.fromNumber(r.equals(gLong.NEG_ONE)?a.$pos:a.$pos=r.toNumber())})],FileDispatcher:[o("init()V",function(){}),o("read0(Ljava/io/FileDescriptor;JI)I",function(t,e,n,r){var a=e.get_field(t,"Ljava/io/FileDescriptor;fd"),i=t.block_addr(n),o=new Buffer(r);t.async_op(function(e){fs.read(a,o,0,r,0,function(n,r){var a;if("undefined"!=typeof DataView&&null!==DataView)for(a=0;r>a;a++)t.mem_blocks[i].setInt8(a,o.readInt8(a));else for(a=0;r>a;a++)t.mem_blocks[i+a]=o.readInt8(a);e(r)})})}),o("preClose0(Ljava/io/FileDescriptor;)V",function(){})],NativeThread:[o("init()V",function(){}),o("current()J",function(){return gLong.fromNumber(-1)})]}}}},exports.native_methods.java.lang.Class=[o("getPrimitiveClass(L!/!/String;)L!/!/!;",function(t,e){var n,r;return r=util.typestr2descriptor(e.jvm2js_str()),n=t.get_bs_class(r),n.get_class_object(t)}),o("getClassLoader0()L!/!/ClassLoader;",function(t,e){var n;return n=e.$cls.loader,null!=n.loader_obj?n.loader_obj:null}),o("desiredAssertionStatus0(L!/!/!;)Z",function(){return!1}),o("getName0()L!/!/String;",function(t,e){return t.init_string(e.$cls.toExternalString())}),o("forName0(L!/!/String;ZL!/!/ClassLoader;)L!/!/!;",function(t,e,n,r){var a=util.int_classname(e.jvm2js_str());util.verify_int_classname(a)||t.java_throw(t.get_bs_class("Ljava/lang/ClassNotFoundException;"),a),r=get_cl_from_jclo(t,r),t.async_op(function(e,i){return n?r.initialize_class(t,a,function(n){return e(n.get_class_object(t))},i,!0):r.resolve_class(t,a,function(n){return e(n.get_class_object(t))},i,!0)})}),o("getComponentType()L!/!/!;",function(t,e){return e.$cls instanceof ArrayClassData?e.$cls.get_component_class().get_class_object(t):null}),o("getGenericSignature()Ljava/lang/String;",function(t,e){var n,r;return n=null!=(r=e.$cls.get_attribute("Signature"))?r.sig:void 0,null!=n?t.init_string(n):null}),o("getProtectionDomain0()Ljava/security/ProtectionDomain;",function(){return null}),o("isAssignableFrom(L!/!/!;)Z",function(t,e,n){return n.$cls.is_castable(e.$cls)}),o("isInterface()Z",function(t,e){return e.$cls instanceof ReferenceClassData?e.$cls.access_flags["interface"]:!1}),o("isInstance(L!/!/Object;)Z",function(t,e,n){return n.cls.is_castable(e.$cls)}),o("isPrimitive()Z",function(t,e){return e.$cls instanceof PrimitiveClassData}),o("isArray()Z",function(t,e){return e.$cls instanceof ArrayClassData}),o("getSuperclass()L!/!/!;",function(t,e){if(e.$cls instanceof PrimitiveClassData)return null;var n=e.$cls;return n.access_flags["interface"]||null==n.get_super_class()?null:n.get_super_class().get_class_object(t)}),o("getDeclaredFields0(Z)[Ljava/lang/reflect/Field;",function(t,e,n){var r=e.$cls.get_fields();n&&(r=r.filter(function(t){return t.access_flags["public"]}));var a=[];t.async_op(function(e,n){util.async_foreach(r,function(e,r){e.reflector(t,function(t){a.push(t),r()},n)},function(){var n=t.get_bs_class("[Ljava/lang/reflect/Field;");e(new JavaArray(t,n,a))})})}),o("getDeclaredMethods0(Z)[Ljava/lang/reflect/Method;",function(t,e,n){var r=e.$cls.get_methods(),a=function(){var t=[];for(var e in r){var a=r[e];"<"===e[0]||!a.access_flags["public"]&&n||t.push(a)}return t}(),i=[];t.async_op(function(e,n){util.async_foreach(a,function(e,r){e.reflector(t,!1,function(t){i.push(t),r()},n)},function(){var n=t.get_bs_class("[Ljava/lang/reflect/Method;");e(new JavaArray(t,n,i))})})}),o("getDeclaredConstructors0(Z)[Ljava/lang/reflect/Constructor;",function(t,e,n){var r=e.$cls.get_methods(),a=function(){var t=[];for(var e in r){var n=r[e];"<init>"===n.name&&t.push(n)}return t}();n&&(a=a.filter(function(t){return t.access_flags["public"]}));var i=t.get_bs_class("[Ljava/lang/reflect/Constructor;"),o=[];t.async_op(function(e,n){util.async_foreach(a,function(e,r){e.reflector(t,!0,function(t){o.push(t),r()},n)},function(){e(new JavaArray(t,i,o))})})}),o("getInterfaces()[L!/!/!;",function(t,e){var n=e.$cls,r=n.get_interfaces(),a=r.map(function(e){return e.get_class_object(t)});return new JavaArray(t,t.get_bs_class("[Ljava/lang/Class;"),a)}),o("getModifiers()I",function(t,e){return e.$cls.access_byte}),o("getRawAnnotations()[B",function(t,e){var n,r,a,i,o;if(r=e.$cls,n=r.get_attribute("RuntimeVisibleAnnotations"),null!=n)return new JavaArray(t,t.get_bs_class("[B"),n.raw_bytes);o=r.get_methods();for(i in o)if(a=o[i],n=a.get_attribute("RuntimeVisibleAnnotations"),null!=n)return new JavaArray(t,t.get_bs_class("[B"),n.raw_bytes);return null}),o("getConstantPool()Lsun/reflect/ConstantPool;",function(t,e){var n;return n=e.$cls,new JavaObject(t,t.get_bs_class("Lsun/reflect/ConstantPool;"),{"Lsun/reflect/ConstantPool;constantPoolOop":n.constant_pool})}),o("getEnclosingMethod0()[L!/!/Object;",function(t,e){var n,r,a,i,o;return e.$cls instanceof ReferenceClassData?(n=e.$cls,r=n.get_attribute("EnclosingMethod"),null==r?null:(a=n.loader.get_resolved_class(r.enc_class).get_class_object(t),null!=r.enc_method?(o=t.init_string(r.enc_method.name),i=t.init_string(r.enc_method.type)):(o=null,i=null),new JavaArray(t,t.get_bs_class("[Ljava/lang/Object;"),[a,o,i]))):null}),o("getDeclaringClass()L!/!/!;",get_declaring_class),o("getDeclaringClass0()L!/!/!;",get_declaring_class),o("getDeclaredClasses0()[L!/!/!;",function(t,e){var n=new JavaArray(t,t.get_bs_class("[Ljava/lang/Class;"),[]);if(!(e.$cls instanceof ReferenceClassData))return n;var r=e.$cls,a=e.$cls.get_type(),i=r.get_attributes("InnerClasses");if(0===i.length)return n;for(var o=[],s=0;s<i.length;s++){var u=i[s].classes.filter(function(t){return t.outer_info_index>0&&r.constant_pool.get(t.outer_info_index).deref()===a}).map(function(t){return r.constant_pool.get(t.inner_info_index).deref()});o.push.apply(o,u)}t.async_op(function(e,a){util.async_foreach(o,function(e,i){r.loader.resolve_class(t,e,function(e){n.array.push(e.get_class_object(t)),i()},a)},function(){return e(n)})})})],exports.native_methods.java.lang.Runtime=[o("availableProcessors()I",function(){return 1}),o("gc()V",function(t){return t.async_op(function(t){return t()})}),o("maxMemory()J",function(){return gLong.MAX_VALUE})],exports.native_methods.java.net.Inet4Address=[o("init()V",function(){})];var host_lookup={},host_reverse_lookup={},next_host_address=4026531840;exports.native_methods.java.net.Inet4AddressImpl=[o("lookupAllHostAddr(Ljava/lang/String;)[Ljava/net/InetAddress;",function(t,e,n){var r,a,i,o;return r=t.get_class("Ljava/net/Inet4Address;"),o=function(e,n){return n(new JavaArray(t,t.get_bs_class("[Ljava/net/InetAddress;"),[e]))},i=function(t,e,n){return n(t)},a=r.method_lookup(t,"<init>(Ljava/lang/String;I)V"),t.call_bytecode(r,a,[n,host_allocate_address(n.jvm2js_str())],o,i)}),o("getLocalHostName()Ljava/lang/String;",function(t){return t.init_string("localhost")}),o("getHostByAddr([B)Ljava/lang/String;",function(t,e,n){var r;return r=host_reverse_lookup[pack_address(n.array)],void 0===r?null:t.init_string(r)}),o("isReachable0([BII[BII)Z",function(){return!1})],exports.native_methods.java.net.Inet6Address=[o("init()V",function(){})],exports.native_methods.java.net.InetAddress=[o("init()V",function(){})],exports.native_methods.java.net.InetAddressImplFactory=[o("isIPv6Supported()Z",function(){return!1})],exports.native_methods.java.net.PlainSocketImpl=[o("socketCreate(Z)V",function(t,e){var n;return util.are_in_browser()||t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"WebSockets are disabled"),n=e.get_field(t,"Ljava/net/SocketImpl;fd"),n.set_field(t,"Ljava/io/FileDescriptor;fd",8374),e.$ws=new Websock,e.$is_shutdown=!1}),o("socketConnect(Ljava/net/InetAddress;II)V",function(t,e,n,r,a){var i,o,s,u,c,l;if(o=n.get_field(t,"Ljava/net/InetAddress;holder"),i=o.get_field(t,"Ljava/net/InetAddress$InetAddressHolder;address"),s="ws://",void 0===host_lookup[i]){for(u=l=3;l>=0;u=l+=-1)c=8*u,s+=""+((i&255<<c)>>>c)+".";s=s.substring(0,s.length-1)}else s+=host_lookup[i];return s+=":"+r,t.async_op(function(n,r){var i,o,u,c,l;l=0,i=function(){return window.clearTimeout(l),e.$ws.on("open",function(){}),e.$ws.on("close",function(){}),e.$ws.on("error",function(){})},c=function(e){return function(n){return i(),r(function(){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),e+": "+n)})}},o=function(e){return function(n){return i(),r(function(){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),e+": "+websocket_status_to_message(n.status))})}},e.$ws.on("open",function(){return i(),n()}),e.$ws.on("close",o("Connection failed! (Closed)")),0===a&&(a=1e4),l=setTimeout(c("Connection timeout!"),a);try{return e.$ws.open(s)}catch(f){return u=f,c("Connection failed! (exception)")(u.message)}})}),o("socketBind(Ljava/net/InetAddress;I)V",function(t){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"WebSockets doesn't know how to bind")}),o("socketListen(I)V",function(t){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"WebSockets doesn't know how to listen")}),o("socketAccept(Ljava/net/SocketImpl;)V",function(t){return t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"WebSockets doesn't know how to accept")}),o("socketAvailable()I",function(t,e){return t.async_op(function(t){return setImmediate(function(){return t(e.$ws.rQlen())})})}),o("socketClose0(Z)V",function(t,e){return e.$ws.close()}),o("socketShutdown(I)V",function(t,e){return e.$is_shutdown=!0}),o("initProto()V",function(){}),o("socketSetOption(IZLjava/lang/Object;)V",function(){}),o("socketGetOption(ILjava/lang/Object;)I",function(){}),o("socketGetOption1(ILjava/lang/Object;Ljava/io/FileDescriptor;)I",function(){}),o("socketSendUrgentData(I)V",function(t,e,n){return e.$ws.send(n)})],exports.native_methods.java.net.SocketInputStream=[o("init()V",function(){}),o("socketRead0(Ljava/io/FileDescriptor;[BIII)I",function(t,e,n,r,a,i,o){var s=e.get_field(t,"Ljava/net/SocketInputStream;impl");
return s.$is_shutdown===!0&&t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"Socket is shutdown."),t.async_op(function(t){return setTimeout(function(){socket_read_async(s,r,a,i,t)},o)})})],exports.native_methods.java.net.SocketOutputStream=[o("init()V",function(){}),o("socketWrite0(Ljava/io/FileDescriptor;[BII)V",function(t,e,n,r,a,i){var o=e.get_field(t,"Ljava/net/SocketOutputStream;impl");return o.$is_shutdown===!0&&t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"Socket is shutdown."),o.$ws.get_raw_state()!==WebSocket.OPEN&&t.java_throw(t.get_bs_class("Ljava/io/IOException;"),"Connection isn't open"),o.$ws.send(r.array.slice(a,a+i)),t.async_op(function(t){return setImmediate(function(){return t()})})})],exports.native_methods.sun.net.spi.DefaultProxySelector=[o("init()Z",function(){return!0}),o("getSystemProxy(Ljava/lang/String;Ljava/lang/String;)Ljava/net/Proxy;",function(){return null})],exports.native_methods.sun.reflect={ConstantPool:[o("getLongAt0(Ljava/lang/Object;I)J",function(t,e,n,r){return n.get(r).value}),o("getUTF8At0(Ljava/lang/Object;I)Ljava/lang/String;",function(t,e,n,r){return t.init_string(n.get(r).value)})],NativeMethodAccessorImpl:[o("invoke0(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;",function(t,e,n,r){var a,i,o,s,u,c,l,f,_,p,h,d,g;if(o=e.get_field(t,"Ljava/lang/reflect/Method;clazz"),d=e.get_field(t,"Ljava/lang/reflect/Method;returnType"),h=d.$cls.get_type(),i=util.is_primitive_type(h)&&"V"!==h?function(){var e;return e="J"===h||"D"===h?t.pop2():t.pop(),t.meta_stack().pop(),t.push(d.$cls.create_wrapper_object(t,e))}:function(){var e;return e=t.pop(),t.meta_stack().pop(),t.push(e)},512&o.$cls.access_byte)throw s=t.check_null(n).cls,l=e.get_field(t,"Ljava/lang/reflect/Method;name").jvm2js_str(t),_=e.get_field(t,"Ljava/lang/reflect/Method;parameterTypes"),f=function(){var t,e,n,r;for(n=_.array,r=[],t=0,e=n.length;e>t;t++)p=n[t],r.push(p.$cls.get_type());return r}().join(""),u=""+l+"("+f+")"+h,c=s.method_lookup(t,u),a=setup_caller_stack(t,c,n,r),c.setup_stack(t),a.runner=i,exceptions.ReturnException;return g=e.get_field(t,"Ljava/lang/reflect/Method;slot"),t.async_op(function(e,s){return o.$cls.loader.initialize_class(t,o.$cls.get_type(),function(e){var o;return c=function(){var t,n;t=e.get_methods(),n=[];for(o in t)c=t[o],c.idx===g&&n.push(c);return n}()[0],a=setup_caller_stack(t,c,n,r),s(function(){return c.setup_stack(t),a.runner=i})},s)})})],NativeConstructorAccessorImpl:[o("newInstance0(Ljava/lang/reflect/Constructor;[Ljava/lang/Object;)Ljava/lang/Object;",function(t,e,n){var r,a;return r=e.get_field(t,"Ljava/lang/reflect/Constructor;clazz"),a=e.get_field(t,"Ljava/lang/reflect/Constructor;slot"),t.async_op(function(e,i){return r.$cls.loader.initialize_class(t,r.$cls.get_type(),function(e){var r,o,s,u;return r=function(){var t,n;t=e.get_methods(),n=[];for(u in t)r=t[u],r.idx===a&&n.push(r);return n}()[0],o=t.curr_frame(),s=new JavaObject(t,e),t.push(s),null!=n&&t.push_array(n.array),i(function(){return r.setup_stack(t),o.runner=function(){return t.meta_stack().pop(),t.push(s)}})},i)})})],Reflection:[o("getCallerClass(I)Ljava/lang/Class;",get_caller_class),o("getCallerClass0(I)Ljava/lang/Class;",get_caller_class),o("getCallerClass()Ljava/lang/Class;",function(t){return get_caller_class(t,2)}),o("getClassAccessFlags(Ljava/lang/Class;)I",function(t,e){return e.$cls.access_byte})]},exports.trapped_methods=flatten_pkg(exports.trapped_methods),exports.native_methods=flatten_pkg(exports.native_methods)});var __extends=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};define("src/methods",["require","exports","./util","./opcodes","./attributes","./natives","./logging","./jvm","./exceptions","./java_object","./threading"],function(t,e,n,r,a,i,o,s,u,c,l){var f=u.ReturnException,_=(o.vtrace,o.trace,o.debug_vars,i.native_methods),p=i.trapped_methods,h=c.JavaArray,d=c.JavaObject,g=function(){function t(t){this.cls=t}return t.prototype.parse=function(t,e,r){this.idx=r,this.access_byte=t.get_uint(2),this.access_flags=n.parse_flags(this.access_byte),this.name=e.get(t.get_uint(2)).value,this.raw_descriptor=e.get(t.get_uint(2)).value,this.parse_descriptor(this.raw_descriptor),this.attrs=a.make_attributes(t,e)},t.prototype.get_attribute=function(t){for(var e=0;e<this.attrs.length;e++){var n=this.attrs[e];if(n.name===t)return n}return null},t.prototype.get_attributes=function(t){return this.attrs.filter(function(e){return e.name===t})},t.prototype.parse_descriptor=function(){throw new Error("Unimplemented error.")},t}();e.AbstractMethodField=g;var v=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.parse_descriptor=function(t){this.type=t},e.prototype.reflector=function(t,e,n){function r(e,n){var r=t.get_bs_class("Ljava/lang/reflect/Field;");return new d(t,r,{"Ljava/lang/reflect/Field;clazz":e,"Ljava/lang/reflect/Field;name":t.init_string(a.name,!0),"Ljava/lang/reflect/Field;type":n,"Ljava/lang/reflect/Field;modifiers":a.access_byte,"Ljava/lang/reflect/Field;slot":a.idx,"Ljava/lang/reflect/Field;signature":null!=o?t.init_string(o):null})}var a=this,i=this.get_attribute("Signature"),o=null!=i?i.sig:null,s=this.cls.get_class_object(t);this.cls.loader.resolve_class(t,this.type,function(n){var a=n.get_class_object(t),i=r(s,a);e(i)},n)},e}(g);e.Field=v;var m=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.parse_descriptor=function(t){this.reset_caches=!1;var e=/\(([^)]*)\)(.*)/.exec(t),r=e[1],a=e[2],i=r.split("");this.param_types=[];for(var o;o=n.carr2descriptor(i);)this.param_types.push(o);this.param_bytes=0;for(var s=0;s<this.param_types.length;s++){var u=this.param_types[s];this.param_bytes+="D"===u||"J"===u?2:1}this.access_flags["static"]||this.param_bytes++,this.num_args=this.param_types.length,this.access_flags["static"]||this.num_args++,this.return_type=a},e.prototype.full_signature=function(){return this.cls.get_type()+"::"+this.name+this.raw_descriptor},e.prototype.parse=function(e,n,r){t.prototype.parse.call(this,e,n,r);var a,i=this.full_signature();null!=(a=p[i])?(this.code=a,this.access_flags["native"]=!0):this.access_flags["native"]?null!=(a=_[i])?this.code=a:i.indexOf("::registerNatives()V",1)<0&&i.indexOf("::initIDs()V",1)<0?(s.show_NYI_natives&&console.log(i),this.code=function(t){t.java_throw(t.get_bs_class("Ljava/lang/UnsatisfiedLinkError;"),"Native method '"+i+"' not implemented.\nPlease fix or file a bug at https://github.com/int3/doppio/issues")}):this.code=null:this.access_flags.abstract||(this.has_bytecode=!0,this.code=this.get_attribute("Code"))},e.prototype.reflector=function(t,e,n,r){var a,i,o,s,u,c=this;null==e&&(e=!1);var l=e?"Ljava/lang/reflect/Constructor;":"Ljava/lang/reflect/Method;",f=null!=(a=null!=(i=this.get_attribute("Exceptions"))?i.exceptions:void 0)?a:[],_=null!=(o=this.get_attribute("RuntimeVisibleAnnotations"))?o.raw_bytes:void 0,p=null!=(s=this.get_attribute("AnnotationDefault"))?s.raw_bytes:void 0,g=null!=(u=this.get_attribute("Signature"))?u.sig:void 0,v={},m=this.cls.get_class_object(t);this.cls.loader.resolve_class(t,this.return_type,function(e){function a(){if(L<s.length){var e=s[L++];return"<any>"===e.catch_type?a():c.cls.loader.resolve_class(t,e.catch_type,a,r)}return o()}function i(){if(y++,y<f.length){var e=f[y];return c.cls.loader.resolve_class(t,e,function(e){return j[y]=e.get_class_object(t),i()},r)}var a=t.get_bs_class("[Ljava/lang/Class;"),o=t.get_bs_class("[B"),s=t.get_bs_class(l);return v[l+"clazz"]=m,v[l+"name"]=t.init_string(c.name,!0),v[l+"parameterTypes"]=new h(t,a,w),v[l+"returnType"]=u,v[l+"exceptionTypes"]=new h(t,a,j),v[l+"modifiers"]=c.access_byte,v[l+"slot"]=c.idx,v[l+"signature"]=null!=g?t.init_string(g):null,v[l+"annotations"]=null!=_?new h(t,o,_):null,v[l+"annotationDefault"]=null!=p?new h(t,o,p):null,n(new d(t,s,v))}function o(){return b++,b<c.param_types.length?c.cls.loader.resolve_class(t,c.param_types[b],function(e){return w[b]=e.get_class_object(t),o()},r):i()}var s,u=e.get_class_object(t),y=-1,j=[],b=-1,w=[],L=0;return null!=c.code&&null!=c.code.exception_handlers&&c.code.exception_handlers.length>0?(s=[{catch_type:"Ljava/lang/Throwable;"}],Array.prototype.push.apply(s,c.code.exception_handlers)):s=[],a()},r)},e.prototype.take_params=function(t){var e=t.length-this.param_bytes,n=t.slice(e);return t.length-=this.param_bytes,n},e.prototype.convert_params=function(t,e){var n=[t],r=0;this.access_flags["static"]||(n.push(e[0]),r=1);for(var a=0;a<this.param_types.length;a++){var i=this.param_types[a];n.push(e[r]),r+="J"===i||"D"===i?2:1}return n},e.prototype.run_manually=function(t,e,n){var r;try{r=t.apply(null,n)}catch(a){var i=a;if(i===f)return;throw i}e.meta_stack().pop();var o=this.return_type;"V"!==o&&("Z"===o?e.push(r+0):e.push(r),("J"===o||"D"===o)&&e.push(null))},e.prototype.initialize=function(){this.reset_caches=!0},e.prototype.method_lock=function(t){return this.access_flags["static"]?this.cls.get_class_object(t):t.cl(0)},e.prototype.run_bytecode=function(t){var e=this.code.opcodes;if(this.reset_caches)for(var n=0;n<e.length;n++){var a=e[n];null!=a&&a.reset_cache()}var i=t.curr_frame();if(this.access_flags.synchronized&&0===i.pc&&!r.monitorenter(t,this.method_lock(t)))return i.pc=0,void 0;for(var o=e[i.pc];!t.should_return;){if(o.execute(t)===!1)break;i.pc+=1+o.byte_count,o=e[i.pc]}t.should_return=!1},e.prototype.setup_stack=function(t){var e,n=this,a=t.meta_stack(),i=t.curr_frame().stack,o=this.take_params(i);if(this.access_flags["native"]){if(null!=this.code){a.push(e=new l.StackFrame(this,[],[]));var s=this.convert_params(t,o);return e.runner=function(){return n.run_manually(n.code,t,s)},e}return null}if(this.access_flags.abstract){var u=t.get_bs_class("Ljava/lang/Error;");t.java_throw(u,"called abstract method: "+this.full_signature())}if(a.push(e=new l.StackFrame(this,o,[])),this.code.run_stamp<t.run_stamp&&(this.code.run_stamp=t.run_stamp,this.code.parse_code(),this.access_flags.synchronized))for(var c in this.code.opcodes)if(this.code.opcodes.hasOwnProperty(c)){var f=this.code.opcodes[c];f.name.match(/^[ildfa]?return$/)&&!function(t){t.execute=function(e){return r.monitorexit(e,n.method_lock(e)),t.orig_execute(e)}}(f)}return e.runner=function(){return n.run_bytecode(t)},e},e}(g);e.Method=m});var __extends=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};define("src/ClassData",["require","exports","./util","./ConstantPool","./attributes","./java_object","./logging","./methods","./natives","./enums"],function(t,e,n,r,a,i,o,s,u,c){var l=i.JavaObject,f=i.JavaClassObject,_=(c.ClassState,o.trace,function(){function t(t){this.access_flags=null,this.state=0,this.jco=null,this.reset_bit=0,u.instantiated||u.instantiate(d,p,h),this.loader=null!=t?t:null}return t.prototype.reset=function(){this.jco=null,this.reset_bit=0;var t=this.get_super_class();null!=t&&1===t.reset_bit&&t.reset();for(var e=this.get_interfaces(),n=0;n<e.length;n++){var r=e[n];1===r.reset_bit&&r.reset()}},t.prototype.toExternalString=function(){return n.ext_classname(this.this_class)},t.prototype.get_class_loader=function(){return this.loader},t.prototype.get_type=function(){return this.this_class},t.prototype.get_super_class_type=function(){return this.super_class},t.prototype.get_super_class=function(){return this.super_class_cdata},t.prototype.get_interface_types=function(){return[]},t.prototype.get_interfaces=function(){return[]},t.prototype.get_class_object=function(t){return null==this.jco&&(this.jco=new f(t,this)),this.jco},t.prototype.get_method=function(){return null},t.prototype.get_methods=function(){return{}},t.prototype.get_fields=function(){return[]},t.prototype.method_lookup=function(t,e){var r=t.get_bs_class("Ljava/lang/NoSuchMethodError;");return t.java_throw(r,"No such method found in "+n.ext_classname(this.get_type())+"::"+e),null},t.prototype.field_lookup=function(t,e){var r=t.get_bs_class("Ljava/lang/NoSuchFieldError;");return t.java_throw(r,"No such field found in "+n.ext_classname(this.get_type())+"::"+e),null},t.prototype.set_state=function(t){this.state=t},t.prototype.get_state=function(){if(1==this.state&&null==this.get_method("<clinit>()V")){var t=this.get_super_class();null!=t&&2===t.get_state()&&(this.state=2)}return this.state},t.prototype.is_initialized=function(){return 2===this.get_state()},t.prototype.is_resolved=function(){return 0!==this.get_state()},t.prototype.is_subinterface=function(){return!1},t.prototype.is_subclass=function(t){return this===t?!0:null==this.get_super_class()?!1:this.get_super_class().is_subclass(t)},t.prototype.is_castable=function(){throw new Error("Unimplemented.")},t}());e.ClassData=_;var p=function(t){function e(e,n){t.call(this,n),this.this_class=e,this.set_state(2)}return __extends(e,t),e.prototype.is_castable=function(t){return this.this_class===t.this_class},e.prototype.box_class_name=function(){switch(this.this_class){case"B":return"Ljava/lang/Byte;";case"C":return"Ljava/lang/Character;";case"D":return"Ljava/lang/Double;";case"F":return"Ljava/lang/Float;";case"I":return"Ljava/lang/Integer;";case"J":return"Ljava/lang/Long;";case"S":return"Ljava/lang/Short;";case"Z":return"Ljava/lang/Boolean;";default:throw new Error("Tried to box a non-primitive class: "+this.this_class)}},e.prototype.create_wrapper_object=function(t,e){var n=this.box_class_name(),r=t.get_bs_class(n),a=new l(t,r);return a.fields[n+"value"]=e,a},e}(_);e.PrimitiveClassData=p;var h=function(t){function e(e,r){t.call(this,r),this.component_type=e,this.this_class="["+this.component_type,this.super_class="Ljava/lang/Object;",this.access_flags=n.parse_flags(0)}return __extends(e,t),e.prototype.reset=function(){t.prototype.reset.call(this);var e=this.get_component_class();e&&e.reset_bit&&e.reset()},e.prototype.get_component_type=function(){return this.component_type},e.prototype.get_component_class=function(){return this.component_class_cdata},e.prototype.field_lookup=function(t,e){return this.super_class_cdata.field_lookup(t,e)},e.prototype.method_lookup=function(t,e){return this.super_class_cdata.method_lookup(t,e)},e.prototype.set_resolved=function(t,e){this.super_class_cdata=t,this.component_class_cdata=e,this.set_state(2)},e.prototype.is_castable=function(t){if(!(t instanceof e)){if(t instanceof p)return!1;if(t.access_flags["interface"]){var n=t.get_type();return"Ljava/lang/Cloneable;"===n||"Ljava/io/Serializable;"===n}return"Ljava/lang/Object;"===t.get_type()}return this.get_component_class().is_castable(t.get_component_class())},e}(_);e.ArrayClassData=h;var d=function(t){function e(e,i){t.call(this,i);var o=new n.BytesArray(e);if(3405691582!==o.get_uint(4))throw"Magic number invalid";if(this.minor_version=o.get_uint(2),this.major_version=o.get_uint(2),!(45<=this.major_version&&this.major_version<=51))throw"Major version invalid";this.constant_pool=new r.ConstantPool,this.constant_pool.parse(o),this.access_byte=o.get_uint(2),this.access_flags=n.parse_flags(this.access_byte),this.this_class=this.constant_pool.get(o.get_uint(2)).deref();var u=o.get_uint(2);0!==u&&(this.super_class=this.constant_pool.get(u).deref());var c=o.get_uint(2);this.interfaces=[];for(var l=0;c>l;++l)this.interfaces.push(this.constant_pool.get(o.get_uint(2)).deref());var f=o.get_uint(2);this.fields=[];for(var l=0;f>l;++l)this.fields.push(new s.Field(this));this.fl_cache={};for(var _=0,p=this.fields.length;p>_;++_){var h=this.fields[_];h.parse(o,this.constant_pool,_),this.fl_cache[h.name]=h}var d=o.get_uint(2);this.methods={},this.ml_cache={};for(var _=0;d>_;_+=1){var g=new s.Method(this);g.parse(o,this.constant_pool,_);var v=g.name+g.raw_descriptor;this.methods[v]=g}if(this.attrs=a.make_attributes(o,this.constant_pool),o.has_bytes())throw"Leftover bytes in classfile: "+o;this.static_fields=Object.create(null)}return __extends(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),2===this.get_state()&&this.set_state(0),this.static_fields=Object.create(null);for(var e in this.methods)this.methods[e].initialize()},e.prototype.get_interfaces=function(){return this.interface_cdatas},e.prototype.get_interface_types=function(){return this.interfaces},e.prototype.get_fields=function(){return this.fields},e.prototype.get_method=function(t){return this.methods[t]},e.prototype.get_methods=function(){return this.methods},e.prototype.get_attribute=function(t){for(var e=this.attrs,n=0;n<e.length;n++){var r=e[n];if(r.name===t)return r}return null},e.prototype.get_attributes=function(t){for(var e=this.attrs,n=[],r=0;r<e.length;r++){var a=e[r];a.name===t&&n.push(a)}return n},e.prototype.get_default_fields=function(){return this.default_fields?this.default_fields:(this.construct_default_fields(),this.default_fields)},e.prototype._initialize_static_field=function(t,e){var r=this.fl_cache[e];if(null!=r&&r.access_flags["static"]){var a=r.get_attribute("ConstantValue");if(null!=a)var i="Ljava/lang/String;"===r.type?t.init_string(a.value):a.value;this.static_fields[e]=null!=i?i:n.initial_value(r.raw_descriptor)}else t.java_throw(this.loader.get_initialized_class("Ljava/lang/NoSuchFieldError;"),e)},e.prototype.static_get=function(t,e){return void 0!==this.static_fields[e]?this.static_fields[e]:(this._initialize_static_field(t,e),this.static_get(t,e))},e.prototype.static_put=function(t,e,n){void 0!==this.static_fields[e]?this.static_fields[e]=n:(this._initialize_static_field(t,e),this.static_put(t,e,n))},e.prototype.set_resolved=function(t,e){this.super_class_cdata=t,this.interface_cdatas=e,this.set_state(1)},e.prototype.construct_default_fields=function(){var t=this;for(this.default_fields=Object.create(null);null!=t;){for(var e=t.fields,r=0;r<e.length;r++){var a=e[r];if(!a.access_flags["static"]){var i=n.initial_value(a.raw_descriptor);this.default_fields[t.get_type()+a.name]=i}}t=t.get_super_class()}},e.prototype.field_lookup=function(t,e,r){var a=this.fl_cache[e];if(null!=a)return a;if(a=this._field_lookup(t,e),null!=a||r===!0)return this.fl_cache[e]=a,a;var i=t.get_bs_class("Ljava/lang/NoSuchFieldError;");return t.java_throw(i,"No such field found in "+n.ext_classname(this.get_type())+"::"+e),null},e.prototype._field_lookup=function(t,e){for(var n=0;n<this.fields.length;n++){var r=this.fields[n];if(r.name===e)return r}for(var a=this.get_interfaces(),n=0;n<a.length;n++){var r=a[n].field_lookup(t,e,!0);if(null!=r)return r}var i=this.get_super_class();if(null!=i){var r=i.field_lookup(t,e,!0);if(null!=r)return r}return null},e.prototype.method_lookup=function(t,e){if(null!=this.ml_cache[e])return this.ml_cache[e];var r=this._method_lookup(t,e);if(null==r){var a=t.get_bs_class("Ljava/lang/NoSuchMethodError;");t.java_throw(a,"No such method found in "+n.ext_classname(this.get_type())+"::"+e)}if(null!=r.code&&null!=r.code.exception_handlers)for(var i=r.code.exception_handlers,o=0;o<i.length;o++){var s=i[o];if("<any>"!==s.catch_type&&null==this.loader.get_resolved_class(s.catch_type,!0))return null}return r},e.prototype._method_lookup=function(t,e){if(e in this.ml_cache)return this.ml_cache[e];if(e in this.methods)return this.ml_cache[e]=this.methods[e];var n=this.get_super_class();if(null!=n&&(this.ml_cache[e]=n._method_lookup(t,e),null!=this.ml_cache[e]))return this.ml_cache[e];for(var r=this.get_interfaces(),a=0;a<r.length;a++){var i=r[a];if(this.ml_cache[e]=i._method_lookup(t,e),null!=this.ml_cache[e])return this.ml_cache[e]}return this.ml_cache[e]=null},e.prototype.resolve_method=function(t,e,r,a){var i=this,o=this.method_lookup(t,e),s=o.code.exception_handlers;n.async_foreach(s,function(e,n){"<any>"===e.catch_type||i.loader.get_resolved_class(e.catch_type,!0)?n():i.loader.resolve_class(t,e.catch_type,n,a)},function(){return r(o)})},e.prototype.is_castable=function(t){return t instanceof e?this.access_flags["interface"]?t.access_flags["interface"]?this.is_subinterface(t):t.access_flags["interface"]?void 0:"Ljava/lang/Object;"===t.get_type():t.access_flags["interface"]?this.is_subinterface(t):this.is_subclass(t):!1},e.prototype.is_subinterface=function(t){if(this.this_class===t.this_class)return!0;for(var e=this.get_interfaces(),n=0;n<e.length;n++){var r=e[n];if(r.is_subinterface(t))return!0}return null==this.get_super_class()?!1:this.get_super_class().is_subinterface(t)},e}(_);e.ReferenceClassData=d});var __extends=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};define("src/ClassLoader",["require","exports","./ClassData","./util","./logging","./exceptions","./threading","./java_object","./enums"],function(t,e,n,r,a,i,o,s,u){var c=(a.trace,i.JavaException),l=s.JavaObject,f=u.ClassState,_=function(){function t(t){this.bootstrap=t,this.loaded_classes=Object.create(null)}return t.prototype.serialize=function(){throw new Error("Abstract method!")},t.prototype.get_package_names=function(){for(var t=this.get_loaded_class_list(!0),e={},n=0;n<t.length;n++){var r=t[n];e[r.substring(0,r.lastIndexOf("/")+1)]=!0}return Object.keys(e)},t.prototype.get_loaded_class_list=function(t){if(null==t&&(t=!1),t){var e=this.loaded_classes,n=[];for(var r in e){var a=e[r];"major_version"in a&&n.push(r.slice(1,-1))}return n}return Object.keys(this.loaded_classes)},t.prototype.remove_class=function(t){if(this._rem_class(t),!r.is_primitive_type(t)){var e=this.loaded_classes;for(var a in e){var i=e[a];(t===i.get_super_class_type()||i instanceof n.ArrayClassData&&t===i.get_component_type())&&this.remove_class(a)}}},t.prototype._rem_class=function(t){delete this.loaded_classes[t]},t.prototype._add_class=function(t,e){this.loaded_classes[t]=e},t.prototype._get_class=function(t){var e=this.loaded_classes[t];return null!=e&&1===e.reset_bit&&e.reset(),null!=e?e:null},t.prototype._try_define_array_class=function(t){var e=r.get_component_type(t),n=this.get_resolved_class(e,!0);return null==n?null:this._define_array_class(t,n)},t.prototype._define_array_class=function(t,e){if(e.get_class_loader()!==this)return e.get_class_loader()._define_array_class(t,e);var r=new n.ArrayClassData(e.get_type(),this);return this._add_class(t,r),r.set_resolved(this.bootstrap.get_resolved_class("Ljava/lang/Object;"),e),r},t.prototype._parallel_class_resolve=function(t,e,n,r,a){var i=this;null==a&&(a=!1);for(var o=e.length,s=null,u=[],c=function(){return o--,0===o?null==s?n(u):r(s):void 0},l=function(e){i.resolve_class(t,e,function(t){u.push(t),c()},function(t){s=t,c()},a)},f=0;f<e.length;f++)l(e[f])},t.prototype._regular_class_resolve=function(t,e,n,r,a){var i=this;if(null==a&&(a=!1),0===e.length)return n(null);var o=[],s=function(u){i.resolve_class(t,u,function(t){o.push(t),e.length>0?s(e.shift()):n(o)},r,a)};s(e.shift())},t.prototype.define_class=function(t,e,a,i,o,s,u){function c(t){t=g.concat(t);for(var e=null,n=[],r=f.get_super_class_type(),a=0;a<t.length;a++){var o=t[a];_=o.get_type(),_===r?e=o:n.push(o)}f.set_resolved(e,n),i(f)}var l=this;null==s&&(s=!1),null==u&&(u=!1);var f=new n.ReferenceClassData(a,this),_=f.get_type();if(_!==e){var p=r.descriptor2typestr(e)+" (wrong name: "+r.descriptor2typestr(_)+")";o(function(){var e=l.get_initialized_class("Ljava/lang/NoClassDefFoundError;");t.java_throw(e,p)})}this._add_class(e,f);var h=f.get_interface_types();h.push(f.get_super_class_type());for(var d=[],g=[],v=0;v<h.length;v++)if(_=h[v],null!=_){var m=this.get_resolved_class(_,!0);null!=m?g.push(m):d.push(_)}return d.length>0?this._regular_class_resolve(t,d,c,o,u):c([])},t.prototype.get_loaded_class=function(t,e){null==e&&(e=!1);var n=this._get_class(t);if(null!=n)return n;if(r.is_array_type(t)&&(n=this._try_define_array_class(t),null!=n))return n;if(r.is_primitive_type(t))return this.bootstrap.get_primitive_class(t);if(e)return null;throw new Error("Error in get_loaded_class: Class "+t+" is not loaded.")},t.prototype.get_resolved_class=function(t,e){null==e&&(e=!1);var n=this.get_loaded_class(t,e);if(null!=n&&n.is_resolved())return n;if(e)return null;throw new Error("Error in get_resolved_class: Class "+t+" is not resolved.")},t.prototype.get_initialized_class=function(t,e){null==e&&(e=!1);var n=this.get_resolved_class(t,e);if(null!=n&&n.is_initialized())return n;if(e)return null;throw new Error("Error in get_initialized_class: Class "+t+" is not initialized.")},t.prototype._initialize_class=function(t,e,r,a){var i=this;if(!(e instanceof n.ReferenceClassData))throw new Error("Tried to initialize a non-reference type: "+e.get_type());var s=!0,u=o.StackFrame.native_frame("$clinit",function(){if(t.curr_frame()!==u)throw new Error("The top of the meta stack should be this native frame, but it is not: "+t.curr_frame().name+" at "+t.meta_stack().length());return t.meta_stack().pop(),t.async_op(function(){return r(e)})},function(e){if(t.curr_frame().cdata.reset(),e instanceof c){if("Ljava/lang/NoClassDefFoundError;"===e.exception.cls.get_type())throw t.meta_stack().pop(),e;var n=t.curr_frame();n.runner=function(){var e=t.pop();throw t.meta_stack().pop(),new c(e)},n.error=function(){return t.meta_stack().pop(),a(function(){throw e})};var r=i.bootstrap.get_resolved_class("Ljava/lang/ExceptionInInitializerError;"),o=new l(t,r);return t.push_array([o,o,e.exception]),r.method_lookup(t,"<init>(Ljava/lang/Throwable;)V").setup_stack(t)}throw t.meta_stack().pop(),e});u.cdata=e;for(var f=e;null!=f&&!f.is_initialized();){f.set_state(2);var _=f.get_method("<clinit>()V");if(null!=_){if(s)s=!1,t.meta_stack().push(u);else{var p=o.StackFrame.native_frame("$clinit_secondary",function(){return t.meta_stack().pop()},function(e){for(t.curr_frame().cdata.reset(),t.meta_stack().pop();!t.curr_frame()["native"];)t.meta_stack().pop();return t.async_op(function(){a(function(){throw e},!0)})});p.cdata=f,t.meta_stack().push(p)}_.setup_stack(t)}f=f.get_super_class()}return s?(r(e),void 0):(t.run_until_finished(function(){},!1,t.stashed_done_cb),void 0)},t.prototype.initialize_class=function(t,e,n,a,i){var o=this;null==i&&(i=!1);var s=this.get_initialized_class(e,!0);if(null!=s)return n(s);if(r.is_array_type(e)){var u=r.get_component_type(e);return this.resolve_class(t,u,function(t){return n(o._define_array_class(e,t))},a,i),void 0}return s=this.get_resolved_class(e,!0),null!=s?this._initialize_class(t,s,n,a):this.resolve_class(t,e,function(e){return e.is_initialized()?n(e):o._initialize_class(t,e,n,a)},a,i)},t.prototype.resolve_class=function(t,e,n,a,i){var o=this;null==i&&(i=!1);var s=this.get_resolved_class(e,!0);if(null!=s)return n(s);if(r.is_array_type(e)){var u=r.get_component_type(e);return this.resolve_class(t,u,function(t){return n(o._define_array_class(e,t))},a,i),void 0}return this._resolve_class(t,e,n,a,i)},t.prototype._resolve_class=function(){throw new Error("Unimplemented.")},t}();e.ClassLoader=_;var p=function(t){function e(e){t.call(this,this),this.jvm_state=e}return __extends(e,t),e.prototype.serialize=function(t){if("bootstrapLoader"in t)return"<*bootstrapLoader>";t.bootstrapLoader=!0;var e={},n=this.loaded_classes;for(var r in n){var a=n[r];"__proto__"!==r&&(e[""+r+"("+f[a.get_state()]+")"]=a.loader.serialize(t))}return{ref:"bootstrapLoader",loaded:e}},e.prototype.reset=function(){var t=this.loaded_classes;for(var e in t){var n=t[e];"__proto__"!==e&&(n.reset_bit=1)}},e.prototype.get_primitive_class=function(t){var e=this._get_class(t);return null!=e?e:(e=new n.PrimitiveClassData(t,this),this._add_class(t,e),e)},e.prototype._resolve_class=function(t,e,n,a,i){var s=this;null==i&&(i=!1);var u=this.get_resolved_class(e,!0);return null!=u?n(u):(this.jvm_state.read_classfile(e,function(r){s.define_class(t,e,r,n,a,!0,i)},function(n){try{n()}catch(u){}return a(function(){t.meta_stack().push(o.StackFrame.native_frame("$class_not_found",function(){if(t.curr_frame().runner=function(){var e=t.pop();throw t.meta_stack().pop(),new c(e)},!i){var e=t.pop(),n=s.bootstrap.get_initialized_class("Ljava/lang/NoClassDefFoundError;"),r=new l(t,n);return t.push_array([r,r,e]),n.method_lookup(t,"<init>(Ljava/lang/Throwable;)V").setup_stack(t)}},function(){return t.meta_stack().pop(),a(function(){throw new Error("Failed to throw a "+(i?"ClassNotFoundException":"NoClassDefFoundError")+".")})}));var n=s.bootstrap.get_initialized_class("Ljava/lang/ClassNotFoundException;"),u=new l(t,n),f=t.init_string(r.ext_classname(e));return t.push_array([u,u,f]),n.method_lookup(t,"<init>(Ljava/lang/String;)V").setup_stack(t)})}),void 0)},e}(_);e.BootstrapClassLoader=p;var h=function(t){function e(e,n){t.call(this,e),this.loader_obj=n}return __extends(e,t),e.prototype.serialize=function(t){return this.loader_obj.serialize(t)},e.prototype._resolve_class=function(t,e,n,a,i){var s=this;null==i&&(i=!1),t.meta_stack().push(o.StackFrame.native_frame("$"+this.loader_obj.cls.get_type(),function(){var r=t.pop();t.meta_stack().pop();var a=r.$cls;return null==s.get_resolved_class(e,!0)&&s._add_class(e,a),t.async_op(function(){return n(a)})},function(e){return t.meta_stack().pop(),t.async_op(function(){return a(function(){throw e})})})),t.push2(this.loader_obj,t.init_string(r.ext_classname(e))),this.loader_obj.cls.method_lookup(t,"loadClass(Ljava/lang/String;)Ljava/lang/Class;").setup_stack(t),t.run_until_finished(function(){},!1,t.stashed_done_cb)},e}(_);e.CustomClassLoader=h}),define("src/runtime",["require","exports","./gLong","./util","./logging","./exceptions","./java_object","./jvm","./ClassLoader","./threading"],function(t,e,n,r,a,i,o,s,u,c){var l=(a.vtrace,a.trace,a.debug,a.error),f=i.YieldIOException,_=i.ReturnException,p=i.JavaException,h=o.JavaObject,d=o.JavaArray,g=0,v=function(){function t(t){this.jvm_state=t,this.startup_time=n.fromNumber((new Date).getTime()),this.run_stamp=++g,this.mem_start_addrs=[1],this.mem_blocks={},this.high_oref=1,this.string_pool=new r.SafeMap,this.lock_refs={},this.lock_counts={},this.waiting_threads={},this.thread_pool=[],this.should_return=!1;var e=new c.JavaThreadObject(this,null);this.curr_thread=e,this.max_m_count=1e5}return t.prototype.get_bs_cl=function(){return this.jvm_state.bs_cl},t.prototype.get_bs_class=function(t,e){return null==e&&(e=!1),this.jvm_state.bs_cl.get_initialized_class(t,e)},t.prototype.get_class=function(t,e){return null==e&&(e=!1),this.curr_frame().method.cls.loader.get_initialized_class(t,e)},t.prototype.get_cl=function(){return this.curr_frame().method.cls.loader},t.prototype.construct_cl=function(t){return new u.CustomClassLoader(this.get_bs_cl(),t)},t.prototype.preinitialize_core_classes=function(t,e){var n=["Ljava/lang/Class;","Ljava/lang/ClassLoader;","Ljava/lang/String;","Ljava/lang/Error;","Ljava/lang/StackTraceElement;","Ljava/io/ExpiringCache;","Ljava/io/FileDescriptor;","Ljava/io/FileNotFoundException;","Ljava/io/IOException;","Ljava/io/Serializable;","Ljava/io/UnixFileSystem;","Ljava/lang/ArithmeticException;","Ljava/lang/ArrayIndexOutOfBoundsException;","Ljava/lang/ArrayStoreException;","Ljava/lang/ClassCastException;","Ljava/lang/ClassNotFoundException;","Ljava/lang/NoClassDefFoundError;","Ljava/lang/Cloneable;","Ljava/lang/ExceptionInInitializerError;","Ljava/lang/IllegalMonitorStateException;","Ljava/lang/InterruptedException;","Ljava/lang/NegativeArraySizeException;","Ljava/lang/NoSuchFieldError;","Ljava/lang/NoSuchMethodError;","Ljava/lang/NullPointerException;","Ljava/lang/reflect/Constructor;","Ljava/lang/reflect/Field;","Ljava/lang/reflect/Method;","Ljava/lang/System;","Ljava/lang/Thread;","Ljava/lang/ThreadGroup;","Ljava/lang/Throwable;","Ljava/lang/UnsatisfiedLinkError;","Ljava/nio/ByteOrder;","Lsun/misc/VM;","Lsun/reflect/ConstantPool;","Ljava/lang/Byte;","Ljava/lang/Character;","Ljava/lang/Double;","Ljava/lang/Float;","Ljava/lang/Integer;","Ljava/lang/Long;","Ljava/lang/Short;","Ljava/lang/Boolean;","[Lsun/management/MemoryManagerImpl;","[Lsun/management/MemoryPoolImpl;"],a=this;r.async_foreach(n,function(t,n){a.jvm_state.bs_cl.initialize_class(a,t,n,e)},t)},t.prototype.init_threads=function(){var t=this,e=this.curr_frame(),n=this.get_bs_class("Ljava/lang/ThreadGroup;"),r=this.get_bs_class("Ljava/lang/Thread;"),a=new h(this,n);
this.push(a),n.method_lookup(this,"<init>()V").setup_stack(this),e.runner=function(){var n=null;e.runner=function(){e.runner=null,n.$meta_stack=t.meta_stack(),t.curr_thread=n,t.curr_thread.$isAlive=!0,t.thread_pool.push(t.curr_thread),r.static_fields.threadInitNumber=1},n=new c.JavaThreadObject(t,t.get_bs_class("Ljava/lang/Thread;"),{"Ljava/lang/Thread;name":t.init_carr("main"),"Ljava/lang/Thread;priority":1,"Ljava/lang/Thread;group":a,"Ljava/lang/Thread;threadLocals":null,"Ljava/lang/Thread;blockerLock":new h(t,t.get_bs_class("Ljava/lang/Object;"))})}},t.prototype.meta_stack=function(){return this.curr_thread.$meta_stack},t.prototype.java_throw=function(t,e){var n=this,r=new h(this,t);this.push_array([r,r,this.init_string(e)]);var a=this.curr_frame();throw t.method_lookup(this,"<init>(Ljava/lang/String;)V").setup_stack(this),a.runner=function(){throw a.runner=a.method.has_bytecode?function(){return a.method.run_bytecode(n)}:null,new p(n.pop())},_},t.prototype.init_system_class=function(){var t=this,e=this.curr_frame();this.get_bs_class("Ljava/lang/System;").get_method("initializeSystemClass()V").setup_stack(this),e.runner=function(){e.runner=null,t.system_initialized=!0}},t.prototype.init_args=function(t){var e=this,n=this.get_bs_class("[Ljava/lang/String;"),r=new d(this,n,t.map(function(t){return e.init_string(t)}));this.curr_thread.$meta_stack=new c.CallStack([r])},t.prototype.choose_next_thread=function(t,e){var n=this,r=this;if(null==t){t=[];for(var a in this.waiting_threads)t.push.apply(t,this.waiting_threads[a])}var i=this.curr_thread.wakeup_time;null==i&&(i=1/0);for(var o=(new Date).getTime(),s=this.thread_pool.filter(function(t){return t!==n.curr_thread&&t.$isAlive}),u=0;u<s.length;u++){var c=s[u];if(this.parked(c)){if(c.$park_timeout>o)continue;this.unpark(c)}if(!(t.indexOf(c)>=0)){if(!(c.wakeup_time>o))return e(c);c.wakeup_time<i&&(i=c.wakeup_time)}}1/0>i&&i>o?setTimeout(function(){return r.choose_next_thread(null,e)},i-o):e(this.curr_thread)},t.prototype.wait=function(t,e){if(null!=this.waiting_threads[t.ref]?this.waiting_threads[t.ref].push(this.curr_thread):this.waiting_threads[t.ref]=[this.curr_thread],null!=e)return this.yield(e);var n=this;this.choose_next_thread(this.waiting_threads[t.ref],function(t){return n.yield(t)})},t.prototype.yield=function(t){var e=this,n=this.curr_frame();this.curr_thread=t;var r=this.curr_frame();r.runner=function(){return e.meta_stack().pop()},n.runner=function(){return e.meta_stack().pop()}},t.prototype.park=function(t,e){var n=this;t.$park_count++,t.$park_timeout=e,this.parked(t)&&this.choose_next_thread(null,function(t){return n.yield(t)})},t.prototype.unpark=function(t){t.$park_count--,t.$park_timeout=1/0,this.parked(t)||this.yield(t)},t.prototype.parked=function(t){return t.$park_count>0},t.prototype.abort=function(t){this.abort_cb=t},t.prototype.curr_frame=function(){return this.meta_stack().curr_frame()},t.prototype.cl=function(t){return this.curr_frame().locals[t]},t.prototype.put_cl=function(t,e){this.curr_frame().locals[t]=e},t.prototype.put_cl2=function(t,e){this.put_cl(t,e)},t.prototype.push=function(t){return this.curr_frame().stack.push(t)},t.prototype.push2=function(t,e){return this.curr_frame().stack.push(t,e)},t.prototype.push_array=function(t){var e=this.curr_frame().stack;Array.prototype.push.apply(e,t)},t.prototype.pop=function(){return this.curr_frame().stack.pop()},t.prototype.pop2=function(){return this.pop(),this.pop()},t.prototype.peek=function(t){null==t&&(t=0);var e=this.curr_frame().stack;return e[e.length-1-t]},t.prototype.curr_pc=function(){return this.curr_frame().pc},t.prototype.goto_pc=function(t){return this.curr_frame().pc=t},t.prototype.inc_pc=function(t){return this.curr_frame().pc+=t},t.prototype.check_null=function(t){if(null==t){var e=this.get_bs_class("Ljava/lang/NullPointerException;");this.java_throw(e,"")}return t},t.prototype.heap_newarray=function(t,e){if(0>e){var a=this.get_bs_class("Ljava/lang/NegativeArraySizeException;");this.java_throw(a,"Tried to init ["+t+" array with length "+e)}var i=this.get_class("["+t);return"J"===t?new d(this,i,r.arrayset(e,n.ZERO)):"L"===t[0]||"["===t[0]?new d(this,i,r.arrayset(e,null)):new d(this,i,r.arrayset(e,0))},t.prototype.heap_multinewarray=function(t,e){var n=this,a=e.length,i=function(t,o){var s=e[t];if(0>s){var u=n.get_bs_class("Ljava/lang/NegativeArraySizeException;");n.java_throw(u,"Tried to init dimension "+t+" of a "+a+" dimensional "+o+" array with length "+s)}var c=new Array(s);if(t+1===a)for(var l=r.initial_value(o),f=0;s>f;f++)c[f]=l;else for(var _=t+1,p=o.slice(1),f=0;s>f;f++)c[f]=i(_,p);var h=n.get_bs_class(o);return new d(n,h,c)};return i(0,t)},t.prototype.init_string=function(t,e){null==e&&(e=!1);var n=this.string_pool.get(t);if(e&&null!=n)return n;var r=this.init_carr(t),a=this.get_bs_class("Ljava/lang/String;"),i=new h(this,a,{"Ljava/lang/String;value":r,"Ljava/lang/String;count":t.length});return e&&this.string_pool.set(t,i),i},t.prototype.init_carr=function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);var r=this.get_bs_class("[C");return new d(this,r,e)},t.prototype.block_addr=function(t){var e=t.toNumber();if("undefined"!=typeof DataView&&null!==DataView){for(var n=this.mem_start_addrs[0],r=1;r<this.mem_start_addrs.length;r++){var a=this.mem_start_addrs[r];if(a>e)return n;n=a}throw new Error("Invalid memory access at "+e)}return null!=this.mem_blocks[e]?e:void 0},t.prototype.handle_toplevel_exception=function(t,e,n){var r=this;this.unusual_termination=!0,null!=t.toplevel_catch_handler?this.run_until_finished(function(){return t.toplevel_catch_handler(r)},e,n):(l("\nInternal JVM Error:",t),null!=(null!=t?t.stack:void 0)&&l(t.stack),n(!1))},t.prototype.async_op=function(t){throw new f(t)},t.prototype.call_bytecode=function(t,e,n,r,a){var i=this,o=function(t,e){return i.async_op(function(n){return n(t,e)})},s=function(t){return i.async_op(function(e,n){return n(t)})};return this.async_op(function(){var u=!1;if("<"===e.name.charAt(0)&&"i"===e.name.charAt(1)){var l=new h(i,t);n.unshift(l,l),u=!0}var f=c.StackFrame.native_frame("$bytecode_call",function(){if("V"!==e.return_type||u){("J"===e.return_type||"D"===e.return_type)&&i.pop();var t=i.pop()}return i.meta_stack().pop(),r(t,o,s)},function(t){return i.meta_stack().pop(),a(function(){throw t},o,s)});return i.meta_stack().push(f),i.push_array(n),e.setup_stack(i),i.run_until_finished(function(){},!1,i.stashed_done_cb)})},t.prototype.run_until_finished=function(t,e,n){function r(){}var a,i=this;setImmediate(function(){if(i.abort_cb)return i.abort_cb(),n(!1);i.stashed_done_cb=n;try{t();for(var o=(new Date).getTime(),s=i.max_m_count,u=i.curr_frame();null!=u.runner&&s>0;)u.runner(),s--,u=i.curr_frame();if(null!=u.runner&&0===s){if(i.abort_cb)return i.abort_cb(),n(!1);var l=(new Date).getTime()-o;if(l>2e3||1e3>l){var p=l/i.max_m_count;i.max_m_count=1e3/p|0}return i.run_until_finished(r,e,n)}return e||i.thread_pool.length<=1?n(!0):(i.curr_thread.$isAlive=!1,i.thread_pool.splice(i.thread_pool.indexOf(i.curr_thread),1),i.choose_next_thread(null,function(t){i.curr_thread=t,i.run_until_finished(r,e,n)}))}catch(h){var d=h;if(d===_)i.run_until_finished(r,e,n);else if(d instanceof f){var g=function(t,a,o,s){return null==s&&(s=!0),o&&i.meta_stack().push(c.StackFrame.native_frame("async_op")),i.curr_frame().runner=function(){return i.meta_stack().pop(),o&&s&&(i.curr_frame().pc+=1+i.curr_frame().method.code.opcodes[i.curr_frame().pc].byte_count),void 0!==t&&("boolean"==typeof t&&(t+=0),i.push(t)),void 0!==a?i.push(a):void 0},i.run_until_finished(r,e,n)},v=function(t){return i.meta_stack().push(c.StackFrame.native_frame("async_op")),i.curr_frame().runner=function(){i.meta_stack().pop(),t()},i.run_until_finished(r,e,n)};d.condition(g,v)}else if(a=i.meta_stack(),null!=d.method_catch_handler&&a.length()>1){for(var m=0;!d.method_catch_handler(i,a.get_caller(m),0===m);)if(a.length()===++m)return i.jvm_state.dump_state(),a.pop_n(a.length()-1),i.handle_toplevel_exception(d,e,n),void 0;a.pop_n(m),i.run_until_finished(r,e,n)}else i.jvm_state.dump_state(),a.pop_n(Math.max(a.length()-1,0)),i.handle_toplevel_exception(d,e,n)}})},t.prototype.async_input=function(t,e){var n=function(t){var e=process.stdin.read(t);return null===e&&(e=process.stdin.read()),null!==e&&1===e.length&&0===e.readUInt8(0)&&(e=new Buffer(0)),e},r=n(t);null===r?process.stdin.once("readable",function(){var r=n(t);null===r&&(r=new Buffer(0)),e(r)}):setImmediate(function(){e(r)})},t}();e.RuntimeState=v}),define("src/jar",["require","exports","path","fs"],function(t,e,n,r){var a=function(){function t(t,e){this.attributes={},this.classpath=[];var a=this;r.readFile(n.resolve(t,"META-INF/MANIFEST.MF"),function(t,n){if(t)return e(t);var r=null,i="",o="\n",s=n.toString("utf8"),u=s.indexOf("\n"),c=s.indexOf("\r");u===c+1?o="\r\n":c>-1&&(o="\r");for(var l=s.split(o),f=0;f<l.length;f++){var _=l[f];if("\r"!==_)if(0===_.length)null!==r&&(a._setAttribute(r,i),r=null);else if(" "===_.charAt(0))i+=_.substr(1);else{null!==r&&a._setAttribute(r,i);var p=_.split(":");r=p[0],i=p[1].substr(1)}}e()})}return t.prototype._setAttribute=function(t,e){if(t=t.toLowerCase(),this.attributes[t]=e,"class-path"===t)for(var n=e.split(" "),r=0;r<n.length;r++){var a=n[r];".jar"===a.substr(-4)&&this.classpath.push(a)}},t.prototype.getClassPath=function(){return this.classpath.slice(0)},t.prototype.getAttribute=function(t){return this.attributes[t.toLowerCase()]},t.prototype.toString=function(){return JSON.stringify(this.attributes)},t}();return a}),define("src/jvm",["require","exports","./util","./logging","./runtime","./ClassLoader","fs","path","./jar"],function(t,e,n,r,a,i,o,s,u){var c=(r.trace,r.error,function(){function e(t,e,r,a){"undefined"==typeof e&&(e="/sys/vendor/classes"),"undefined"==typeof r&&(r="/sys/vendor/java_home"),"undefined"==typeof a&&(a="/jars"),this.jar_file_location=a,this.should_dump_state=!1,this.jar_map={},this.unzip_jar=n.are_in_browser()?this.unzip_jar_browser:this.unzip_jar_node;var i=this;this.reset_classloader_cache(),this._reset_system_properties(e,r),o.exists(r,function(n){n?o.exists(i.jar_file_location,function(n){var r=r=function(){i.add_classpath_item(e,0,function(n){n?t(null,i):t(new Error("Java class library path '"+e+"' does not exist!"))})};n?r():o.mkdir(i.jar_file_location,function(e){e?t(new Error("Unable to create JAR file directory "+i.jar_file_location+": "+e)):r()})}):t(new Error("Java home path '"+r+"' does not exist!"))})}return e.prototype.unzip_jar_browser=function(t,e){var n=s.resolve(this.jar_file_location,s.basename(t,".jar")),r=o.getRootFS();try{r.umount(n)}catch(a){}o.readFile(t,function(a,i){var o;if(a)return e(a);try{o=new BrowserFS.FileSystem.ZipFS(i,s.basename(t)),r.mount(n,o),e(null,n)}catch(u){e(u)}})},e.prototype._extract_all_to=function(t,e){for(var n in t){var r=t[n];n=s.join(e,n),r.options.dir||"/"===n.slice(-1)?o.existsSync(n)||o.mkdirSync(n):o.writeFileSync(n,r.data,"binary")}},e.prototype.unzip_jar_node=function(e,n){var r=t("node-zip"),a=new r(o.readFileSync(e,"binary"),{base64:!1,checkCRC32:!0}),i=s.resolve(this.jar_file_location,s.basename(e,".jar"));try{o.existsSync(i)||o.mkdirSync(i),this._extract_all_to(a.files,i),setImmediate(function(){return n(null,i)})}catch(u){setImmediate(function(){return n(u)})}},e.prototype.reset_system_properties=function(){this._reset_system_properties(this.system_properties["sun.boot.class.path"],this.system_properties["java.home"]),this.system_properties["java.class.path"]=[this.system_properties["sun.boot.class.path"]]},e.prototype._reset_system_properties=function(t,e){"/"!==t.charAt(t.length-1)&&(t+="/"),this.system_properties={"java.class.path":[],"java.home":e,"sun.boot.class.path":t,"file.encoding":"UTF-8","java.vendor":"Doppio","java.version":"1.6","java.vendor.url":"https://github.com/int3/doppio","java.class.version":"50.0","java.specification.version":"1.6","line.separator":"\n","file.separator":"/","path.separator":":","user.dir":s.resolve("."),"user.home":".","user.name":"DoppioUser","os.name":"doppio","os.arch":"js","os.version":"0","java.vm.name":"Doppio 64-bit VM","java.vm.vendor":"Doppio Inc.","java.awt.headless":n.are_in_browser().toString(),"java.awt.graphicsenv":"classes.awt.CanvasGraphicsEnvironment",useJavaUtilZip:"true","jline.terminal":"jline.UnsupportedTerminal"}},e.prototype.dump_state=function(){this.should_dump_state&&this._rs.curr_thread.dump_state(this._rs)},e.prototype.reset_classloader_cache=function(){this.bs_cl=new i.BootstrapClassLoader(this)},e.prototype.reset_classpath=function(){var t,e=this.system_properties["java.class.path"][0];this.system_properties["java.class.path"]=[e];for(t in this.jar_map)if(this.jar_map[t]===e)return this.jar_map={prop:e},void 0;this.jar_map={}},e.prototype.read_classfile=function(t,e,n){var r=this.system_properties["java.class.path"],a=function(i){o.readFile(r[i]+t+".class",function(o,s){o?++i==r.length?n(function(){throw new Error("Error: No file found for class "+t)}):a(i):e(s)})};t=t.slice(1,-1),a(0)},e.prototype.add_classpath_item=function(t,e,n){var r,a=this.system_properties["java.class.path"],i=this;if(t=s.resolve(t),-1!==t.indexOf(".jar"))return this.unzip_jar(t,function(r,a){var o;r?(process.stderr.write("Unable to add JAR file "+t+": "+r+"\n"),n(!1)):(i.jar_map[t]=a,o=new u(a,function(t){var r=[],s=0,u=function(){i.add_classpath_item(r[s],e+s,function(){++s===r.length?n(!0):u()})};t||(r=o.getClassPath()),r.push(a),u()}))});for("/"!==t.charAt(t.length-1)&&(t+="/"),r=0;r<a.length;r++)if(a[r]===t)return r>e&&a.splice(e,0,a.splice(r,1)),n(!0);o.exists(t,function(r){r?a.splice(e,0,t):process.stderr.write("WARNING: Classpath path "+t+" does not exist. Ignoring.\n"),n(r)})},e.prototype.push_classpath_item=function(t,e){this.add_classpath_item(t,this.system_properties["java.class.path"].length,e)},e.prototype.unshift_classpath_item=function(t,e){this.add_classpath_item(t,1,e)},e.prototype.push_classpath_items=function(t,e){var n=0,r=[],a=this,i=function(o){r.push(o),++n===t.length?e(r):a.push_classpath_item(t[n],i)};t.length>0?this.push_classpath_item(t[n],i):e(r)},e.prototype.abort=function(t){"undefined"==typeof t&&(t=function(){}),null!=this._rs&&this._rs.abort(t)},e.prototype.run_jar=function(t,e,r){var a=this;t=s.resolve(t),this.push_classpath_item(t,function(i){var o,s;i?(s=a.jar_map[t],o=new u(s,function(i){var s;i?(process.stderr.write("Unable to parse manifest file for jar file "+t+".\n"),r(!1)):(s=o.getAttribute("Main-Class"),s=n.descriptor2typestr(n.int_classname(s)),a.run_class(s,e,r))})):(process.stderr.write("Unable to process JAR file "+t+"\n"),r(!1))})},e.prototype.run_class=function(t,e,n){function r(){c.run_until_finished(function(){c.async_op(function(t,r){l.bs_cl.initialize_class(c,o,function(t){return c.init_args(e),c.run_until_finished(function(){return u=t.method_lookup(c,s),null==u?c.async_op(function(e,n){t.resolve_method(c,s,function(t){return u=t,n(function(){})},n)}):void 0},!0,function(t){return t&&null!=u||"function"==typeof n&&n(t),c.run_until_finished(function(){return u.setup_stack(c)},!1,function(t){"function"==typeof n&&n(t&&!c.unusual_termination)})})},r)})},!0,n)}function i(){c.run_until_finished(function(){c.init_threads()},!0,function(t){return t?(null!=c.system_initialized?r():c.run_until_finished(function(){c.init_system_class()},!0,function(t){return t?(r(),void 0):n(!1)}),void 0):n(!1)})}this.bs_cl.reset();var o="L"+t+";",s="main([Ljava/lang/String;)V",u=null,c=this._rs=new a.RuntimeState(this),l=this;return c.run_until_finished(function(){return c.async_op(function(){return c.preinitialize_core_classes(i,function(t){t()})})},!0,function(t){return t?void 0:n(!1)})},e.prototype.list_class_cache=function(t){var e,n=this.bs_cl.get_loaded_class_list(!0),r=this.system_properties["java.class.path"].slice(0),a=n.length,i=[],u=function(){0===--a&&t(i)},c=function(t,e){var n;0===e.length?u():(n=s.resolve(e.shift(),t),o.stat(n,function(r){return r?c(t,e):(i.push(n),u(),void 0)}))};for(e=0;e<n.length;e++)c(n[e]+".class",r.slice(0))},e.show_NYI_natives=!1,e}());return c}),define("src/java_cli",["require","exports","./option_parser","./jvm","./util","./logging"],function(t,e,n,r,a,i){function o(){n.describe({standard:{classpath:{alias:"cp",description:'JVM classpath, "path1:...:pathN"',has_value:!0},D:{description:'set a system property, "name[=value]"'},jar:{description:"add JAR to classpath and run its Main-Class (if found)",has_value:!0},help:{alias:"h",description:"print this help message"},X:{description:"print help on non-standard options"}},non_standard:{log:{description:"log level, [0-10]|vtrace|trace|debug|error",has_value:!0,"default":i.ERROR},"count-logs":{description:"count log messages instead of printing them"},"skip-logs":{description:"number of log messages to skip before printing",has_value:!0},"list-class-cache":{description:"list all of the loaded classes after execution"},"show-nyi-natives":{description:"list any NYI native functions in loaded classes"},"dump-state":{description:'write a "core dump" on unusual termination'},benchmark:{description:"time execution, both hot and cold"}}})}function s(t,e,a,s){"undefined"==typeof s&&(s=function(){}),o();var f,_,p=n.parse(t),h=[];if(e.launcher_name||(e.launcher_name="java"),p.standard.help)return c(e.launcher_name,n.show_help(),a,!0);if(p.standard.X)return c(e.launcher_name,n.show_non_standard_help(),a,!0);if(/[0-9]+/.test(p.non_standard.log))i.log_level=p.non_standard.log+0;else{var d=i[p.non_standard.log.toUpperCase()];if(null==d)return process.stderr.write("Unrecognized log level."),c(e.launcher_name,n.show_help(),a,!1);i.log_level=d}r.show_NYI_natives=p.non_standard["show-nyi-natives"],_=function(){l.extend(f.system_properties,p.properties),p.non_standard["dump-state"]&&(f.should_dump_state=p.non_standard["dump-state"]),p.non_standard["list-class-cache"]?a=function(t){return function(e){f.list_class_cache(function(n){process.stdout.write(n.join("\n")+"\n"),t(e)})}}(a):p.non_standard["count-logs"]?a=function(t){var e=0,n=console.log,r=function(){++e};return console.log=r,function(r){console.log=n,process.stdout.write("console.log was called a total of "+e+" times."),t(r)}}(a):null!=p.non_standard["skip-logs"]?a=function(t){var e=parseInt(p.non_standard["skip-logs"],10),n=console.log;return console.log=function(){0===--e&&(console.log=n)},function(e){console.log=n,t(e)}}(a):p.non_standard.benchmark&&(a=function(t){var n=(new Date).getTime();return process.stdout.write("Starting cold-cache run...\n"),function(){var r=(new Date).getTime();process.stdout.write("Starting hot-cache run...\n"),u(p,e,f,function(e){var a=(new Date).getTime();process.stdout.write("Timing:\n	"+(r-n)+" ms cold\n	"+(a-r)+" ms hot\n"),t(e)},function(){})}}(a)),e.hasOwnProperty("implicit_classpath")&&(h=e.implicit_classpath),null!=p.standard.classpath?h=h.concat(p.standard.classpath.split(":")):h.push(process.cwd()),f.push_classpath_items(h,function(){u(p,e,f,a,s)})},e.jvm_state?(f=e.jvm_state,_()):f=new r(function(t){t?(process.stderr.write("Error constructing JVM:\n"),process.stderr.write(t.toString()+"\n"),a(!1)):_()},e.jcl_path,e.java_home_path,e.jar_file_path)}function u(t,e,r,i,o){var s=t._,u=t.className,l=t.standard.jar;if(i=function(t){return function(e){r.reset_system_properties(),r.reset_classpath(),r.reset_classloader_cache(),t(e)}}(i),null!=u)".class"===u.slice(-6)&&(u=u.slice(0,-6)),-1!==u.indexOf(".")&&(u=a.descriptor2typestr(a.int_classname(u))),r.run_class(u,s,i);else{if(null==l)return c(e.launcher_name,n.show_help(),i,!0);r.run_jar(l,s,i)}o(r)}function c(t,e,n,r){return process.stdout.write("Usage: "+t+" [flags]  /path/to/classfile [args for main()]\n"+e+"\n"),n(r)}var l=t("../vendor/underscore/underscore");e.java=s}),define("src/disassembler",["require","exports","./util","./ClassData","fs"],function(t,e,n,r,a){function i(t,r){var i;0===t.length?(process.stdout.write("Usage: javap class\n"),r(!1)):(i=t[0],-1===i.indexOf(".class")&&(-1!==i.indexOf(".")&&(i=n.descriptor2typestr(n.int_classname(i))),i+=".class"),a.readFile(i,function(t,n){var a=!0;if(t)a=!1,process.stderr.write("Error disassembling "+i+":\n"+t+"\n");else try{process.stdout.write(e.disassemble(n)+"\n")}catch(o){a=!1}r(a)}))}function o(t,e){var n=new Array(e).join("0");return(n+t).slice(-e)}function s(t){var e=["public","protected","private","static","final","native"];return t["interface"]||e.push("abstract"),e.filter(function(e){return t[e]}).map(function(t){return t+" "}).join("")}function u(t,e){var r=t.toString();"f"===e&&(t===n.FLOAT_POS_INFINITY||t===Number.POSITIVE_INFINITY?r="Infinity":t===n.FLOAT_NEG_INFINITY||t===Number.NEGATIVE_INFINITY?r="-Infinity":0/0===t&&(r="NaN"));var a;if(r.match(/-?(Infinity|NaN)/))a=r;else{var i=r.match(/(-?\d+)(\.\d+)?(?:e\+?(-?\d+))?/);a=i[1]+(i[2]?i[2]:".0"),"f"===e&&null!=i[2]&&i[2].length>8&&(a=parseFloat(a).toFixed(7)),a=a.replace(/0+$/,"").replace(/\.$/,".0"),null!=i[3]&&(a+="E"+i[3])}return a+e}function c(t){var e=t.value;switch(t.type){case"Method":case"InterfaceMethod":case"Field":return"#"+e.class_ref.value+".#"+e.sig.value;case"NameAndType":return"#"+e.meth_ref.value+":#"+e.type_ref.value;case"float":return u(e,"f");case"double":return u(e,"d");case"long":return e+"l";default:return n.escape_whitespace((null!=t.deref?"#":"")+e).replace(/"/g,'\\"')}}function l(t){return n.is_array_type(t)?l(n.get_component_type(t))+"[]":n.ext_classname(t)}function f(t){return"   throws "+t.map(n.ext_classname).join(", ")}function _(t,e){var n=t.toString();return new Array(e-n.length+1).join(" ")+n}function p(t){var e=new r.ReferenceClassData(t);return d(h(e))}function h(t){var e=t.get_attribute("SourceFile"),r=t.get_attribute("RuntimeVisibleAnnotations"),a={source_file:null!=e?e.filename:null,is_deprecated:null!=t.get_attribute("Deprecated"),annotation_bytes:null!=r?r.raw_bytes:null,interfaces:t.get_interface_types(),access_string:s(t.access_flags),class_type:t.access_flags["interface"]?"interface":"class",class_name:t.get_type(),superclass:t.get_super_class_type(),major_version:t.major_version,minor_version:t.minor_version,constant_pool:[],inner_classes:[],fields:[],methods:[]},i=t.constant_pool;i.each(function(t,e){a.constant_pool.push({idx:t,type:e.type,value:c(e),extra:n.format_extra_info(e)})});for(var o=t.get_attributes("InnerClasses"),u=0;u<o.length;u++){for(var l=o[u],f=[],_=0;_<l.classes.length;_++){var p=l.classes[_],h=n.parse_flags(p.inner_access_flags),d="";h["public"]&&(d+="public "),h["abstract"]&&(d+="abstract "),f.push({access_string:d,type:n.descriptor2typestr(i.get(p.inner_info_index).deref()),raw:p,name:p.inner_name_index>0?i.get(p.inner_name_index).value:null,outer_type:p.outer_info_index>0?i.get(p.outer_info_index).deref():null})}a.inner_classes.push(f)}for(var g=t.get_fields(),u=0;u<g.length;u++){var v=g[u],m=v.get_attribute("Signature"),y={type:v.type,name:v.name,access_string:s(v.access_flags),signature_bytes:null!=m?m.raw_bytes:null,const_type:null,const_value:null},j=v.get_attribute("ConstantValue");if(null!=j){var b=i.get(j.ref);y.const_type=b.type,y.const_value="function"==typeof b.deref?b.deref():c(b)}a.fields.push(y)}var w=t.get_methods();for(m in w){var L=w[m],x=L.get_attribute("Exceptions"),I={access_string:s(L.access_flags),is_synchronized:L.access_flags.synchronized,return_type:null!=L.return_type?L.return_type:"",name:L.name,param_types:L.param_types,exceptions:null!=x?x.exceptions:null};if(!L.access_flags["native"]&&!L.access_flags.abstract){var k=L.code;k.parse_code(),I.code={max_stack:k.max_stack,max_locals:k.max_locals,num_args:L.num_args,exception_handlers:k.exception_handlers,attributes:k.attrs};var O=I.code.opcodes=[];k.each_opcode(function(t,e){return O.push({idx:t,name:e.name,annotation:e.annotate(t,i)})})}a.methods.push(I)}return a}function d(t){var e=t.interfaces.map(n.ext_classname).join(","),r=n.ext_classname(t.class_name),a='Compiled from "'+(null!=t.source_file?t.source_file:"unknown")+'"\n'+t.access_string+t.class_type+" "+r+" ";if("interface"===t.class_type?a+=e.length>0?"extends "+e+"\n":"\n":(a+="extends "+n.ext_classname(t.superclass),a+=e?" implements "+e+"\n":"\n"),t.source_file&&(a+='  SourceFile: "'+t.source_file+'"\n'),t.is_deprecated&&(a+="  Deprecated: length = 0x\n"),t.annotation_bytes){var i=t.annotation_bytes.length.toString(16),s=t.annotation_bytes.map(function(t){return o(t.toString(16),2)}).join(" ");a+="  RuntimeVisibleAnnotations: length = 0x"+i+"\n   "+s+"\n"}for(var u=0,c=t.inner_classes.length;c>u;u++){var p=t.inner_classes[u];a+="  InnerClass:\n";for(var h=0,d=p.length;d>h;h++){var g=p[h];null==g.name?a+="   "+g.access_string+"#"+g.raw.inner_info_index+"; //class "+g.type+"\n":(a+="   "+g.access_string+"#"+g.raw.inner_name_index+"= #"+g.raw.inner_info_index,a+=null==g.outer_type?"; //"+g.name+"=class "+g.type+"\n":" of #"+g.raw.outer_info_index+"; //"+g.name+"=class "+g.type+" of class "+g.outer_type+"\n")}}a+="  minor version: "+t.minor_version+"\n  major version: "+t.major_version+"\n  Constant pool:\n";for(var u=0,v=t.constant_pool.length;v>u;u++){var m=t.constant_pool[u];a+="const #"+m.idx+" = "+m.type+"	"+m.value+";"+m.extra+"\n"}a+="\n{\n";for(var u=0,y=t.fields.length;y>u;u++){var j=t.fields[u];if(a+=""+j.access_string+l(j.type)+" "+j.name+";\n",null!=j.const_type&&(a+="  Constant value: "+j.const_type+" "+j.const_value+"\n"),null!=j.signature_bytes){var b=j.signature_bytes.length.toString(16),w=function(){for(var t=j.signature_bytes,e=[],n=0,r=t.length;r>n;n++){var a=t[n];e.push(o(a.toString(16).toUpperCase(),2))}return e}().join(" ");a+="  Signature: length = 0x"+b+"\n   "+w+"\n"}a+="\n\n"}for(var L=0,x=t.methods.length;x>L;L++){var I=t.methods[L];a+=I.access_string,I.is_synchronized&&(a+="synchronized ");var k=I.param_types.map(l).join(", ");if(a+="<clinit>"===I.name?"{}":"<init>"===I.name?""+r+"("+k+")":""+l(I.return_type)+" "+I.name+"("+k+")",null!=I.exceptions&&(a+=f(I.exceptions)),a+=";\n",null!=I.code){var O=I.code;a+="  Code:\n   Stack="+O.max_stack+", Locals="+O.max_locals+", Args_size="+O.num_args+"\n",a+=function(){for(var t=[],e=0,n=O.opcodes.length;n>e;e++){var r=O.opcodes[e];t.push("   "+r.idx+":	"+r.name+r.annotation+"\n")}return t}().join("");var S=O.exception_handlers;if(null!=S&&S.length>0){a+="  Exception table:\n   from   to  target type\n";for(var E=0,N=S.length;N>E;E++){var A=S[E];a+=function(){for(var t=["start_pc","end_pc","handler_pc"],e=[],n=0,r=t.length;r>n;n++){var a=t[n];e.push(_(A[a],6))}return e}().join(""),a+="<any>"===A.catch_type?"   any\n":"   Class "+A.catch_type.slice(1,-1)+"\n"}a+="\n"}a+=O.attributes.map(function(t){return("function"==typeof t.disassemblyOutput?t.disassemblyOutput():void 0)||""}).join(""),null!=I.exceptions&&(a+="  Exceptions:\n"+f(I.exceptions)+"\n")}a+="\n"}return a+="}\n"}e.javap=i,e.disassemble=p}),define("src/testing",["require","exports","./jvm","./runtime","./util","./disassembler","path","fs"],function(t,e,n,r,a,i,o,s){function u(t,e){var n=o.resolve(t,"classes/test");s.readdir(n,function(t,n){e(n.filter(function(t){return".java"===o.extname(t)}).map(function(t){return"classes/test/"+o.basename(t,".java")}))})}function c(t,r,i,u,c,l,p){var d=function(){h.push_classpath_item(r,function(t){function n(t,e){if(0===t.length)return c||l||process.stdout.write("Pass\n"),p(!1);var i=t.shift();-1!==i.indexOf(".")&&(i=a.descriptor2typestr(a.int_classname(i))),c||process.stdout.write("testing "+i+"...\n"),f(r,i,function(a){return null==a||(process.stdout.write("Failed disasm test "+i+"\n"),u||process.stdout.write(""+a+"\n"),l)?(_(r,i,function(r){return null!=r==e.indexOf(i)>=0||(null!=r?(process.stdout.write("Failed output test: "+i+"\n"),u||process.stdout.write(r+"\n")):process.stdout.write("Expected failure passed: "+i+"\n"),l)?(n(t,e),void 0):p(!0)}),void 0):p(!0)})}if(!t)return process.stderr.write("Could not add "+r+" to classpath.\n"),p(!1);var h=o.resolve(r,"classes/test/xfail.txt");s.readFile(h,"utf-8",function(t,a){var o=a.split("\n").map(function(t){return"classes/test/"+t});null!=i&&i.length>0?(i=i.map(function(t){return t.replace(/\.class$/,"")}),n(i,o)):e.find_test_classes(r,function(t){return n(t,o)})})})};p=function(t){return function(e){h.reset_classpath(),h.reset_system_properties(),t(e)}}(p),t.jvm_state?(h=t.jvm_state,d()):new n(function(t,e){t?(process.stderr.write("Test failed: "+t+"\n"),p(!1)):(h=e,d())},t.jcl_path,t.java_home_path,t.jar_file_path)}function l(t){return t.replace(/\/\/.*/g,"").replace(/^\s*$[\n\r]+/gm,"").replace(/(float|double)\t.*/g,"$1").replace(/[ \t\r]+/g," ").replace(/[ ]\n/g,"\n").replace(/\[ \]/g,"[]")}function f(t,e,n){var r=o.resolve(t,e);s.readFile(r+".disasm","utf8",function(t,e){if(t)return n("Unable to open file "+r+".disasm: "+t);var a=l(e);s.readFile(r+".class",function(t,e){if(t)return n("Unable to open file "+r+".class: "+t);var o=l(i.disassemble(e));n(p(o,a))})})}function _(t,e,n){var r=o.resolve(t,e)+".runout";s.readFile(r,"utf8",function(t,a){if(t)return n("Unable to open file "+r+": "+t);var i="",o=process.stdout.write,s=process.stderr.write,u=function(t){return"string"!=typeof t&&(t=t.toString()),i+=t,!0};process.stdout.write=u,process.stderr.write=u,h.reset_classloader_cache(),h.run_class(e,[],function(){process.stdout.write=o,process.stderr.write=s,n(p(i,a))})})}function p(t,e){for(var n=t.split(/\n/),r=e.split(/\n/),a=0,i=0,o=[];a<n.length&&i<r.length;)n[a++]!==r[i++]&&o.push("D:"+n[a-1]+"\nJ:"+r[i-1]);return o.push.apply(o,n.slice(a).map(function(t){return"D:"+t})),o.push.apply(o,r.slice(i).map(function(t){return"J:"+t})),o.length>0?o.join("\n"):void 0}{var h;r.RuntimeState}e.find_test_classes=u,e.run_tests=c}),define("src/doppio",["require","exports","./java_cli","./disassembler","./testing","./jvm"],function(t,e,n,r,a,i){e.testing=a,e.disassembler=r,e.java_cli=n,e.JVM=i}),window.doppio=require("./src/doppio")}();
